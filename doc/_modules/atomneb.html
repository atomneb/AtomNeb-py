

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>atomneb &mdash; AtomNeb 0.2.0 documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home" alt="Documentation Home"> AtomNeb
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">User Documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../user/readme.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user/installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user/usage.html">Usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user/reference.html">References</a></li>
</ul>
<p class="caption"><span class="caption-text">API Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../api/atomneb.main.html">atomneb.main package</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">AtomNeb</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="index.html">Module code</a> &raquo;</li>
        
      <li>atomneb</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Source code for atomneb</h1><div class="highlight"><pre>
<span></span><span class="c1"># -*- coding: utf-8 -*-</span>

<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">This module contains functions for Atomic Data of Ionized Nebulae</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="c1"># A. Danehkar</span>
<span class="c1">#</span>
<span class="c1"># Version 0.2.0, 10/09/2020</span>
<span class="c1"># First Release</span>
<span class="c1">#</span>

<span class="c1">#from astropy.io import fits</span>
<span class="c1">#from astropy.table import Table</span>
<span class="kn">from</span> <span class="nn">astropy.io.fits</span> <span class="kn">import</span> <span class="n">getdata</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="c1">#try:</span>
<span class="c1">#    import regex as re</span>
<span class="c1">#except ImportError:</span>
<span class="c1">#    import re</span>

<span class="n">__all__</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;read_aij&quot;</span><span class="p">,</span><span class="s2">&quot;read_aij_list&quot;</span><span class="p">,</span><span class="s2">&quot;search_aij&quot;</span><span class="p">,</span><span class="s2">&quot;read_aij_references&quot;</span><span class="p">,</span><span class="s2">&quot;list_aij_references&quot;</span><span class="p">,</span>
           <span class="s2">&quot;get_aij_reference_citation&quot;</span><span class="p">,</span>
           <span class="s2">&quot;read_elj&quot;</span><span class="p">,</span><span class="s2">&quot;read_elj_list&quot;</span><span class="p">,</span><span class="s2">&quot;read_elj_references&quot;</span><span class="p">,</span><span class="s2">&quot;get_elj_reference_citation&quot;</span><span class="p">,</span>
           <span class="s2">&quot;read_omij&quot;</span><span class="p">,</span><span class="s2">&quot;read_omij_list&quot;</span><span class="p">,</span><span class="s2">&quot;search_omij&quot;</span><span class="p">,</span><span class="s2">&quot;read_omij_references&quot;</span><span class="p">,</span>
           <span class="s2">&quot;list_omij_references&quot;</span><span class="p">,</span><span class="s2">&quot;get_omij_reference_citation&quot;</span><span class="p">,</span>
           <span class="s2">&quot;read_aeff_collection&quot;</span><span class="p">,</span><span class="s2">&quot;read_aeff_collection_list&quot;</span><span class="p">,</span>
           <span class="s2">&quot;search_aeff_collection&quot;</span><span class="p">,</span><span class="s2">&quot;read_aeff_collection_references&quot;</span><span class="p">,</span>
           <span class="s2">&quot;list_aeff_collection_references&quot;</span><span class="p">,</span><span class="s2">&quot;get_aeff_collection_reference_citation&quot;</span><span class="p">,</span>
           <span class="s2">&quot;read_aeff_sh95&quot;</span><span class="p">,</span><span class="s2">&quot;read_aeff_sh95_list&quot;</span><span class="p">,</span><span class="s2">&quot;search_aeff_sh95&quot;</span><span class="p">,</span><span class="s2">&quot;read_aeff_sh95_references&quot;</span><span class="p">,</span>
           <span class="s2">&quot;list_aeff_sh95_references&quot;</span><span class="p">,</span><span class="s2">&quot;get_aeff_sh95_reference_citation&quot;</span><span class="p">,</span>
           <span class="s2">&quot;read_aeff_ppb91&quot;</span><span class="p">,</span><span class="s2">&quot;read_aeff_ppb91_list&quot;</span><span class="p">,</span><span class="s2">&quot;search_aeff_ppb91&quot;</span><span class="p">,</span><span class="s2">&quot;read_aeff_ppb91_references&quot;</span><span class="p">,</span>
           <span class="s2">&quot;list_aeff_ppb91_references&quot;</span><span class="p">,</span><span class="s2">&quot;get_aeff_ppb91_reference_citation&quot;</span><span class="p">,</span>
           <span class="s2">&quot;read_aeff_he_i_pfsd12&quot;</span><span class="p">,</span><span class="s2">&quot;read_aeff_he_i_pfsd12_list&quot;</span><span class="p">,</span><span class="s2">&quot;search_aeff_he_i_pfsd12&quot;</span><span class="p">,</span>
           <span class="s2">&quot;read_aeff_he_i_pfsd12_references&quot;</span><span class="p">,</span><span class="s2">&quot;list_aeff_he_i_pfsd12_references&quot;</span><span class="p">,</span>
           <span class="s2">&quot;get_aeff_he_i_pfsd12_reference_citation&quot;</span><span class="p">,</span>
           <span class="s2">&quot;read_aeff_n_ii_fsl13&quot;</span><span class="p">,</span><span class="s2">&quot;read_aeff_n_ii_fsl13_list&quot;</span><span class="p">,</span><span class="s2">&quot;search_aeff_n_ii_fsl13&quot;</span><span class="p">,</span>
           <span class="s2">&quot;read_aeff_n_ii_fsl13_references&quot;</span><span class="p">,</span><span class="s2">&quot;list_aeff_n_ii_fsl13_references&quot;</span><span class="p">,</span>
           <span class="s2">&quot;get_aeff_n_ii_fsl13_reference_citation&quot;</span><span class="p">,</span>
           <span class="s2">&quot;read_aeff_o_ii_ssb17&quot;</span><span class="p">,</span><span class="s2">&quot;read_aeff_o_ii_ssb17_list&quot;</span><span class="p">,</span><span class="s2">&quot;search_aeff_o_ii_ssb17&quot;</span><span class="p">,</span>
           <span class="s2">&quot;read_aeff_o_ii_ssb17_references&quot;</span><span class="p">,</span><span class="s2">&quot;list_aeff_o_ii_ssb17_references&quot;</span><span class="p">,</span>
           <span class="s2">&quot;get_aeff_o_ii_ssb17_reference_citation&quot;</span><span class="p">]</span>

<div class="viewcode-block" id="read_aij"><a class="viewcode-back" href="../api/atomneb.main.html#atomneb.read_aij">[docs]</a><span class="k">def</span> <span class="nf">read_aij</span><span class="p">(</span><span class="n">atom_aij_file</span><span class="p">,</span> <span class="n">atom</span><span class="p">,</span> <span class="n">ion</span><span class="p">,</span> <span class="n">reference</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">level_num</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">         This function returns the transition probabilities (Aij) from the table extensions</span>
<span class="sd">         of the FITS data file (&#39;AtomAij.fits&#39;).</span>

<span class="sd">      For example::</span>

<span class="sd">         &gt;&gt; import atomneb</span>
<span class="sd">         &gt;&gt; import numpy as np</span>
<span class="sd">         &gt;&gt; import os</span>
<span class="sd">         &gt;&gt; base_dir = os.getcwd()</span>
<span class="sd">         &gt;&gt; data_dir = os.path.join(&#39;..&#39;,&#39;atomic-data&#39;, &#39;collection&#39;)</span>
<span class="sd">         &gt;&gt; atom_aij_file = os.path.join(base_dir,data_dir, &#39;AtomAij.fits&#39;)</span>
<span class="sd">         &gt;&gt; atom=&#39;o&#39;</span>
<span class="sd">         &gt;&gt; ion=&#39;iii&#39;</span>
<span class="sd">         &gt;&gt; reference=&#39;FFT04&#39;</span>
<span class="sd">         &gt;&gt; oiii_aij_data = atomneb.read_aij(atom_aij_file, atom, ion, reference)</span>
<span class="sd">         &gt;&gt; print(oiii_aij_data.aij)</span>
<span class="sd">            0.0000000   2.5960000e-05   3.0300000e-11   2.3220000e-06       0.0000000    0.0021910000</span>
<span class="sd">            0.0000000       0.0000000   9.6320000e-05    0.0069510000      0.22550000       230.80000</span>
<span class="sd">            0.0000000       0.0000000       0.0000000     0.020290000   0.00069980000       576.50000</span>
<span class="sd">            0.0000000       0.0000000       0.0000000       0.0000000       1.6850000    0.0057770000</span>
<span class="sd">            0.0000000       0.0000000       0.0000000       0.0000000       0.0000000   3.7600000e-11</span>
<span class="sd">            0.0000000       0.0000000       0.0000000       0.0000000       0.0000000       0.0000000</span>
<span class="sd">                </span>
<span class="sd">     :return: This function returns the aij_data: { Aij:dblarr(n_level,n_level) }.</span>
<span class="sd">     :rtype: an array of data</span>

<span class="sd">     :param atom_rc_file: the FITS data file name (&#39;AtoAij.fits&#39;)</span>
<span class="sd">     :type atom_rc_file: str</span>

<span class="sd">     :param atom: atom name e.g. &#39;o&#39;</span>
<span class="sd">     :type atom: str</span>
<span class="sd">           </span>
<span class="sd">     :param ion: ionic level e.g &#39;iii&#39;</span>
<span class="sd">     :type ion: str</span>

<span class="sd">     :param reference: set for the reference</span>
<span class="sd">     :type reference: str, optional</span>

<span class="sd">     :param level_num: set for the maximum level number</span>
<span class="sd">     :type level_num: str, optional</span>
<span class="sd">         </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">element_data_list</span> <span class="o">=</span> <span class="n">read_aij_list</span><span class="p">(</span><span class="n">atom_aij_file</span><span class="p">)</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">reference</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">atom_ion_name</span> <span class="o">=</span> <span class="n">atom</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">+</span> <span class="s1">&#39;_&#39;</span> <span class="o">+</span> <span class="n">ion</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">+</span> <span class="s1">&#39;_aij_&#39;</span> <span class="o">+</span> <span class="n">reference</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>
        <span class="n">aij_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">element_data_list</span><span class="o">.</span><span class="n">aij_data</span><span class="p">)</span>
        <span class="n">ii</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">aij_list</span><span class="o">==</span> <span class="n">atom_ion_name</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>  <span class="c1">#</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">ii</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;could not find the given element or ion&#39;</span><span class="p">)</span>
            <span class="k">return</span> <span class="mi">0</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">atom_ion_name</span> <span class="o">=</span> <span class="n">atom</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">+</span> <span class="s1">&#39;_&#39;</span> <span class="o">+</span> <span class="n">ion</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">+</span> <span class="s1">&#39;_aij&#39;</span>
        <span class="n">aij_list</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">element_data_list</span><span class="o">.</span><span class="n">aij_data</span><span class="p">)</span>
        <span class="c1">#aij_res = [x for x in aij_list if re.search(atom_ion_name, x)]</span>
        <span class="n">aij_res</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">aij_list</span> <span class="k">if</span> <span class="n">atom_ion_name</span> <span class="ow">in</span> <span class="n">x</span><span class="p">]</span>
        <span class="n">iii</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">aij_list</span> <span class="o">==</span> <span class="n">aij_res</span><span class="p">[</span><span class="mi">0</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span>  <span class="c1">#</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">iii</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;could not find the given element or ion&#39;</span><span class="p">)</span>
            <span class="k">return</span> <span class="mi">0</span>
        <span class="n">ii</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">iii</span><span class="p">)</span>
    <span class="n">extension</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">element_data_list</span><span class="o">.</span><span class="n">extension</span><span class="p">)[</span><span class="n">ii</span><span class="p">]</span>

    <span class="n">aij</span><span class="p">,</span> <span class="n">header1</span> <span class="o">=</span> <span class="n">getdata</span><span class="p">(</span><span class="n">atom_aij_file</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">extension</span><span class="p">),</span> <span class="n">header</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">n_level</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">aij</span><span class="p">)</span>
    <span class="c1">#aij_temp=np.zeros((n_level,n_level))</span>
    <span class="c1">#aij_template = {&#39;aij&#39;: aij_temp }</span>
    <span class="n">aij_template</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;aij&#39;</span><span class="p">:</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">n_level</span><span class="p">,</span><span class="n">n_level</span><span class="p">))}</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">level_num</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">level_num</span> <span class="o">&lt;=</span> <span class="n">n_level</span><span class="p">:</span>
            <span class="n">level_length</span> <span class="o">=</span> <span class="n">level_num</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">level_length</span> <span class="o">=</span> <span class="n">n_level</span>
    <span class="n">aij_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">aij_template</span><span class="o">.</span><span class="n">items</span><span class="p">()],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">keys</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">aij_template</span><span class="o">.</span><span class="n">keys</span><span class="p">()))</span>
    <span class="c1">#aij_data = pd.DataFrame(data=aij_template, index=np.arange(1))</span>
    <span class="n">aij_data</span><span class="o">.</span><span class="n">aij</span> <span class="o">=</span> <span class="n">aij</span>
    <span class="k">return</span> <span class="n">aij_data</span></div>

<div class="viewcode-block" id="read_aij_list"><a class="viewcode-back" href="../api/atomneb.main.html#atomneb.read_aij_list">[docs]</a><span class="k">def</span> <span class="nf">read_aij_list</span><span class="p">(</span><span class="n">atom_aij_file</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">         This function returns the list of transition probabilities (Aij) from the 1st binary table extension</span>
<span class="sd">         of the FITS data file (&#39;AtomAij.fits&#39;).</span>
<span class="sd">           </span>
<span class="sd">     :return: This function returns the aij_data_list: { Aij_Data:&#39;&#39;, Extension:0.0}</span>
<span class="sd">     :rtype: an array of data</span>

<span class="sd">     :param Atom_Aij_file: the FITS data file name (&#39;AtomAij.fits&#39;)</span>
<span class="sd">     :type Atom_Aij_file: str         </span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">element_template</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;aij_data&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;extension&#39;</span><span class="p">:</span> <span class="mi">0</span> <span class="p">}</span>
    <span class="n">data</span><span class="p">,</span> <span class="n">hdr</span> <span class="o">=</span> <span class="n">getdata</span><span class="p">(</span><span class="n">atom_aij_file</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">aij_data</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">AIJ_DATA</span>
    <span class="n">extension</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">EXTENSION</span>
    <span class="n">element_length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">aij_data</span><span class="p">)</span>

    <span class="n">element_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">element_template</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">element_length</span><span class="p">))</span>
    <span class="c1">#aij_data=aij_data.strip</span>
    <span class="n">aij_data</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">char</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="n">aij_data</span><span class="p">)</span>
    <span class="n">element_data</span><span class="o">.</span><span class="n">aij_data</span><span class="o">=</span><span class="n">aij_data</span>
    <span class="n">element_data</span><span class="o">.</span><span class="n">extension</span> <span class="o">=</span> <span class="n">extension</span>
    <span class="k">return</span> <span class="n">element_data</span></div>

<div class="viewcode-block" id="search_aij"><a class="viewcode-back" href="../api/atomneb.main.html#atomneb.search_aij">[docs]</a><span class="k">def</span> <span class="nf">search_aij</span><span class="p">(</span><span class="n">atom_aij_file</span><span class="p">,</span> <span class="n">atom</span><span class="p">,</span> <span class="n">ion</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">         This function searches transition probabilities (Aij) for given element</span>
<span class="sd">         and ionic levels in the FITS data file (&#39;AtomAij.fits&#39;), and returns the data entry.</span>

<span class="sd">        For example::</span>

<span class="sd">         &gt;&gt; import atomneb</span>
<span class="sd">         &gt;&gt; import numpy as np</span>
<span class="sd">         &gt;&gt; import os</span>
<span class="sd">         &gt;&gt; base_dir = os.getcwd()</span>
<span class="sd">         &gt;&gt; data_dir = os.path.join(&#39;..&#39;,&#39;atomic-data&#39;, &#39;collection&#39;)</span>
<span class="sd">         &gt;&gt; atom_aij_file = os.path.join(base_dir,data_dir, &#39;AtomAij.fits&#39;)</span>
<span class="sd">         &gt;&gt; atom=&#39;o&#39;</span>
<span class="sd">         &gt;&gt; ion=&#39;iii&#39;</span>
<span class="sd">         &gt;&gt; list_oiii_aij_data = atomneb.search_aij(atom_aij_file, atom, ion)</span>
<span class="sd">         &gt;&gt; print(list_oiii_aij_data)</span>
<span class="sd">            o_iii_aij_FFT04-SZ00 o_iii_aij_FFT04 o_iii_aij_GMZ97-WFD96 o_iii_aij_SZ00-WFD96</span>
<span class="sd">            </span>
<span class="sd">     :return: This function returns the Aij_Data.</span>
<span class="sd">     :rtype: an array of data</span>

<span class="sd">     :param Atom_Aij_file: the FITS data file name (&#39;AtomAij.fits&#39;)</span>
<span class="sd">     :type Atom_Aij_file: str  </span>
<span class="sd">     </span>
<span class="sd">     :param atom: atom name e.g. &#39;o&#39;</span>
<span class="sd">     :type atom: str  </span>
<span class="sd">     </span>
<span class="sd">     :param ion: ionic level e.g &#39;iii</span>
<span class="sd">     :type ion: str  </span>
<span class="sd">     </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">element_data_list</span> <span class="o">=</span> <span class="n">read_aij_list</span><span class="p">(</span><span class="n">atom_aij_file</span><span class="p">)</span>
    <span class="n">atom_ion_name</span> <span class="o">=</span> <span class="n">atom</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">+</span> <span class="s1">&#39;_&#39;</span> <span class="o">+</span> <span class="n">ion</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">+</span> <span class="s1">&#39;_aij_&#39;</span>
    <span class="n">aij_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">element_data_list</span><span class="o">.</span><span class="n">aij_data</span><span class="p">)</span>
    <span class="c1">#aij_res = [x for x in aij_list if re.search(atom_ion_name, x)]</span>
    <span class="n">aij_res</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">aij_list</span> <span class="k">if</span> <span class="n">atom_ion_name</span> <span class="ow">in</span> <span class="n">x</span><span class="p">]</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">aij_res</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;could not find the given element or ion&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="mi">0</span>
    <span class="n">select_aij_data</span> <span class="o">=</span> <span class="n">aij_res</span>
    <span class="k">return</span> <span class="n">select_aij_data</span></div>

<div class="viewcode-block" id="read_aij_references"><a class="viewcode-back" href="../api/atomneb.main.html#atomneb.read_aij_references">[docs]</a><span class="k">def</span> <span class="nf">read_aij_references</span><span class="p">(</span><span class="n">atom_aij_file</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">         This function returns the reference list of transition probabilities (Aij) from the 1nd binary table extension</span>
<span class="sd">         of the FITS data file (&#39;AtomAij.fits&#39;).</span>

<span class="sd">     :return: This function returns the aij_data_reference: { Reference:&#39;&#39;, Citation:&#39;&#39;}</span>
<span class="sd">     :rtype: an array of data</span>

<span class="sd">     :param Atom_Aij_file: the FITS data file name (&#39;AtomAij.fits&#39;)</span>
<span class="sd">     :type Atom_Aij_file: str  </span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">reference_template</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;reference&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;citation&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">}</span>
    <span class="n">data</span><span class="p">,</span> <span class="n">hdr</span> <span class="o">=</span> <span class="n">getdata</span><span class="p">(</span><span class="n">atom_aij_file</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">reference</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">ATOMICDATA</span>
    <span class="n">citation</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">REFERENCE</span>
    <span class="n">reference_length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">reference</span><span class="p">)</span>

    <span class="n">reference_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">reference_template</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">reference_length</span><span class="p">))</span>
    <span class="c1"># aij_data=aij_data.strip</span>
    <span class="n">reference</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">char</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="n">reference</span><span class="p">)</span>
    <span class="n">citation</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">char</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="n">citation</span><span class="p">)</span>
    <span class="n">reference_data</span><span class="o">.</span><span class="n">reference</span> <span class="o">=</span> <span class="n">reference</span>
    <span class="n">reference_data</span><span class="o">.</span><span class="n">citation</span> <span class="o">=</span> <span class="n">citation</span>
    <span class="k">return</span> <span class="n">reference_data</span></div>

<div class="viewcode-block" id="list_aij_references"><a class="viewcode-back" href="../api/atomneb.main.html#atomneb.list_aij_references">[docs]</a><span class="k">def</span> <span class="nf">list_aij_references</span><span class="p">(</span><span class="n">atom_aij_file</span><span class="p">,</span> <span class="n">atom</span><span class="p">,</span> <span class="n">ion</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">         This function returns a list for all references of transition probabilities (Aij)</span>
<span class="sd">         for given element and ionic level from the FITS data file (&#39;AtoAij.fits&#39;).</span>

<span class="sd">        For example::</span>

<span class="sd">         &gt;&gt; import atomneb</span>
<span class="sd">         &gt;&gt; import numpy as np</span>
<span class="sd">         &gt;&gt; import os</span>
<span class="sd">         &gt;&gt; base_dir = os.getcwd()</span>
<span class="sd">         &gt;&gt; data_dir = os.path.join(&#39;..&#39;,&#39;atomic-data&#39;, &#39;collection&#39;)</span>
<span class="sd">         &gt;&gt; atom_aij_file = os.path.join(base_dir,data_dir, &#39;AtomAij.fits&#39;)</span>
<span class="sd">         &gt;&gt; atom=&#39;o&#39;</span>
<span class="sd">         &gt;&gt; ion=&#39;iii&#39;</span>
<span class="sd">         &gt;&gt; list_oiii_aij_reference = atomneb.list_aij_references(atom_aij_file, atom, ion)</span>
<span class="sd">         &gt;&gt; print(list_oiii_aij_reference)</span>
<span class="sd">            FFT04-SZ00 FFT04 GMZ97-WFD96 SZ00-WFD96          </span>
<span class="sd">            </span>
<span class="sd">     :return: This function returns the references.</span>
<span class="sd">     :rtype: an array of data</span>

<span class="sd">     :param atom_rc_file: the FITS data file name (&#39;AtoAij.fits&#39;)</span>
<span class="sd">     :type atom_rc_file: str  </span>
<span class="sd">     </span>
<span class="sd">     :param atom: atom name e.g. &#39;o&#39;</span>
<span class="sd">     :type atom: str  </span>
<span class="sd">     </span>
<span class="sd">     :param ion: ionic level e.g &#39;iii&#39;</span>
<span class="sd">     :type ion: str  </span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">element_data_list</span> <span class="o">=</span> <span class="n">read_aij_list</span><span class="p">(</span><span class="n">atom_aij_file</span><span class="p">)</span>

    <span class="n">atom_ion_name</span> <span class="o">=</span> <span class="n">atom</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">+</span> <span class="s1">&#39;_&#39;</span> <span class="o">+</span> <span class="n">ion</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">+</span> <span class="s1">&#39;_aij_&#39;</span>
    <span class="n">aij_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">element_data_list</span><span class="o">.</span><span class="n">aij_data</span><span class="p">)</span>
    <span class="c1">#aij_res = [x for x in aij_list if re.search(atom_ion_name, x)]</span>
    <span class="n">aij_res</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">aij_list</span> <span class="k">if</span> <span class="n">atom_ion_name</span> <span class="ow">in</span> <span class="n">x</span><span class="p">]</span>
    <span class="n">ii_length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">aij_res</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">ii_length</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;could not find the given element or ion&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="mi">0</span>
    <span class="n">nlines1</span> <span class="o">=</span> <span class="n">ii_length</span>
    <span class="n">references</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nlines1</span><span class="p">)]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">nlines1</span><span class="p">):</span>
        <span class="n">select_aij_data_str1</span> <span class="o">=</span> <span class="n">aij_res</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)</span>
        <span class="n">references</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">select_aij_data_str1</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">references</span></div>

<div class="viewcode-block" id="get_aij_reference_citation"><a class="viewcode-back" href="../api/atomneb.main.html#atomneb.get_aij_reference_citation">[docs]</a><span class="k">def</span> <span class="nf">get_aij_reference_citation</span><span class="p">(</span><span class="n">atom_aij_file</span><span class="p">,</span> <span class="n">atom</span><span class="p">,</span> <span class="n">ion</span><span class="p">,</span> <span class="n">reference</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">         This function returns the reference citation for a transition probability (Aij)</span>
<span class="sd">         from the 2nd binary table extension of the FITS data file (&#39;AtoAij.fits&#39;)</span>

<span class="sd">        For example::</span>

<span class="sd">         &gt;&gt; import atomneb</span>
<span class="sd">         &gt;&gt; import numpy as np</span>
<span class="sd">         &gt;&gt; import os</span>
<span class="sd">         &gt;&gt; base_dir = os.getcwd()</span>
<span class="sd">         &gt;&gt; data_dir = os.path.join(&#39;..&#39;,&#39;atomic-data&#39;, &#39;collection&#39;)</span>
<span class="sd">         &gt;&gt; atom_aij_file = os.path.join(base_dir,data_dir, &#39;AtomAij.fits&#39;)</span>
<span class="sd">         &gt;&gt; atom=&#39;o&#39;</span>
<span class="sd">         &gt;&gt; ion=&#39;iii&#39;</span>
<span class="sd">         &gt;&gt; reference=&#39;FFT04&#39;</span>
<span class="sd">         &gt;&gt; citation = atomneb.get_aij_reference_citation(atom_aij_file, atom, ion, reference)</span>
<span class="sd">         &gt;&gt; print(citation)</span>
<span class="sd">            Froese Fischer et al 2004, ADNDT 87, 1</span>
<span class="sd">           </span>
<span class="sd">     :return: This function returns the Citation.</span>
<span class="sd">     :rtype: str</span>

<span class="sd">     :param Atom_Aij_file: the FITS data file name (&#39;AtoAij.fits&#39;)</span>
<span class="sd">     :type Atom_Aij_file: str  </span>
<span class="sd">     </span>
<span class="sd">     :param atom:  atom name e.g. &#39;o&#39;</span>
<span class="sd">     :type atom: str  </span>
<span class="sd">     </span>
<span class="sd">     :param ion: ionic level e.g &#39;iii&#39;</span>
<span class="sd">     :type ion: str  </span>
<span class="sd">     </span>
<span class="sd">     :param reference: set for the reference e.g. &#39;FFT04&#39;</span>
<span class="sd">     :type reference: str  </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">element_data_reference</span> <span class="o">=</span> <span class="n">read_aij_references</span><span class="p">(</span><span class="n">atom_aij_file</span><span class="p">)</span>
    <span class="n">reference_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">element_data_reference</span><span class="o">.</span><span class="n">reference</span><span class="p">)</span>
    <span class="n">atom_ion_name</span> <span class="o">=</span> <span class="n">atom</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">+</span> <span class="s1">&#39;_&#39;</span> <span class="o">+</span> <span class="n">ion</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">+</span> <span class="s1">&#39;_aij_&#39;</span> <span class="o">+</span> <span class="n">reference</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>
    <span class="n">ii</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">reference_list</span> <span class="o">==</span> <span class="n">atom_ion_name</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>  <span class="c1">#</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">ii</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;could not find the given reference&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="mi">0</span>
    <span class="n">citation</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">element_data_reference</span><span class="o">.</span><span class="n">citation</span><span class="p">[</span><span class="n">ii</span><span class="p">])</span>

    <span class="k">return</span> <span class="n">citation</span></div>

<div class="viewcode-block" id="read_elj"><a class="viewcode-back" href="../api/atomneb.main.html#atomneb.read_elj">[docs]</a><span class="k">def</span> <span class="nf">read_elj</span><span class="p">(</span><span class="n">atom_elj_file</span><span class="p">,</span> <span class="n">atom</span><span class="p">,</span> <span class="n">ion</span><span class="p">,</span> <span class="n">level_num</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">         This function returns the energy levels (Ej) from the table extensions</span>
<span class="sd">         of the FITS data file (&#39;AtomElj.fits&#39;).</span>

<span class="sd">        For example::</span>

<span class="sd">         &gt;&gt; import atomneb</span>
<span class="sd">         &gt;&gt; import numpy as np</span>
<span class="sd">         &gt;&gt; import os</span>
<span class="sd">         &gt;&gt; base_dir = os.getcwd()</span>
<span class="sd">         &gt;&gt; data_dir = os.path.join(&#39;..&#39;,&#39;atomic-data&#39;, &#39;collection&#39;)</span>
<span class="sd">         &gt;&gt; atom_elj_file = os.path.join(base_dir,data_dir, &#39;AtomElj.fits&#39;)</span>
<span class="sd">         &gt;&gt; atom=&#39;o&#39;</span>
<span class="sd">         &gt;&gt; ion=&#39;iii&#39;</span>
<span class="sd">         &gt;&gt; oiii_elj_data=atomneb.read_elj(atom_elj_file, atom, ion, level_num=6)</span>
<span class="sd">         &gt;&gt; print(np.asarray(oiii_elj_data.j_v))</span>
<span class="sd">            0.00000      1.00000      2.00000      2.00000      0.00000      2.00000</span>
<span class="sd">         &gt;&gt; print(np.asarray(oiii_elj_data.ej))</span>
<span class="sd">            0.0000000       113.17800       306.17400       20273.270       43185.740       60324.790</span>
<span class="sd">                    </span>
<span class="sd">     :return: This function returns the elj_data:{ Configuration:&#39;&#39;, Term:&#39;&#39;, J:&#39;&#39;, J_v:0.0, Ej:0.0, Reference:&#39;&#39;}.</span>
<span class="sd">     :rtype: an array of data</span>


<span class="sd">     :param atom_elj_file: the FITS data file name (&#39;AtomElj.fits&#39;)</span>
<span class="sd">     :type atom_elj_file: str  </span>
<span class="sd">     </span>
<span class="sd">     :param atom: atom name e.g. &#39;o&#39;</span>
<span class="sd">     :type atom: str  </span>
<span class="sd">     </span>
<span class="sd">     :param ion: ionic level e.g &#39;iii&#39;</span>
<span class="sd">     :type ion: str  </span>
<span class="sd">     </span>
<span class="sd">     :param level_num: set for the maximum level number.</span>
<span class="sd">     :type level_num: int, optional </span>
<span class="sd">      </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">element_data_list</span> <span class="o">=</span> <span class="n">read_elj_list</span><span class="p">(</span><span class="n">atom_elj_file</span><span class="p">)</span>

    <span class="n">atom_ion_name</span> <span class="o">=</span> <span class="n">atom</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">+</span> <span class="s1">&#39;_&#39;</span> <span class="o">+</span> <span class="n">ion</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">+</span> <span class="s1">&#39;_elj&#39;</span>
    <span class="n">elj_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">element_data_list</span><span class="o">.</span><span class="n">elj_data</span><span class="p">)</span>
    <span class="n">ii</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">elj_list</span> <span class="o">==</span> <span class="n">atom_ion_name</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>  <span class="c1">#</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">ii</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;could not find the given element or ion&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="mi">0</span>
    <span class="n">extension</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">element_data_list</span><span class="o">.</span><span class="n">extension</span><span class="p">)[</span><span class="n">ii</span><span class="p">]</span>

    <span class="c1"># level_template={Configuration:&#39;&#39;, Term:&#39;&#39;, J:&#39;&#39;, J_v: float(0.0), Ej:double(0.0), Reference:&#39;&#39;}</span>
    <span class="n">level_template</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;configuration&#39;</span><span class="p">:</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;term&#39;</span><span class="p">:</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;j&#39;</span><span class="p">:</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;j_v&#39;</span><span class="p">:</span> <span class="nb">float</span><span class="p">(</span><span class="mf">0.0</span><span class="p">),</span> <span class="s1">&#39;ej&#39;</span><span class="p">:</span><span class="nb">float</span><span class="p">(</span><span class="mf">0.0</span><span class="p">),</span> <span class="s1">&#39;reference&#39;</span><span class="p">:</span><span class="s1">&#39;&#39;</span><span class="p">}</span>

    <span class="n">data</span><span class="p">,</span> <span class="n">header1</span> <span class="o">=</span> <span class="n">getdata</span><span class="p">(</span><span class="n">atom_elj_file</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">extension</span><span class="p">),</span> <span class="n">header</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">configuration</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">CONFIGURATION</span>
    <span class="n">term</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">TERM</span>
    <span class="n">j_s</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">J</span>
    <span class="n">j_v</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">J_V</span>
    <span class="n">ej</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">EJ</span>
    <span class="n">reference</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">REFERENCE</span>
    <span class="n">level_length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">reference</span><span class="p">)</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">level_num</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">level_num</span> <span class="o">&lt;=</span> <span class="n">level_length</span><span class="p">:</span>
            <span class="n">level_length</span> <span class="o">=</span> <span class="n">level_num</span>

    <span class="n">level_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">level_template</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">level_length</span><span class="p">))</span>
    <span class="n">term</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">char</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="n">term</span><span class="p">)</span>
    <span class="n">j_s</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">char</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="n">j_s</span><span class="p">)</span>
    <span class="n">reference</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">char</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="n">reference</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">level_length</span><span class="p">):</span>
        <span class="n">level_data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="s1">&#39;configuration&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">configuration</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="n">level_data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="s1">&#39;term&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">term</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="n">level_data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="s1">&#39;j_s&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">j_s</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="n">level_data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="s1">&#39;j_v&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">j_v</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="n">level_data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="s1">&#39;ej&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ej</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="n">level_data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="s1">&#39;reference&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">reference</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>

    <span class="k">return</span> <span class="n">level_data</span></div>

<div class="viewcode-block" id="read_elj_list"><a class="viewcode-back" href="../api/atomneb.main.html#atomneb.read_elj_list">[docs]</a><span class="k">def</span> <span class="nf">read_elj_list</span><span class="p">(</span><span class="n">atom_elj_file</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">         This function returns the list of energy levels (Ej) from the 1st binary table extension</span>
<span class="sd">         of the FITS data file (&#39;AtomElj.fits&#39;)</span>
<span class="sd">         </span>
<span class="sd">     :return:  This function returns the elj_data_list: { Elj_Data:&#39;&#39;, Extension:0.0}</span>
<span class="sd">     :rtype: an array of data</span>

<span class="sd">     :param atom_elj_file: the FITS data file name (&#39;AtomElj.fits&#39;)</span>
<span class="sd">     :type atom_elj_file: str  </span>
<span class="sd">     </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">element_template</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;elj_data&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;extension&#39;</span><span class="p">:</span> <span class="mi">0</span> <span class="p">}</span>
    <span class="n">data</span><span class="p">,</span> <span class="n">hdr</span> <span class="o">=</span> <span class="n">getdata</span><span class="p">(</span><span class="n">atom_elj_file</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">elj_data</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">EJ_DATA</span>
    <span class="n">extension</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">EXTENSION</span>
    <span class="n">element_length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">elj_data</span><span class="p">)</span>

    <span class="n">element_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">element_template</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">element_length</span><span class="p">))</span>
    <span class="c1">#aij_data=aij_data.strip</span>
    <span class="n">elj_data</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">char</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="n">elj_data</span><span class="p">)</span>
    <span class="n">element_data</span><span class="o">.</span><span class="n">elj_data</span><span class="o">=</span><span class="n">elj_data</span>
    <span class="n">element_data</span><span class="o">.</span><span class="n">extension</span> <span class="o">=</span> <span class="n">extension</span>
    <span class="k">return</span> <span class="n">element_data</span></div>

<div class="viewcode-block" id="read_elj_references"><a class="viewcode-back" href="../api/atomneb.main.html#atomneb.read_elj_references">[docs]</a><span class="k">def</span> <span class="nf">read_elj_references</span><span class="p">(</span><span class="n">atom_elj_file</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">         This function returns the reference list of energy levels (Ej) from the 2nd binary table extension</span>
<span class="sd">         of the FITS data file (&#39;AtomElj.fits&#39;).</span>

<span class="sd">     :return:  This function returns the aij_data_reference:  { Reference:&#39;&#39;, Citation:&#39;&#39;}</span>
<span class="sd">     :rtype: an array of data</span>

<span class="sd">     :param atom_elj_file: the FITS data file name (&#39;AtomElj.fits&#39;)</span>
<span class="sd">     :type atom_elj_file: str  </span>
<span class="sd">     </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">reference_template</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;reference&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;citation&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">}</span>
    <span class="n">data</span><span class="p">,</span> <span class="n">hdr</span> <span class="o">=</span> <span class="n">getdata</span><span class="p">(</span><span class="n">atom_elj_file</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">reference</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">ATOMICDATA</span>
    <span class="n">citation</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">REFERENCE</span>
    <span class="n">reference_length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">reference</span><span class="p">)</span>

    <span class="n">reference_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">reference_template</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">reference_length</span><span class="p">))</span>


    <span class="n">reference</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">char</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="n">reference</span><span class="p">)</span>
    <span class="n">citation</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">char</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="n">citation</span><span class="p">)</span>
    <span class="n">reference_data</span><span class="o">.</span><span class="n">reference</span> <span class="o">=</span> <span class="n">reference</span>
    <span class="n">reference_data</span><span class="o">.</span><span class="n">citation</span> <span class="o">=</span> <span class="n">citation</span>
    <span class="k">return</span> <span class="n">reference_data</span></div>

<div class="viewcode-block" id="get_elj_reference_citation"><a class="viewcode-back" href="../api/atomneb.main.html#atomneb.get_elj_reference_citation">[docs]</a><span class="k">def</span> <span class="nf">get_elj_reference_citation</span><span class="p">(</span><span class="n">atom_elj_file</span><span class="p">,</span> <span class="n">reference</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">         This function returns the reference citation for energy levels (Ej)</span>
<span class="sd">         from the 2nd binary table extension of the FITS data file (&#39;AtomElj.fits&#39;).</span>

<span class="sd">        For example::</span>

<span class="sd">         &gt;&gt; import atomneb</span>
<span class="sd">         &gt;&gt; import numpy as np</span>
<span class="sd">         &gt;&gt; import os</span>
<span class="sd">         &gt;&gt; base_dir = os.getcwd()</span>
<span class="sd">         &gt;&gt; data_dir = os.path.join(&#39;..&#39;,&#39;atomic-data&#39;, &#39;collection&#39;)</span>
<span class="sd">         &gt;&gt; atom_elj_file = os.path.join(base_dir,data_dir, &#39;AtomElj.fits&#39;)</span>
<span class="sd">         &gt;&gt; reference=&#39;L7288&#39;</span>
<span class="sd">         &gt;&gt; citation=atomneb.get_elj_reference_citation(atom_elj_file, reference)</span>
<span class="sd">         &gt;&gt; print(citation)</span>
<span class="sd">            C. E. Moore, in CRC Series in Evaluated Data in Atomic Physics, 339 pp. (CRC Press, Boca Raton, FL, 1993)</span>
<span class="sd">                    </span>
<span class="sd">     :return:  This function returns the Citation.</span>
<span class="sd">     :rtype: str</span>
<span class="sd">     </span>
<span class="sd">     :param atom_elj_file: the FITS data file name (&#39;AtomElj.fits&#39;)</span>
<span class="sd">     :type atom_elj_file: str  </span>
<span class="sd">     </span>
<span class="sd">     :param reference: set for the reference e.g. &#39;L7288&#39;</span>
<span class="sd">     :type reference: str  </span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">element_data_reference</span> <span class="o">=</span> <span class="n">read_elj_references</span><span class="p">(</span><span class="n">atom_elj_file</span><span class="p">)</span>
    <span class="n">reference_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">element_data_reference</span><span class="o">.</span><span class="n">reference</span><span class="p">)</span>
    <span class="n">ii</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">reference_list</span> <span class="o">==</span> <span class="n">reference</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>  <span class="c1">#</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">ii</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;could not find the given reference&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="mi">0</span>
    <span class="n">citation</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">element_data_reference</span><span class="o">.</span><span class="n">citation</span><span class="p">[</span><span class="n">ii</span><span class="p">])</span>

    <span class="k">return</span> <span class="n">citation</span></div>

<div class="viewcode-block" id="read_omij"><a class="viewcode-back" href="../api/atomneb.main.html#atomneb.read_omij">[docs]</a><span class="k">def</span> <span class="nf">read_omij</span><span class="p">(</span><span class="n">atom_omij_file</span><span class="p">,</span> <span class="n">atom</span><span class="p">,</span> <span class="n">ion</span><span class="p">,</span> <span class="n">reference</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">level_num</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">         This function returns the collision strengths (omega_ij) from the table extensions</span>
<span class="sd">         of the FITS data file (&#39;AtomOmij.fits&#39;).</span>

<span class="sd">        For example::</span>

<span class="sd">         &gt;&gt; import atomneb</span>
<span class="sd">         &gt;&gt; import numpy as np</span>
<span class="sd">         &gt;&gt; import os</span>
<span class="sd">         &gt;&gt; base_dir = os.getcwd()</span>
<span class="sd">         &gt;&gt; data_dir = os.path.join(&#39;..&#39;,&#39;atomic-data&#39;, &#39;collection&#39;)</span>
<span class="sd">         &gt;&gt; atom_omij_file = os.path.join(base_dir,data_dir, &#39;AtomOmij.fits&#39;)</span>
<span class="sd">         &gt;&gt; atom=&#39;o&#39;</span>
<span class="sd">         &gt;&gt; ion=&#39;iii&#39;</span>
<span class="sd">         &gt;&gt; reference=&#39;SSB14&#39;</span>
<span class="sd">         &gt;&gt; oiii_omij_data=atomneb.read_omij(atom_omij_file, atom, ion, reference=reference)</span>
<span class="sd">         &gt;&gt; print(np.asarray(oiii_omij_data.level1))</span>
<span class="sd">            0       1       1       1       1       2       2       2       3       3       4</span>
<span class="sd">         &gt;&gt; print(np.asarray(oiii_omij_data.level2))</span>
<span class="sd">            0       2       3       4       5       3       4       5       4       5       5</span>
<span class="sd">         &gt;&gt; print(np.asarray(oiii_omij_data.strength)[0])</span>
<span class="sd">            100.00000       125.89254       158.48932       199.52623       251.18864       ...</span>

<span class="sd">     :return:  This function returns the omij_data: { level1:0, level2:0, strength:array(temp_steps)}.</span>
<span class="sd">     :rtype: an array of data</span>
<span class="sd">     </span>
<span class="sd">     :Params:</span>
<span class="sd">         atom_omij_file  : in, required, type=string</span>
<span class="sd">                         the FITS data file name (&#39;AtomOmij.fits&#39;)</span>
<span class="sd">         atom          : in, required, type=string</span>
<span class="sd">                         atom name e.g. &#39;o&#39;</span>
<span class="sd">         ion           : in, required, type=string</span>
<span class="sd">                         ionic level e.g &#39;iii&#39;</span>

<span class="sd">     :param reference: set for the reference e.g. &#39;SSB14&#39;</span>
<span class="sd">     :type reference: str, optional</span>
<span class="sd">     </span>
<span class="sd">     :param level_num: set for the maximum level number.</span>
<span class="sd">     :type level_num: int, optional</span>
<span class="sd">     </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">element_data_list</span> <span class="o">=</span> <span class="n">read_omij_list</span><span class="p">(</span><span class="n">atom_omij_file</span><span class="p">)</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">reference</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">atom_ion_name</span> <span class="o">=</span> <span class="n">atom</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">+</span> <span class="s1">&#39;_&#39;</span> <span class="o">+</span> <span class="n">ion</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">+</span> <span class="s1">&#39;_omij_&#39;</span> <span class="o">+</span> <span class="n">reference</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>
        <span class="n">omij_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">element_data_list</span><span class="o">.</span><span class="n">omij_data</span><span class="p">)</span>
        <span class="n">ii</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">omij_list</span><span class="o">==</span> <span class="n">atom_ion_name</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>  <span class="c1">#</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">ii</span><span class="p">)</span><span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;could not find the given element or ion&#39;</span><span class="p">)</span>
            <span class="k">return</span> <span class="mi">0</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">atom_ion_name</span> <span class="o">=</span> <span class="n">atom</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">+</span> <span class="s1">&#39;_&#39;</span> <span class="o">+</span> <span class="n">ion</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">+</span> <span class="s1">&#39;_omij&#39;</span>
        <span class="n">omij_list</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">element_data_list</span><span class="o">.</span><span class="n">omij_data</span><span class="p">)</span>
        <span class="c1">#omij_res = [x for x in omij_list if re.search(atom_ion_name, x)]</span>
        <span class="n">omij_res</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">omij_list</span> <span class="k">if</span> <span class="n">atom_ion_name</span> <span class="ow">in</span> <span class="n">x</span><span class="p">]</span>
        <span class="n">iii</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">omij_list</span> <span class="o">==</span> <span class="n">omij_res</span><span class="p">[</span><span class="mi">0</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span>  <span class="c1">#</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">iii</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;could not find the given element or ion&#39;</span><span class="p">)</span>
            <span class="k">return</span> <span class="mi">0</span>
        <span class="n">ii</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">iii</span><span class="p">)</span>
    <span class="n">extension</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">element_data_list</span><span class="o">.</span><span class="n">extension</span><span class="p">)[</span><span class="n">ii</span><span class="p">]</span>

    <span class="n">data</span><span class="p">,</span> <span class="n">header1</span> <span class="o">=</span> <span class="n">getdata</span><span class="p">(</span><span class="n">atom_omij_file</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">extension</span><span class="p">),</span> <span class="n">header</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">level1</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">LEVEL1</span>
    <span class="n">level2</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">LEVEL2</span>
    <span class="n">strength</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">STRENGTH</span>
    <span class="n">n_line</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">level1</span><span class="p">)</span>
    <span class="n">temp_steps</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">strength</span><span class="p">)</span>
    <span class="n">n_level</span> <span class="o">=</span> <span class="nb">max</span><span class="p">([</span><span class="nb">max</span><span class="p">(</span><span class="n">level1</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">level2</span><span class="p">)])</span>
    <span class="c1"># omij_template={level1:0, level2:0, strength:dblarr(temp_steps)}</span>
    <span class="n">strength_temp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">temp_steps</span><span class="p">)</span>
    <span class="n">omij_template</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;level1&#39;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;level2&#39;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;strength&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">strength_temp</span><span class="p">]</span> <span class="p">}</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">level_num</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">level_num</span> <span class="o">&lt;=</span> <span class="n">n_level</span><span class="p">:</span>
            <span class="n">level_length</span> <span class="o">=</span> <span class="n">level_num</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">level_length</span> <span class="o">=</span> <span class="n">n_level</span>
    <span class="c1">#omij_data = pd.concat([pd.DataFrame(v) for k, v in omij_template.items()], axis=3, keys=list(omij_template.keys()))</span>
    <span class="n">omij_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">omij_template</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">n_line</span><span class="p">))</span>
    <span class="c1">#for i in range(0, n_line):</span>
    <span class="c1">#    omij_data.loc[i, &#39;level1&#39;] = level1[i]</span>
    <span class="c1">#    omij_data.loc[i, &#39;level2&#39;] = level2[i]</span>
    <span class="c1">#    omij_data.loc[i, &#39;strength&#39;] = strength[:,i]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">n_line</span><span class="p">):</span>
        <span class="n">omij_data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="s1">&#39;level1&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">level1</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="n">omij_data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="s1">&#39;level2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">level2</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="c1">#print(strength[i,:])</span>
        <span class="c1">#omij_data.strength[i] = strength[i,:]</span>
        <span class="n">omij_data</span><span class="p">[</span><span class="s1">&#39;strength&#39;</span><span class="p">][:][</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">strength</span><span class="p">[</span><span class="n">i</span><span class="p">,:]</span>
        <span class="c1">#omij_data[&#39;strength&#39;][i] = strength[i, :]</span>
        <span class="c1">#omij_data.loc[i, &#39;strength&#39;] = strength[i,:]</span>
    <span class="c1">#omij_data.level1 = level1</span>
    <span class="c1">#omij_data.level2 = level2</span>
    <span class="c1"># omij_data.strength = strength</span>
    <span class="k">return</span> <span class="n">omij_data</span></div>

<div class="viewcode-block" id="read_omij_list"><a class="viewcode-back" href="../api/atomneb.main.html#atomneb.read_omij_list">[docs]</a><span class="k">def</span> <span class="nf">read_omij_list</span><span class="p">(</span><span class="n">atom_omij_file</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">         This function returns the list of collision strengths (omega_ij) from the 1st binary table extension</span>
<span class="sd">         of the FITS data file (&#39;AtomOmij.fits&#39;).</span>
<span class="sd">         </span>
<span class="sd">     :return: This function returns the omij_data_list: { Omij_Data:&#39;&#39;, Extension:0.0}</span>
<span class="sd">     :rtype: an array of data</span>


<span class="sd">     :param atom_omij_file: the FITS data file name (&#39;AtomOmij.fits&#39;)</span>
<span class="sd">     :type atom_omij_file: str</span>
<span class="sd">     </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">element_template</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;omij_data&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;extension&#39;</span><span class="p">:</span> <span class="mi">0</span> <span class="p">}</span>
    <span class="n">data</span><span class="p">,</span> <span class="n">hdr</span> <span class="o">=</span> <span class="n">getdata</span><span class="p">(</span><span class="n">atom_omij_file</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">omij_data</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">OMIJ_DATA</span>
    <span class="n">extension</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">EXTENSION</span>
    <span class="n">element_length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">omij_data</span><span class="p">)</span>

    <span class="n">element_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">element_template</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">element_length</span><span class="p">))</span>
    <span class="c1">#omij_data=omij_data.strip</span>
    <span class="n">omij_data</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">char</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="n">omij_data</span><span class="p">)</span>
    <span class="n">element_data</span><span class="o">.</span><span class="n">omij_data</span><span class="o">=</span><span class="n">omij_data</span>
    <span class="n">element_data</span><span class="o">.</span><span class="n">extension</span> <span class="o">=</span> <span class="n">extension</span>
    <span class="k">return</span> <span class="n">element_data</span></div>

<div class="viewcode-block" id="search_omij"><a class="viewcode-back" href="../api/atomneb.main.html#atomneb.search_omij">[docs]</a><span class="k">def</span> <span class="nf">search_omij</span><span class="p">(</span><span class="n">atom_omij_file</span><span class="p">,</span> <span class="n">atom</span><span class="p">,</span> <span class="n">ion</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">         This function searches collision strengths (omega_ij) for given element</span>
<span class="sd">         and ionic levels in the FITS data file (&#39;AtomOmij.fits&#39;), and returns the data entry.</span>

<span class="sd">        For example::</span>

<span class="sd">         &gt;&gt; import atomneb</span>
<span class="sd">         &gt;&gt; import numpy as np</span>
<span class="sd">         &gt;&gt; import os</span>
<span class="sd">         &gt;&gt; base_dir = os.getcwd()</span>
<span class="sd">         &gt;&gt; data_dir = os.path.join(&#39;..&#39;,&#39;atomic-data&#39;, &#39;collection&#39;)</span>
<span class="sd">         &gt;&gt; atom_omij_file = os.path.join(base_dir,data_dir, &#39;AtomOmij.fits&#39;)</span>
<span class="sd">         &gt;&gt; atom=&#39;o&#39;</span>
<span class="sd">         &gt;&gt; ion=&#39;iii&#39;</span>
<span class="sd">         &gt;&gt; list_oiii_omij_data = atomneb.search_omij(atom_omij_file, atom, ion)</span>
<span class="sd">         &gt;&gt; print(list_oiii_omij_data)</span>
<span class="sd">            o_iii_omij_AK99 o_iii_omij_LB94 o_iii_omij_Pal12-AK99 o_iii_omij_SSB14</span>

<span class="sd">     :return: This function returns the Omij_Data.</span>
<span class="sd">     :rtype: an array of data</span>

<span class="sd">     :param atom_omij_file: the FITS data file name (&#39;AtomOmij.fits&#39;)</span>
<span class="sd">     :type atom_omij_file: str</span>
<span class="sd">     </span>
<span class="sd">     :param atom: atom name e.g. &#39;o&#39;</span>
<span class="sd">     :type atom: str</span>
<span class="sd">     </span>
<span class="sd">     :param ion: ionic level e.g &#39;iii&#39;</span>
<span class="sd">     :type ion: str</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">element_data_list</span> <span class="o">=</span> <span class="n">read_omij_list</span><span class="p">(</span><span class="n">atom_omij_file</span><span class="p">)</span>
    <span class="n">atom_ion_name</span> <span class="o">=</span> <span class="n">atom</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">+</span> <span class="s1">&#39;_&#39;</span> <span class="o">+</span> <span class="n">ion</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">+</span> <span class="s1">&#39;_omij_&#39;</span>
    <span class="n">omij_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">element_data_list</span><span class="o">.</span><span class="n">omij_data</span><span class="p">)</span>
    <span class="c1">#omij_res = [x for x in omij_list if re.search(atom_ion_name, x)]</span>
    <span class="n">omij_res</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">omij_list</span> <span class="k">if</span> <span class="n">atom_ion_name</span> <span class="ow">in</span> <span class="n">x</span><span class="p">]</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">omij_res</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;could not find the given element or ion&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="mi">0</span>
    <span class="n">select_omij_data</span> <span class="o">=</span> <span class="n">omij_res</span>
    <span class="k">return</span> <span class="n">select_omij_data</span></div>

<div class="viewcode-block" id="read_omij_references"><a class="viewcode-back" href="../api/atomneb.main.html#atomneb.read_omij_references">[docs]</a><span class="k">def</span> <span class="nf">read_omij_references</span><span class="p">(</span><span class="n">atom_omij_file</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">         This function returns the reference list of collision strengths (omega_ij) from the 2nd binary table extension</span>
<span class="sd">         of the FITS data file (&#39;AtomOmij.fits&#39;).</span>

<span class="sd">     :return: his function returns the aij_data_reference: { Reference:&#39;&#39;, Citation:&#39;&#39;}</span>
<span class="sd">     :rtype: an array of data</span>

<span class="sd">     :param atom_omij_file: the FITS data file name (&#39;AtomOmij.fits&#39;)</span>
<span class="sd">     :type atom_omij_file: str</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">reference_template</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;reference&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;citation&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">}</span>
    <span class="n">data</span><span class="p">,</span> <span class="n">hdr</span> <span class="o">=</span> <span class="n">getdata</span><span class="p">(</span><span class="n">atom_omij_file</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">reference</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">ATOMICDATA</span>
    <span class="n">citation</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">REFERENCE</span>
    <span class="n">reference_length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">reference</span><span class="p">)</span>

    <span class="n">reference_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">reference_template</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">reference_length</span><span class="p">))</span>
    <span class="c1"># aij_data=aij_data.strip</span>
    <span class="n">reference</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">char</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="n">reference</span><span class="p">)</span>
    <span class="n">citation</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">char</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="n">citation</span><span class="p">)</span>
    <span class="n">reference_data</span><span class="o">.</span><span class="n">reference</span> <span class="o">=</span> <span class="n">reference</span>
    <span class="n">reference_data</span><span class="o">.</span><span class="n">citation</span> <span class="o">=</span> <span class="n">citation</span>
    <span class="k">return</span> <span class="n">reference_data</span></div>

<div class="viewcode-block" id="list_omij_references"><a class="viewcode-back" href="../api/atomneb.main.html#atomneb.list_omij_references">[docs]</a><span class="k">def</span> <span class="nf">list_omij_references</span><span class="p">(</span><span class="n">atom_omij_file</span><span class="p">,</span> <span class="n">atom</span><span class="p">,</span> <span class="n">ion</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">         This function returns a list for all references of collision strengths (Omega_ij)</span>
<span class="sd">         for given element and ionic level from the FITS data file (&#39;AtomOmij.fits&#39;).</span>

<span class="sd">        For example::</span>

<span class="sd">         &gt;&gt; import atomneb</span>
<span class="sd">         &gt;&gt; import numpy as np</span>
<span class="sd">         &gt;&gt; import os</span>
<span class="sd">         &gt;&gt; base_dir = os.getcwd()</span>
<span class="sd">         &gt;&gt; data_dir = os.path.join(&#39;..&#39;,&#39;atomic-data&#39;, &#39;collection&#39;)</span>
<span class="sd">         &gt;&gt; atom_omij_file = os.path.join(base_dir,data_dir, &#39;AtomOmij.fits&#39;)</span>
<span class="sd">         &gt;&gt; atom=&#39;o&#39;</span>
<span class="sd">         &gt;&gt; ion=&#39;iii&#39;</span>
<span class="sd">         &gt;&gt; list_oiii_omij_reference = atomneb.list_omij_references(atom_omij_file, atom, ion)</span>
<span class="sd">         &gt;&gt; print(list_oiii_omij_reference)</span>
<span class="sd">            AK99 LB94 Pal12-AK99 SSB14</span>
<span class="sd">            </span>
<span class="sd">     :return: This function returns the references.</span>
<span class="sd">     :rtype: str</span>

<span class="sd">     :param atom_omij_file: the FITS data file name (&#39;AtomOmij.fits&#39;)</span>
<span class="sd">     :type atom_omij_file: str</span>
<span class="sd">     </span>
<span class="sd">     :param atom: atom name e.g. &#39;o&#39;</span>
<span class="sd">     :type atom: str</span>
<span class="sd">     </span>
<span class="sd">     :param ion: ionic level e.g &#39;iii&#39;</span>
<span class="sd">     :type ion: str</span>
<span class="sd">     </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">element_data_list</span> <span class="o">=</span> <span class="n">read_omij_list</span><span class="p">(</span><span class="n">atom_omij_file</span><span class="p">)</span>
    <span class="n">atom_ion_name</span> <span class="o">=</span> <span class="n">atom</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">+</span> <span class="s1">&#39;_&#39;</span> <span class="o">+</span> <span class="n">ion</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">+</span> <span class="s1">&#39;_omij_&#39;</span>
    <span class="n">omij_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">element_data_list</span><span class="o">.</span><span class="n">omij_data</span><span class="p">)</span>
    <span class="c1">#omij_res = [x for x in omij_list if re.search(atom_ion_name, x)]</span>
    <span class="n">omij_res</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">omij_list</span> <span class="k">if</span> <span class="n">atom_ion_name</span> <span class="ow">in</span> <span class="n">x</span><span class="p">]</span>
    <span class="n">ii_length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">omij_res</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">ii_length</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;could not find the given element or ion&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="mi">0</span>
    <span class="n">nlines1</span> <span class="o">=</span> <span class="n">ii_length</span>
    <span class="n">references</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nlines1</span><span class="p">)]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">nlines1</span><span class="p">):</span>
        <span class="n">select_omij_data_str1</span> <span class="o">=</span> <span class="n">omij_res</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)</span>
        <span class="n">references</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">select_omij_data_str1</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">references</span></div>

<div class="viewcode-block" id="get_omij_reference_citation"><a class="viewcode-back" href="../api/atomneb.main.html#atomneb.get_omij_reference_citation">[docs]</a><span class="k">def</span> <span class="nf">get_omij_reference_citation</span><span class="p">(</span><span class="n">atom_omij_file</span><span class="p">,</span> <span class="n">atom</span><span class="p">,</span> <span class="n">ion</span><span class="p">,</span> <span class="n">reference</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This function returns the reference citation for collision strengths (Omega_ij)</span>
<span class="sd">        from the 2nd binary table extension of the FITS data file (&#39;AtomOmij.fits&#39;).</span>

<span class="sd">       For example::</span>

<span class="sd">        &gt;&gt; import atomneb</span>
<span class="sd">        &gt;&gt; import numpy as np</span>
<span class="sd">        &gt;&gt; import os</span>
<span class="sd">        &gt;&gt; base_dir = os.getcwd()</span>
<span class="sd">        &gt;&gt; data_dir = os.path.join(&#39;..&#39;,&#39;atomic-data&#39;, &#39;collection&#39;)</span>
<span class="sd">        &gt;&gt; atom_omij_file = os.path.join(base_dir,data_dir, &#39;AtomOmij.fits&#39;)</span>
<span class="sd">        &gt;&gt; atom=&#39;o&#39;</span>
<span class="sd">        &gt;&gt; ion=&#39;iii&#39;</span>
<span class="sd">        &gt;&gt; reference=&#39;SSB14&#39;</span>
<span class="sd">        &gt;&gt; citation = atomneb.get_omij_reference_citation(atom_omij_file, atom, ion, reference)</span>
<span class="sd">        &gt;&gt; print(citation)</span>
<span class="sd">           Storey, P. J., Sochi, T., and Badnell, N. R. 2014, Astron.Astrophys., 441, 3028</span>
<span class="sd">              </span>
<span class="sd">     :return: This function returns the Citation.</span>
<span class="sd">     :rtype: str</span>

<span class="sd">     :param atom_omij_file: the FITS data file name (&#39;AtomOmij.fits&#39;)</span>
<span class="sd">     :type atom_omij_file: str</span>
<span class="sd">     </span>
<span class="sd">     :param atom: atom name e.g. &#39;o&#39;</span>
<span class="sd">     :type atom: str</span>
<span class="sd">     </span>
<span class="sd">     :param ion: ionic level e.g &#39;iii&#39;</span>
<span class="sd">     :type ion: str</span>
<span class="sd">     </span>
<span class="sd">     :param reference: set for the reference e.g. &#39;SSB14&#39;</span>
<span class="sd">     :type reference: str</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">element_data_reference</span> <span class="o">=</span> <span class="n">read_omij_references</span><span class="p">(</span><span class="n">atom_omij_file</span><span class="p">)</span>
    <span class="n">reference_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">element_data_reference</span><span class="o">.</span><span class="n">reference</span><span class="p">)</span>
    <span class="n">atom_ion_name</span> <span class="o">=</span> <span class="n">atom</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">+</span> <span class="s1">&#39;_&#39;</span> <span class="o">+</span> <span class="n">ion</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">+</span> <span class="s1">&#39;_omij_&#39;</span> <span class="o">+</span> <span class="n">reference</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>
    <span class="n">ii</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">reference_list</span> <span class="o">==</span> <span class="n">atom_ion_name</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>  <span class="c1">#</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">ii</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;could not find the given reference&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="mi">0</span>
    <span class="n">citation</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">element_data_reference</span><span class="o">.</span><span class="n">citation</span><span class="p">[</span><span class="n">ii</span><span class="p">])</span>

    <span class="k">return</span> <span class="n">citation</span></div>

<div class="viewcode-block" id="read_aeff_collection"><a class="viewcode-back" href="../api/atomneb.main.html#atomneb.read_aeff_collection">[docs]</a><span class="k">def</span> <span class="nf">read_aeff_collection</span><span class="p">(</span><span class="n">atom_rc_file</span><span class="p">,</span> <span class="n">atom</span><span class="p">,</span> <span class="n">ion</span><span class="p">,</span> <span class="n">br</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">reference</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">         This function returns the effective recombination coefficients (Aeff) from the table extensions</span>
<span class="sd">         of the FITS data file (&#39;rc_collection.fits&#39;).</span>

<span class="sd">        For example::</span>

<span class="sd">         &gt;&gt; import atomneb</span>
<span class="sd">         &gt;&gt; import numpy as np</span>
<span class="sd">         &gt;&gt; import os</span>
<span class="sd">         &gt;&gt; base_dir = os.getcwd()</span>
<span class="sd">         &gt;&gt; data_dir = os.path.join(&#39;..&#39;,&#39;atomic-data-rc&#39;)</span>
<span class="sd">         &gt;&gt; atom_rc_file = os.path.join(base_dir,data_dir, &#39;rc_collection.fits&#39;)</span>
<span class="sd">         &gt;&gt; atom=&#39;c&#39;</span>
<span class="sd">         &gt;&gt; ion=&#39;iii&#39; # C III</span>
<span class="sd">         &gt;&gt; cii_rc_data = atomneb.read_aeff_collection(atom_rc_file, atom, ion)</span>
<span class="sd">         &gt;&gt; n_line = len(cii_rc_data.wavelength)</span>
<span class="sd">         &gt;&gt; for i in range(0, n_line):</span>
<span class="sd">         &gt;&gt;       print(cii_rc_data.wavelength[i], cii_rc_data.a[i],</span>
<span class="sd">         &gt;&gt;             cii_rc_data.b[i], cii_rc_data.c[i],</span>
<span class="sd">         &gt;&gt;             cii_rc_data.d[i], cii_rc_data.f[i])</span>
<span class="sd">            914.00000      0.69280000     0.021400000    -0.016300000     -0.24310000     -0.88000000</span>
<span class="sd">            962.00000       1.0998000   -0.0042000000    -0.027900000     -0.22940000     -0.96560000</span>
<span class="sd">            ...</span>
<span class="sd">         </span>
<span class="sd">     :return: This function returns the effective recombination coefficients. aeff_data (c_iii_aeff) { Wavelength:0.0,a: 0.0, b: 0.0, c: 0.0, d: 0.0, f: 0.0}, aeff_data (n_iii_aeff) { a: 0.0, b: 0.0, c: 0.0}, aeff_data (n_iii_br) {Wavelength: 0.0, BR: 0.0, g1:0, g2:0, Mult1:&#39;&#39;, LowerTerm:&#39;&#39;, UpperTerm:&#39;&#39; }, aeff_data (o_iii_aeff) {Term: &#39;&#39;, Case1: &#39;&#39;, a2: 0.0, a4: 0.0, a5: 0.0, a6: 0.0, b: 0.0, c: 0.0, d: 0.0}, aeff_data (o_iii_br) {Wavelength:double(0.0), Br_A: 0.0, Br_B: 0.0, Br_C: 0.0, g1: 0, g2: 0, Mult1: &#39;&#39;, LowerTerm: &#39;&#39;, UpperTerm: &#39;&#39;}, aeff_data (ne_iii_aeff) {Wavelength:0.0, a: 0.0, b: 0.0, c: 0.0, d: 0.0, f: 0.0, br: 0.0},</span>
<span class="sd">     :rtype: an array of data</span>

<span class="sd">     :param atom_rc_file: the FITS data file name (&#39;rc_collection.fits&#39;)</span>
<span class="sd">     :type atom_rc_file: str       </span>
<span class="sd">           </span>
<span class="sd">     :param atom: atom name e.g. &#39;c&#39;</span>
<span class="sd">     :type atom: str    </span>
<span class="sd">     </span>
<span class="sd">     :param ion: ionic level e.g &#39;iii&#39;</span>
<span class="sd">     :type ion: str </span>
<span class="sd">     </span>
<span class="sd">     :param br: set for the branching ratios (Br)</span>
<span class="sd">     :type br: boolean, optional  </span>
<span class="sd">       </span>
<span class="sd">     :param reference: set for the reference</span>
<span class="sd">     :type reference: str, optional </span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">element_data_list</span> <span class="o">=</span> <span class="n">read_aeff_collection_list</span><span class="p">(</span><span class="n">atom_rc_file</span><span class="p">)</span>

    <span class="k">if</span> <span class="p">(</span><span class="n">br</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">prefix</span> <span class="o">=</span> <span class="s1">&#39;_br&#39;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">prefix</span> <span class="o">=</span> <span class="s1">&#39;_aeff&#39;</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">reference</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">atom_ion_name</span> <span class="o">=</span> <span class="n">atom</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">+</span> <span class="s1">&#39;_&#39;</span> <span class="o">+</span> <span class="n">ion</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">+</span> <span class="n">prefix</span> <span class="o">+</span> <span class="n">reference</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>
        <span class="n">aeff_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">element_data_list</span><span class="o">.</span><span class="n">aeff_data</span><span class="p">)</span>
        <span class="n">ii</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">aeff_list</span><span class="o">==</span> <span class="n">atom_ion_name</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>  <span class="c1">#</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">ii</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;could not find the given element or ion&#39;</span><span class="p">)</span>
            <span class="k">return</span> <span class="mi">0</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">atom_ion_name</span> <span class="o">=</span> <span class="n">atom</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">+</span> <span class="s1">&#39;_&#39;</span> <span class="o">+</span> <span class="n">ion</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">+</span> <span class="n">prefix</span>
        <span class="n">aeff_list</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">element_data_list</span><span class="o">.</span><span class="n">aeff_data</span><span class="p">)</span>
        <span class="c1">#aeff_res = [x for x in aeff_list if re.search(atom_ion_name, x)]</span>
        <span class="n">aeff_res</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">aeff_list</span> <span class="k">if</span> <span class="n">atom_ion_name</span> <span class="ow">in</span> <span class="n">x</span><span class="p">]</span>
        <span class="n">iii</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">aeff_list</span> <span class="o">==</span> <span class="n">aeff_res</span><span class="p">[</span><span class="mi">0</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span>  <span class="c1">#</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">iii</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;could not find the given element or ion&#39;</span><span class="p">)</span>
            <span class="k">return</span> <span class="mi">0</span>
        <span class="n">ii</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">iii</span><span class="p">)</span>
    <span class="n">extension</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">element_data_list</span><span class="o">.</span><span class="n">extension</span><span class="p">)[</span><span class="n">ii</span><span class="p">]</span>
    <span class="n">atom_ion_name</span> <span class="o">=</span> <span class="n">atom</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">+</span> <span class="s1">&#39;_&#39;</span> <span class="o">+</span> <span class="n">ion</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">+</span> <span class="n">prefix</span>

    <span class="n">data</span><span class="p">,</span> <span class="n">header1</span> <span class="o">=</span> <span class="n">getdata</span><span class="p">(</span><span class="n">atom_rc_file</span><span class="p">,</span> <span class="n">extension</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">atom_ion_name</span> <span class="o">==</span> <span class="s1">&#39;c_iii_aeff&#39;</span><span class="p">:</span>
        <span class="n">rc_template</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;wavelength&#39;</span><span class="p">:</span> <span class="nb">float</span><span class="p">(</span><span class="mf">0.0</span><span class="p">),</span> <span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="nb">float</span><span class="p">(</span><span class="mf">0.0</span><span class="p">),</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span><span class="nb">float</span><span class="p">(</span><span class="mf">0.0</span><span class="p">),</span> <span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="nb">float</span><span class="p">(</span><span class="mf">0.0</span><span class="p">),</span> <span class="s1">&#39;d&#39;</span><span class="p">:</span><span class="nb">float</span><span class="p">(</span><span class="mf">0.0</span><span class="p">),</span> <span class="s1">&#39;f&#39;</span><span class="p">:</span><span class="nb">float</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)}</span>
        <span class="n">wavelength</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">WAVELENGTH</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">A</span>
        <span class="n">b</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">B</span>
        <span class="n">c</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">C</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">D</span>
        <span class="n">f</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">F</span>
        <span class="n">n_line</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">wavelength</span><span class="p">)</span>
        <span class="n">rc_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">rc_template</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">n_line</span><span class="p">))</span>
        <span class="n">rc_data</span><span class="o">.</span><span class="n">wavelength</span> <span class="o">=</span> <span class="n">wavelength</span>
        <span class="n">rc_data</span><span class="o">.</span><span class="n">a</span> <span class="o">=</span> <span class="n">a</span>
        <span class="n">rc_data</span><span class="o">.</span><span class="n">b</span> <span class="o">=</span> <span class="n">b</span>
        <span class="n">rc_data</span><span class="o">.</span><span class="n">c</span> <span class="o">=</span> <span class="n">c</span>
        <span class="n">rc_data</span><span class="o">.</span><span class="n">d</span> <span class="o">=</span> <span class="n">d</span>
        <span class="n">rc_data</span><span class="o">.</span><span class="n">f</span> <span class="o">=</span> <span class="n">f</span>
    <span class="k">elif</span> <span class="n">atom_ion_name</span> <span class="o">==</span> <span class="s1">&#39;n_iii_aeff&#39;</span><span class="p">:</span>
        <span class="n">rc_template</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="nb">float</span><span class="p">(</span><span class="mf">0.0</span><span class="p">),</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span><span class="nb">float</span><span class="p">(</span><span class="mf">0.0</span><span class="p">),</span> <span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="nb">float</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)}</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">A</span>
        <span class="n">b</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">B</span>
        <span class="n">c</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">C</span>
        <span class="n">n_line</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
        <span class="n">rc_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">rc_template</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">n_line</span><span class="p">))</span>
        <span class="n">rc_data</span><span class="o">.</span><span class="n">a</span> <span class="o">=</span> <span class="n">a</span>
        <span class="n">rc_data</span><span class="o">.</span><span class="n">b</span> <span class="o">=</span> <span class="n">b</span>
        <span class="n">rc_data</span><span class="o">.</span><span class="n">c</span> <span class="o">=</span> <span class="n">c</span>
    <span class="k">elif</span> <span class="n">atom_ion_name</span> <span class="o">==</span> <span class="s1">&#39;n_iii_br&#39;</span><span class="p">:</span>
        <span class="n">rc_template</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;wavelength&#39;</span><span class="p">:</span><span class="nb">float</span><span class="p">(</span><span class="mf">0.0</span><span class="p">),</span> <span class="s1">&#39;br&#39;</span><span class="p">:</span><span class="nb">float</span><span class="p">(</span><span class="mf">0.0</span><span class="p">),</span>
                      <span class="s1">&#39;g1&#39;</span><span class="p">:</span><span class="nb">int</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="s1">&#39;g2&#39;</span><span class="p">:</span><span class="nb">int</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span>
                      <span class="s1">&#39;mult1&#39;</span><span class="p">:</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;lowerterm&#39;</span><span class="p">:</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;upperterm&#39;</span><span class="p">:</span><span class="s1">&#39;&#39;</span>
                      <span class="p">}</span>
        <span class="n">wavelength</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">WAVELENGTH</span>
        <span class="n">br</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">BR</span>
        <span class="n">g1</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">G1</span>
        <span class="n">g2</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">G2</span>
        <span class="n">mult1</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">MULT1</span>
        <span class="n">lowerterm</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">LOWERTERM</span>
        <span class="n">upperterm</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">UPPERTERM</span>
        <span class="n">mult1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">char</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="n">mult1</span><span class="p">)</span>
        <span class="n">lowerterm</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">char</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="n">lowerterm</span><span class="p">)</span>
        <span class="n">upperterm</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">char</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="n">upperterm</span><span class="p">)</span>
        <span class="n">n_line</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">wavelength</span><span class="p">)</span>
        <span class="n">rc_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">rc_template</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">n_line</span><span class="p">))</span>
        <span class="n">rc_data</span><span class="o">.</span><span class="n">wavelength</span> <span class="o">=</span> <span class="n">wavelength</span>
        <span class="n">rc_data</span><span class="o">.</span><span class="n">br</span> <span class="o">=</span> <span class="n">br</span>
        <span class="n">rc_data</span><span class="o">.</span><span class="n">g1</span> <span class="o">=</span> <span class="n">g1</span>
        <span class="n">rc_data</span><span class="o">.</span><span class="n">g2</span> <span class="o">=</span> <span class="n">g2</span>
        <span class="n">rc_data</span><span class="o">.</span><span class="n">mult1</span> <span class="o">=</span> <span class="n">mult1</span>
        <span class="n">rc_data</span><span class="o">.</span><span class="n">lowerterm</span> <span class="o">=</span> <span class="n">lowerterm</span>
        <span class="n">rc_data</span><span class="o">.</span><span class="n">upperterm</span> <span class="o">=</span> <span class="n">upperterm</span>
    <span class="k">elif</span> <span class="n">atom_ion_name</span> <span class="o">==</span> <span class="s1">&#39;o_iii_aeff&#39;</span><span class="p">:</span>
        <span class="n">rc_template</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;term&#39;</span><span class="p">:</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;case1&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
                     <span class="s1">&#39;a2&#39;</span><span class="p">:</span><span class="nb">float</span><span class="p">(</span><span class="mf">0.0</span><span class="p">),</span> <span class="s1">&#39;a4&#39;</span><span class="p">:</span><span class="nb">float</span><span class="p">(</span><span class="mf">0.0</span><span class="p">),</span> <span class="s1">&#39;a5&#39;</span><span class="p">:</span><span class="nb">float</span><span class="p">(</span><span class="mf">0.0</span><span class="p">),</span> <span class="s1">&#39;a6&#39;</span><span class="p">:</span><span class="nb">float</span><span class="p">(</span><span class="mf">0.0</span><span class="p">),</span>
                     <span class="s1">&#39;b&#39;</span><span class="p">:</span><span class="nb">float</span><span class="p">(</span><span class="mf">0.0</span><span class="p">),</span> <span class="s1">&#39;c&#39;</span><span class="p">:</span><span class="nb">float</span><span class="p">(</span><span class="mf">0.0</span><span class="p">),</span> <span class="s1">&#39;d&#39;</span><span class="p">:</span><span class="nb">float</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)}</span>
        <span class="n">term</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">TERM</span>
        <span class="n">case1</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">CASE1</span>
        <span class="n">a2</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">A2</span>
        <span class="n">a4</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">A4</span>
        <span class="n">a5</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">A5</span>
        <span class="n">a6</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">A6</span>
        <span class="n">b</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">B</span>
        <span class="n">c</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">C</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">D</span>
        <span class="n">term</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">char</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="n">term</span><span class="p">)</span>
        <span class="n">case1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">char</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="n">case1</span><span class="p">)</span>
        <span class="n">n_line</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">a2</span><span class="p">)</span>
        <span class="n">rc_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">rc_template</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">n_line</span><span class="p">))</span>
        <span class="n">rc_data</span><span class="o">.</span><span class="n">term</span> <span class="o">=</span> <span class="n">term</span>
        <span class="n">rc_data</span><span class="o">.</span><span class="n">case1</span> <span class="o">=</span> <span class="n">case1</span>
        <span class="n">rc_data</span><span class="o">.</span><span class="n">a2</span> <span class="o">=</span> <span class="n">a2</span>
        <span class="n">rc_data</span><span class="o">.</span><span class="n">a4</span> <span class="o">=</span> <span class="n">a4</span>
        <span class="n">rc_data</span><span class="o">.</span><span class="n">a5</span> <span class="o">=</span> <span class="n">a5</span>
        <span class="n">rc_data</span><span class="o">.</span><span class="n">a6</span> <span class="o">=</span> <span class="n">a6</span>
        <span class="n">rc_data</span><span class="o">.</span><span class="n">b</span> <span class="o">=</span> <span class="n">b</span>
        <span class="n">rc_data</span><span class="o">.</span><span class="n">c</span> <span class="o">=</span> <span class="n">c</span>
        <span class="n">rc_data</span><span class="o">.</span><span class="n">d</span> <span class="o">=</span> <span class="n">d</span>
    <span class="k">elif</span> <span class="n">atom_ion_name</span> <span class="o">==</span> <span class="s1">&#39;o_iii_br&#39;</span><span class="p">:</span>
        <span class="n">rc_template</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;wavelength&#39;</span><span class="p">:</span><span class="nb">float</span><span class="p">(</span><span class="mf">0.0</span><span class="p">),</span>
                     <span class="s1">&#39;br_a&#39;</span><span class="p">:</span><span class="nb">float</span><span class="p">(</span><span class="mf">0.0</span><span class="p">),</span> <span class="s1">&#39;br_b&#39;</span><span class="p">:</span><span class="nb">float</span><span class="p">(</span><span class="mf">0.0</span><span class="p">),</span> <span class="s1">&#39;br_c&#39;</span><span class="p">:</span><span class="nb">float</span><span class="p">(</span><span class="mf">0.0</span><span class="p">),</span>
                     <span class="s1">&#39;g1&#39;</span><span class="p">:</span><span class="nb">int</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="s1">&#39;g2&#39;</span><span class="p">:</span><span class="nb">int</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span>
                     <span class="s1">&#39;mult1&#39;</span><span class="p">:</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;lowerterm&#39;</span><span class="p">:</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;upperterm&#39;</span><span class="p">:</span><span class="s1">&#39;&#39;</span> <span class="p">}</span>
        <span class="n">wavelength</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">WAVELENGTH</span>
        <span class="n">br_a</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">BR_A</span>
        <span class="n">br_b</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">BR_B</span>
        <span class="n">br_c</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">BR_C</span>
        <span class="n">g1</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">G1</span>
        <span class="n">g2</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">G2</span>
        <span class="n">mult1</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">MULT1</span>
        <span class="n">lowerterm</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">LOWERTERM</span>
        <span class="n">upperterm</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">UPPERTERM</span>
        <span class="n">mult1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">char</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="n">mult1</span><span class="p">)</span>
        <span class="n">lowerterm</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">char</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="n">lowerterm</span><span class="p">)</span>
        <span class="n">upperterm</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">char</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="n">upperterm</span><span class="p">)</span>
        <span class="n">n_line</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">br_a</span><span class="p">)</span>
        <span class="n">rc_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">rc_template</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">n_line</span><span class="p">))</span>
        <span class="n">rc_data</span><span class="o">.</span><span class="n">wavelength</span> <span class="o">=</span> <span class="n">wavelength</span>
        <span class="n">rc_data</span><span class="o">.</span><span class="n">br_a</span> <span class="o">=</span> <span class="n">br_a</span>
        <span class="n">rc_data</span><span class="o">.</span><span class="n">br_b</span> <span class="o">=</span> <span class="n">br_b</span>
        <span class="n">rc_data</span><span class="o">.</span><span class="n">br_c</span> <span class="o">=</span> <span class="n">br_c</span>
        <span class="n">rc_data</span><span class="o">.</span><span class="n">g1</span> <span class="o">=</span> <span class="n">g1</span>
        <span class="n">rc_data</span><span class="o">.</span><span class="n">g2</span> <span class="o">=</span> <span class="n">g2</span>
        <span class="n">rc_data</span><span class="o">.</span><span class="n">mult1</span> <span class="o">=</span> <span class="n">mult1</span>
        <span class="n">rc_data</span><span class="o">.</span><span class="n">lowerterm</span> <span class="o">=</span> <span class="n">lowerterm</span>
        <span class="n">rc_data</span><span class="o">.</span><span class="n">upperterm</span> <span class="o">=</span> <span class="n">upperterm</span>
    <span class="k">elif</span> <span class="n">atom_ion_name</span> <span class="o">==</span> <span class="s1">&#39;ne_iii_aeff&#39;</span><span class="p">:</span>
        <span class="n">rc_template</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;wavelength&#39;</span><span class="p">:</span> <span class="nb">float</span><span class="p">(</span><span class="mf">0.0</span><span class="p">),</span> <span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="nb">float</span><span class="p">(</span><span class="mf">0.0</span><span class="p">),</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span><span class="nb">float</span><span class="p">(</span><span class="mf">0.0</span><span class="p">),</span> <span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="nb">float</span><span class="p">(</span><span class="mf">0.0</span><span class="p">),</span> <span class="s1">&#39;d&#39;</span><span class="p">:</span><span class="nb">float</span><span class="p">(</span><span class="mf">0.0</span><span class="p">),</span> <span class="s1">&#39;f&#39;</span><span class="p">:</span><span class="nb">float</span><span class="p">(</span><span class="mf">0.0</span><span class="p">),</span> <span class="s1">&#39;br&#39;</span><span class="p">:</span><span class="nb">float</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)}</span>
        <span class="n">wavelength</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">WAVELENGTH</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">A</span>
        <span class="n">b</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">B</span>
        <span class="n">c</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">C</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">D</span>
        <span class="n">f</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">F</span>
        <span class="n">br</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">BR</span>
        <span class="n">n_line</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">wavelength</span><span class="p">)</span>
        <span class="n">rc_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">rc_template</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">n_line</span><span class="p">))</span>
        <span class="n">rc_data</span><span class="o">.</span><span class="n">wavelength</span> <span class="o">=</span> <span class="n">wavelength</span>
        <span class="n">rc_data</span><span class="o">.</span><span class="n">a</span> <span class="o">=</span> <span class="n">a</span>
        <span class="n">rc_data</span><span class="o">.</span><span class="n">b</span> <span class="o">=</span> <span class="n">b</span>
        <span class="n">rc_data</span><span class="o">.</span><span class="n">c</span> <span class="o">=</span> <span class="n">c</span>
        <span class="n">rc_data</span><span class="o">.</span><span class="n">d</span> <span class="o">=</span> <span class="n">d</span>
        <span class="n">rc_data</span><span class="o">.</span><span class="n">f</span> <span class="o">=</span> <span class="n">f</span>
        <span class="n">rc_data</span><span class="o">.</span><span class="n">br</span> <span class="o">=</span> <span class="n">br</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;no match found for expression&#39;</span><span class="p">)</span>
    <span class="c1"># endfor</span>
    <span class="k">return</span> <span class="n">rc_data</span></div>

<div class="viewcode-block" id="read_aeff_collection_list"><a class="viewcode-back" href="../api/atomneb.main.html#atomneb.read_aeff_collection_list">[docs]</a><span class="k">def</span> <span class="nf">read_aeff_collection_list</span><span class="p">(</span><span class="n">atom_rc_file</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">         This function returns the list of effective recombination coefficients (Aeff) from the 1st binary table extension</span>
<span class="sd">         of the FITS data file (&#39;rc_collection.fits&#39;)</span>

<span class="sd">     :return: This function returns the aeff_data_list: { Aeff_Data:&#39;&#39;, Extension:0.0}</span>
<span class="sd">     :rtype: an array of data</span>
<span class="sd">     </span>
<span class="sd">     :param atom_rc_file: the FITS data file name (&#39;rc_collection.fits&#39;)</span>
<span class="sd">     :type atom_rc_file: str</span>
<span class="sd">     </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">element_template</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;aeff_data&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;extension&#39;</span><span class="p">:</span> <span class="mi">0</span> <span class="p">}</span>
    <span class="n">data</span><span class="p">,</span> <span class="n">hdr</span> <span class="o">=</span> <span class="n">getdata</span><span class="p">(</span><span class="n">atom_rc_file</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">aeff_data</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">AEFF_DATA</span>
    <span class="n">extension</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">EXTENSION</span>
    <span class="n">element_length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">aeff_data</span><span class="p">)</span>

    <span class="n">element_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">element_template</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">element_length</span><span class="p">))</span>
    <span class="c1">#aij_data=aij_data.strip</span>
    <span class="n">aeff_data</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">char</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="n">aeff_data</span><span class="p">)</span>
    <span class="n">element_data</span><span class="o">.</span><span class="n">aeff_data</span><span class="o">=</span><span class="n">aeff_data</span>
    <span class="n">element_data</span><span class="o">.</span><span class="n">extension</span> <span class="o">=</span> <span class="n">extension</span>

    <span class="k">return</span> <span class="n">element_data</span></div>

<div class="viewcode-block" id="search_aeff_collection"><a class="viewcode-back" href="../api/atomneb.main.html#atomneb.search_aeff_collection">[docs]</a><span class="k">def</span> <span class="nf">search_aeff_collection</span><span class="p">(</span><span class="n">atom_rc_file</span><span class="p">,</span> <span class="n">atom</span><span class="p">,</span> <span class="n">ion</span><span class="p">,</span> <span class="n">br</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">         This function searches effective recombination coefficients (Aeff) for given element</span>
<span class="sd">         and ionic levels in the FITS data file (&#39;rc_collection.fits&#39;), and returns the data entry.</span>

<span class="sd">        For example::</span>

<span class="sd">         &gt;&gt; import atomneb</span>
<span class="sd">         &gt;&gt; import numpy as np</span>
<span class="sd">         &gt;&gt; import os</span>
<span class="sd">         &gt;&gt; base_dir = os.getcwd()</span>
<span class="sd">         &gt;&gt; data_dir = os.path.join(&#39;..&#39;,&#39;atomic-data-rc&#39;)</span>
<span class="sd">         &gt;&gt; atom_rc_file = os.path.join(base_dir,data_dir, &#39;rc_collection.fits&#39;)</span>
<span class="sd">         &gt;&gt; atom=&#39;c&#39;</span>
<span class="sd">         &gt;&gt; ion=&#39;iii&#39; # C III</span>
<span class="sd">         &gt;&gt; list_cii_aeff_data = atomneb.search_aeff_collection(atom_rc_file, atom, ion)</span>
<span class="sd">         &gt;&gt; print(list_cii_aeff_data)</span>
<span class="sd">            c_iii_aeff</span>

<span class="sd">     :return: This function returns the Aeff_Data.</span>
<span class="sd">     :rtype: an array of data</span>
<span class="sd">     </span>
<span class="sd">     :param atom_rc_file: the FITS data file name (&#39;rc_collection.fits&#39;)</span>
<span class="sd">     :type atom_rc_file: str</span>
<span class="sd">     </span>
<span class="sd">     :param atom: atom name e.g. &#39;c&#39;</span>
<span class="sd">     :type atom: str</span>
<span class="sd">     </span>
<span class="sd">     :param ion: ionic level e.g &#39;iii&#39;</span>
<span class="sd">     :type ion: str</span>
<span class="sd">     </span>
<span class="sd">     :param br: set for the branching ratios (Br), may not necessary</span>
<span class="sd">     :type br: boolean, optional</span>
<span class="sd">                         </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">br</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">prefix</span> <span class="o">=</span> <span class="s1">&#39;_br&#39;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">prefix</span> <span class="o">=</span> <span class="s1">&#39;_aeff&#39;</span>

    <span class="n">element_data_list</span> <span class="o">=</span> <span class="n">read_aeff_collection_list</span><span class="p">(</span><span class="n">atom_rc_file</span><span class="p">)</span>
    <span class="n">atom_ion_name</span> <span class="o">=</span> <span class="n">atom</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">+</span> <span class="s1">&#39;_&#39;</span> <span class="o">+</span> <span class="n">ion</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">+</span> <span class="n">prefix</span>
    <span class="n">aeff_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">element_data_list</span><span class="o">.</span><span class="n">aeff_data</span><span class="p">)</span>
    <span class="c1">#aeff_res = [x for x in aeff_list if re.search(atom_ion_name, x)]</span>
    <span class="n">aeff_res</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">aeff_list</span> <span class="k">if</span> <span class="n">atom_ion_name</span> <span class="ow">in</span> <span class="n">x</span><span class="p">]</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">aeff_res</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;could not find the given element or ion&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="mi">0</span>
    <span class="n">select_aeff_data</span> <span class="o">=</span> <span class="n">aeff_res</span>
    <span class="k">return</span> <span class="n">select_aeff_data</span></div>

<div class="viewcode-block" id="read_aeff_collection_references"><a class="viewcode-back" href="../api/atomneb.main.html#atomneb.read_aeff_collection_references">[docs]</a><span class="k">def</span> <span class="nf">read_aeff_collection_references</span><span class="p">(</span><span class="n">atom_rc_file</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">         This function returns the reference list of recombination coefficients (Aeff) from the 2nd binary table extension</span>
<span class="sd">         of the FITS data file (&#39;rc_collection.fits&#39;).</span>

<span class="sd">     :return: This function returns the aeff_data_reference: { Reference:&#39;&#39;, Citation:&#39;&#39;}</span>
<span class="sd">     :rtype: an array of data</span>

<span class="sd">     :param atom_rc_file: the FITS data file name (&#39;rc_collection.fits&#39;)</span>
<span class="sd">     :type atom_rc_file: str</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">reference_template</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;reference&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;citation&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">}</span>
    <span class="n">data</span><span class="p">,</span> <span class="n">hdr</span> <span class="o">=</span> <span class="n">getdata</span><span class="p">(</span><span class="n">atom_rc_file</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">reference</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">ATOMICDATA</span>
    <span class="n">citation</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">REFERENCE</span>
    <span class="n">reference_length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">reference</span><span class="p">)</span>

    <span class="n">reference_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">reference_template</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">reference_length</span><span class="p">))</span>
    <span class="c1"># aij_data=aij_data.strip</span>
    <span class="n">reference</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">char</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="n">reference</span><span class="p">)</span>
    <span class="n">citation</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">char</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="n">citation</span><span class="p">)</span>
    <span class="n">reference_data</span><span class="o">.</span><span class="n">reference</span> <span class="o">=</span> <span class="n">reference</span>
    <span class="n">reference_data</span><span class="o">.</span><span class="n">citation</span> <span class="o">=</span> <span class="n">citation</span>
    <span class="k">return</span> <span class="n">reference_data</span></div>

<div class="viewcode-block" id="list_aeff_collection_references"><a class="viewcode-back" href="../api/atomneb.main.html#atomneb.list_aeff_collection_references">[docs]</a><span class="k">def</span> <span class="nf">list_aeff_collection_references</span><span class="p">(</span><span class="n">atom_rc_file</span><span class="p">,</span> <span class="n">atom</span><span class="p">,</span> <span class="n">ion</span><span class="p">,</span> <span class="n">br</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">         This function returns a list for all references of recombination coefficients (Aeff)</span>
<span class="sd">         for given element and ionic level from the FITS data file (&#39;rc_collection.fits&#39;).</span>

<span class="sd">        For example::</span>

<span class="sd">         &gt;&gt; import atomneb</span>
<span class="sd">         &gt;&gt; import numpy as np</span>
<span class="sd">         &gt;&gt; import os</span>
<span class="sd">         &gt;&gt; base_dir = os.getcwd()</span>
<span class="sd">         &gt;&gt; data_dir = os.path.join(&#39;..&#39;,&#39;atomic-data-rc&#39;)</span>
<span class="sd">         &gt;&gt; atom_rc_file = os.path.join(base_dir,data_dir, &#39;rc_collection.fits&#39;)</span>
<span class="sd">         &gt;&gt; atom=&#39;c&#39;</span>
<span class="sd">         &gt;&gt; ion=&#39;iii&#39; # C III</span>
<span class="sd">         &gt;&gt; list_cii_aeff_reference = atomneb.list_aeff_collection_references(atom_rc_file, atom, ion)</span>
<span class="sd">         &gt;&gt; print(list_cii_aeff_reference)</span>
<span class="sd">         </span>
<span class="sd">     :return: This function returns the references.</span>
<span class="sd">     :rtype: an array of strings</span>
<span class="sd">     </span>
<span class="sd">     :param atom_rc_file: the FITS data file name (&#39;rc_collection.fits&#39;)</span>
<span class="sd">     :type atom_rc_file: str</span>
<span class="sd">     </span>
<span class="sd">     :param atom:  atom name e.g. &#39;c&#39;</span>
<span class="sd">     :type atom: str</span>
<span class="sd">     </span>
<span class="sd">     :param ion: ionic level e.g &#39;iii&#39;</span>
<span class="sd">     :type ion: str</span>
<span class="sd">     </span>
<span class="sd">     :param br: set for the branching ratios (Br)</span>
<span class="sd">     :type br: boolean, optional</span>
<span class="sd">     </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">element_data_list</span> <span class="o">=</span> <span class="n">read_aeff_collection_list</span><span class="p">(</span><span class="n">atom_rc_file</span><span class="p">)</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">br</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">prefix</span> <span class="o">=</span> <span class="s1">&#39;_br&#39;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">prefix</span> <span class="o">=</span> <span class="s1">&#39;_aeff&#39;</span>
    <span class="n">atom_ion_name</span> <span class="o">=</span> <span class="n">atom</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">+</span> <span class="s1">&#39;_&#39;</span> <span class="o">+</span> <span class="n">ion</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">+</span> <span class="n">prefix</span>
    <span class="n">aeff_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">element_data_list</span><span class="o">.</span><span class="n">aeff_data</span><span class="p">)</span>
    <span class="c1">#aeff_res = [x for x in aeff_list if re.search(atom_ion_name, x)]</span>
    <span class="n">aeff_res</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">aeff_list</span> <span class="k">if</span> <span class="n">atom_ion_name</span> <span class="ow">in</span> <span class="n">x</span><span class="p">]</span>
    <span class="n">ii_length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">aeff_res</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">ii_length</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;could not find the given element or ion&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="mi">0</span>
    <span class="n">nlines1</span> <span class="o">=</span> <span class="n">ii_length</span>  <span class="c1"># temp[0]</span>
    <span class="n">references</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nlines1</span><span class="p">)]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">nlines1</span><span class="p">):</span>
        <span class="n">select_aeff_data_str1</span> <span class="o">=</span> <span class="n">aeff_res</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)</span>
        <span class="n">ref_num</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">select_aeff_data_str1</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">ref_num</span> <span class="o">&gt;</span> <span class="mi">3</span><span class="p">:</span>
            <span class="n">references</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">select_aeff_data_str1</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">references</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
    <span class="k">return</span> <span class="n">references</span></div>

<div class="viewcode-block" id="get_aeff_collection_reference_citation"><a class="viewcode-back" href="../api/atomneb.main.html#atomneb.get_aeff_collection_reference_citation">[docs]</a><span class="k">def</span> <span class="nf">get_aeff_collection_reference_citation</span><span class="p">(</span><span class="n">atom_rc_file</span><span class="p">,</span> <span class="n">atom</span><span class="p">,</span> <span class="n">ion</span><span class="p">,</span> <span class="n">br</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">reference</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">         This function returns the reference citation for a recombination coefficient (Aeff)</span>
<span class="sd">         from the 2nd binary table extension of the FITS data file (&#39;rc_collection.fits&#39;).</span>

<span class="sd">        For example::</span>

<span class="sd">         &gt;&gt; import atomneb</span>
<span class="sd">         &gt;&gt; import numpy as np</span>
<span class="sd">         &gt;&gt; import os</span>
<span class="sd">         &gt;&gt; base_dir = os.getcwd()</span>
<span class="sd">         &gt;&gt; data_dir = os.path.join(&#39;..&#39;,&#39;atomic-data-rc&#39;)</span>
<span class="sd">         &gt;&gt; atom_rc_file = os.path.join(base_dir,data_dir, &#39;rc_collection.fits&#39;)</span>
<span class="sd">         &gt;&gt; atom=&#39;c&#39;</span>
<span class="sd">         &gt;&gt; ion=&#39;iii&#39; # C III</span>
<span class="sd">         &gt;&gt; citation = atomneb.get_aeff_collection_reference_citation(atom_rc_file, atom, ion)</span>
<span class="sd">         &gt;&gt; print(citation)</span>
<span class="sd">            Davey, A. R., Storey, P. J. and Kisielius, R., Astron.Astrophys.Suppl., 142, 85, 2000</span>
<span class="sd">                    </span>
<span class="sd">     :return: This function returns the Citation.</span>
<span class="sd">     :rtype: str</span>
<span class="sd">     </span>
<span class="sd">     :param atom_rc_file: the FITS data file name (&#39;rc_collection.fits&#39;)</span>
<span class="sd">     :type atom_rc_file: str</span>
<span class="sd">     </span>
<span class="sd">     :param atom:  atom name e.g. &#39;c&#39;</span>
<span class="sd">     :type atom: str</span>
<span class="sd">     </span>
<span class="sd">     :param ion: ionic level e.g &#39;iii&#39;</span>
<span class="sd">     :type ion: str</span>
<span class="sd">   </span>
<span class="sd">     :param br: set for the branching ratios (Br)</span>
<span class="sd">     :type br: boolean, optional</span>
<span class="sd">     </span>
<span class="sd">     :param reference: set for the reference</span>
<span class="sd">     :type reference: str, optional</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">element_data_reference</span> <span class="o">=</span> <span class="n">read_aeff_collection_references</span><span class="p">(</span><span class="n">atom_rc_file</span><span class="p">)</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">br</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">prefix</span> <span class="o">=</span> <span class="s1">&#39;_br&#39;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">prefix</span> <span class="o">=</span> <span class="s1">&#39;_aeff&#39;</span>
    <span class="n">reference_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">element_data_reference</span><span class="o">.</span><span class="n">reference</span><span class="p">)</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">reference</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">atom_ion_name</span> <span class="o">=</span> <span class="n">atom</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">+</span> <span class="s1">&#39;_&#39;</span> <span class="o">+</span> <span class="n">ion</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">+</span> <span class="n">prefix</span> <span class="o">+</span> <span class="s1">&#39;_&#39;</span> <span class="o">+</span> <span class="n">reference</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">atom_ion_name</span> <span class="o">=</span> <span class="n">atom</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">+</span> <span class="s1">&#39;_&#39;</span> <span class="o">+</span> <span class="n">ion</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">+</span> <span class="n">prefix</span>
    <span class="n">ii</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">reference_list</span> <span class="o">==</span> <span class="n">atom_ion_name</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>  <span class="c1">#</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">ii</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;could not find the given reference&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="mi">0</span>
    <span class="n">citation</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">element_data_reference</span><span class="o">.</span><span class="n">citation</span><span class="p">[</span><span class="n">ii</span><span class="p">])</span>

    <span class="k">return</span> <span class="n">citation</span></div>

<div class="viewcode-block" id="read_aeff_sh95"><a class="viewcode-back" href="../api/atomneb.main.html#atomneb.read_aeff_sh95">[docs]</a><span class="k">def</span> <span class="nf">read_aeff_sh95</span><span class="p">(</span><span class="n">atom_rc_file</span><span class="p">,</span> <span class="n">atom</span><span class="p">,</span> <span class="n">ion</span><span class="p">,</span> <span class="n">reference</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">case1</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">         This function returns the effective recombination coefficients (Aeff) from the table extensions</span>
<span class="sd">         of the FITS data file (&#39;rc_SH95.fits&#39;).</span>

<span class="sd">        For example::</span>

<span class="sd">         &gt;&gt; import atomneb</span>
<span class="sd">         &gt;&gt; import numpy as np</span>
<span class="sd">         &gt;&gt; import os</span>
<span class="sd">         &gt;&gt; base_dir = os.getcwd()</span>
<span class="sd">         &gt;&gt; data_dir = os.path.join(&#39;..&#39;,&#39;atomic-data-rc&#39;)</span>
<span class="sd">         &gt;&gt; atom_rc_file = os.path.join(base_dir,data_dir, &#39;rc_SH95.fits&#39;)</span>
<span class="sd">         &gt;&gt; atom=&#39;h&#39;</span>
<span class="sd">         &gt;&gt; ion=&#39;ii&#39; # H I</span>
<span class="sd">         &gt;&gt; hi_rc_data = atomneb.read_aeff_sh95(atom_rc_file, atom, ion)</span>
<span class="sd">         &gt;&gt; print(hi_rc_data.aeff[0])</span>
<span class="sd">            100.00000       500.00000       0.0000000   4.2140000e-27    1.7560000e-27  ...</span>
<span class="sd">            ...</span>
<span class="sd">                    </span>
<span class="sd">     :return: This function returns the effective recombination coefficients.</span>
<span class="sd">     :rtype: an array of data</span>
<span class="sd">     </span>
<span class="sd">     :param atom_rc_file: the FITS data file name (&#39;rc_SH95.fits&#39;)</span>
<span class="sd">     :type atom_rc_file: str</span>
<span class="sd">     </span>
<span class="sd">     :param atom:  atom name e.g. &#39;h&#39;</span>
<span class="sd">     :type atom: str</span>
<span class="sd">     </span>
<span class="sd">     :param ion: ionic level e.g &#39;ii&#39;</span>
<span class="sd">     :type ion: str</span>
<span class="sd">   </span>
<span class="sd">     :param reference: set for the reference</span>
<span class="sd">     :type reference: str, optional</span>
<span class="sd">     </span>
<span class="sd">     :param case1: set for the case &#39;a&#39; or &#39;b&#39;, defualt &#39;b&#39;</span>
<span class="sd">     :type case1: boolean, optional</span>
<span class="sd">     </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">element_data_list</span> <span class="o">=</span> <span class="n">read_aeff_sh95_list</span><span class="p">(</span><span class="n">atom_rc_file</span><span class="p">)</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">reference</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">atom_ion_name</span> <span class="o">=</span> <span class="n">atom</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">+</span> <span class="s1">&#39;_&#39;</span> <span class="o">+</span> <span class="n">ion</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">+</span> <span class="s1">&#39;_aeff&#39;</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">case1</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">atom_ion_name</span> <span class="o">=</span> <span class="n">atom_ion_name</span> <span class="o">+</span> <span class="s1">&#39;_&#39;</span> <span class="o">+</span> <span class="n">case1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">atom_ion_name</span> <span class="o">=</span> <span class="n">atom_ion_name</span> <span class="o">+</span> <span class="s1">&#39;_b&#39;</span>
        <span class="n">atom_ion_name</span> <span class="o">=</span> <span class="n">atom_ion_name</span> <span class="o">+</span> <span class="s1">&#39;_&#39;</span> <span class="o">+</span> <span class="n">reference</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>
        <span class="n">aeff_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">element_data_list</span><span class="o">.</span><span class="n">aeff_data</span><span class="p">)</span>
        <span class="n">ii</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">aeff_list</span> <span class="o">==</span> <span class="n">atom_ion_name</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">ii</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;could not find the given element or ion&#39;</span><span class="p">)</span>
            <span class="k">return</span> <span class="mi">0</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">atom_ion_name</span> <span class="o">=</span> <span class="n">atom</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">+</span> <span class="s1">&#39;_&#39;</span> <span class="o">+</span> <span class="n">ion</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">+</span> <span class="s1">&#39;_aeff&#39;</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">case1</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">atom_ion_name</span> <span class="o">=</span> <span class="n">atom_ion_name</span> <span class="o">+</span> <span class="s1">&#39;_&#39;</span> <span class="o">+</span> <span class="n">case1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">atom_ion_name</span> <span class="o">=</span> <span class="n">atom_ion_name</span> <span class="o">+</span> <span class="s1">&#39;_b&#39;</span>
        <span class="n">aeff_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">element_data_list</span><span class="o">.</span><span class="n">aeff_data</span><span class="p">)</span>
        <span class="c1">#aeff_res = [x for x in aeff_list if re.search(atom_ion_name, x)]</span>
        <span class="n">aeff_res</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">aeff_list</span> <span class="k">if</span> <span class="n">atom_ion_name</span> <span class="ow">in</span> <span class="n">x</span><span class="p">]</span>
        <span class="n">iii</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">aeff_list</span> <span class="o">==</span> <span class="n">aeff_res</span><span class="p">[</span><span class="mi">0</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span>  <span class="c1">#</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">iii</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;could not find the given element or ion&#39;</span><span class="p">)</span>
            <span class="k">return</span> <span class="mi">0</span>
        <span class="n">ii</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">iii</span><span class="p">)</span>
    <span class="n">extension</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">element_data_list</span><span class="o">.</span><span class="n">extension</span><span class="p">)[</span><span class="n">ii</span><span class="p">]</span>
    <span class="n">rc_aeff</span><span class="p">,</span> <span class="n">header1</span> <span class="o">=</span> <span class="n">getdata</span><span class="p">(</span><span class="n">atom_rc_file</span><span class="p">,</span> <span class="n">extension</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">col1</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">rc_aeff</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">row1</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">rc_aeff</span><span class="p">)</span>

    <span class="n">aeff_template</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;aeff&#39;</span><span class="p">:</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">row1</span><span class="p">,</span><span class="n">col1</span><span class="p">))}</span>
    <span class="n">rc_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">aeff_template</span><span class="o">.</span><span class="n">items</span><span class="p">()],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">keys</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">aeff_template</span><span class="o">.</span><span class="n">keys</span><span class="p">()))</span>
    <span class="n">rc_data</span><span class="o">.</span><span class="n">aeff</span> <span class="o">=</span> <span class="n">rc_aeff</span>

    <span class="k">return</span> <span class="n">rc_data</span></div>

<div class="viewcode-block" id="read_aeff_sh95_list"><a class="viewcode-back" href="../api/atomneb.main.html#atomneb.read_aeff_sh95_list">[docs]</a><span class="k">def</span> <span class="nf">read_aeff_sh95_list</span><span class="p">(</span><span class="n">atom_rc_file</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">         This function returns the list of effective recombination coefficients (Aeff) from the 1st binary table extension</span>
<span class="sd">         of the FITS data file (&#39;rc_SH95.fits&#39;)</span>

<span class="sd">     :return: This function returns the aeff_data_list: { Aeff_Data:&#39;&#39;, Extension:0.0}</span>
<span class="sd">     :rtype: an array of data</span>

<span class="sd">     :param atom_rc_file: the FITS data file name (&#39;rc_SH95.fits&#39;)</span>
<span class="sd">     :type atom_rc_file: str</span>
<span class="sd">                         </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">element_template</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;aeff_data&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;extension&#39;</span><span class="p">:</span> <span class="mi">0</span> <span class="p">}</span>
    <span class="n">data</span><span class="p">,</span> <span class="n">hdr</span> <span class="o">=</span> <span class="n">getdata</span><span class="p">(</span><span class="n">atom_rc_file</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">aeff_data</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">AEFF_DATA</span>
    <span class="n">extension</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">EXTENSION</span>
    <span class="n">element_length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">aeff_data</span><span class="p">)</span>

    <span class="n">element_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">element_template</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">element_length</span><span class="p">))</span>
    <span class="c1">#aij_data=aij_data.strip</span>
    <span class="n">aeff_data</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">char</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="n">aeff_data</span><span class="p">)</span>
    <span class="n">element_data</span><span class="o">.</span><span class="n">aeff_data</span><span class="o">=</span><span class="n">aeff_data</span>
    <span class="n">element_data</span><span class="o">.</span><span class="n">extension</span> <span class="o">=</span> <span class="n">extension</span>

    <span class="k">return</span> <span class="n">element_data</span></div>

<div class="viewcode-block" id="search_aeff_sh95"><a class="viewcode-back" href="../api/atomneb.main.html#atomneb.search_aeff_sh95">[docs]</a><span class="k">def</span> <span class="nf">search_aeff_sh95</span><span class="p">(</span><span class="n">atom_rc_file</span><span class="p">,</span> <span class="n">atom</span><span class="p">,</span> <span class="n">ion</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">         This function searches effective recombination coefficients (Aeff) for given element</span>
<span class="sd">         and ionic levels in the FITS data file (&#39;rec_SH95.fits&#39;), and returns the data entry.</span>

<span class="sd">        For example::</span>

<span class="sd">         &gt;&gt; import atomneb</span>
<span class="sd">         &gt;&gt; import numpy as np</span>
<span class="sd">         &gt;&gt; import os</span>
<span class="sd">         &gt;&gt; base_dir = os.getcwd()</span>
<span class="sd">         &gt;&gt; data_dir = os.path.join(&#39;..&#39;,&#39;atomic-data-rc&#39;)</span>
<span class="sd">         &gt;&gt; atom_rc_file = os.path.join(base_dir,data_dir, &#39;rc_SH95.fits&#39;)</span>
<span class="sd">         &gt;&gt; atom=&#39;h&#39;</span>
<span class="sd">         &gt;&gt; ion=&#39;ii&#39; # H I</span>
<span class="sd">         &gt;&gt; list_hi_aeff_data = atomneb.search_aeff_sh95(atom_rc_file, atom, ion)</span>
<span class="sd">         &gt;&gt; print(list_hi_aeff_data)</span>
<span class="sd">            h_ii_aeff_a h_ii_aeff_b</span>
<span class="sd">           </span>
<span class="sd">     :return: This function returns the Aeff_Data.</span>
<span class="sd">     :rtype: an array of data</span>
<span class="sd">     </span>
<span class="sd">     :param atom_rc_file: the FITS data file name (&#39;rc_SH95.fits&#39;)</span>
<span class="sd">     :type atom_rc_file: str</span>
<span class="sd">  </span>
<span class="sd">     :param atom: atom name e.g. &#39;h&#39;</span>
<span class="sd">     :type atom: str</span>
<span class="sd">     </span>
<span class="sd">     :param ion: ionic level e.g &#39;ii&#39;</span>
<span class="sd">     :type ion: str</span>
<span class="sd">     </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">element_data_list</span> <span class="o">=</span> <span class="n">read_aeff_sh95_list</span><span class="p">(</span><span class="n">atom_rc_file</span><span class="p">)</span>
    <span class="n">atom_ion_name</span> <span class="o">=</span> <span class="n">atom</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">+</span> <span class="s1">&#39;_&#39;</span> <span class="o">+</span> <span class="n">ion</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">+</span> <span class="s1">&#39;_aeff&#39;</span>
    <span class="n">aeff_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">element_data_list</span><span class="o">.</span><span class="n">aeff_data</span><span class="p">)</span>
    <span class="c1">#aeff_res = [x for x in aeff_list if re.search(atom_ion_name, x)]</span>
    <span class="n">aeff_res</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">aeff_list</span> <span class="k">if</span> <span class="n">atom_ion_name</span> <span class="ow">in</span> <span class="n">x</span><span class="p">]</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">aeff_res</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;could not find the given element or ion&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="mi">0</span>
    <span class="n">select_aeff_data</span> <span class="o">=</span> <span class="n">aeff_res</span>
    <span class="k">return</span> <span class="n">select_aeff_data</span></div>

<div class="viewcode-block" id="read_aeff_sh95_references"><a class="viewcode-back" href="../api/atomneb.main.html#atomneb.read_aeff_sh95_references">[docs]</a><span class="k">def</span> <span class="nf">read_aeff_sh95_references</span><span class="p">(</span><span class="n">atom_rc_file</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">         This function returns the reference list of recombination coefficients (Aeff) from the 2nd binary table extension</span>
<span class="sd">         of the FITS data file (&#39;rc_SH95.fits&#39;).</span>

<span class="sd">     :return: This function returns the aeff_data_reference: { Reference:&#39;&#39;, Citation:&#39;&#39;}</span>
<span class="sd">     :rtype: an array of data</span>

<span class="sd">     :param atom_rc_file: the FITS data file name (&#39;rc_SH95.fits&#39;)</span>
<span class="sd">     :type atom_rc_file: str</span>
<span class="sd">     </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">reference_template</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;reference&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;citation&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">}</span>
    <span class="n">data</span><span class="p">,</span> <span class="n">hdr</span> <span class="o">=</span> <span class="n">getdata</span><span class="p">(</span><span class="n">atom_rc_file</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">reference</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">ATOMICDATA</span>
    <span class="n">citation</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">REFERENCE</span>
    <span class="n">reference_length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">reference</span><span class="p">)</span>

    <span class="n">reference_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">reference_template</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">reference_length</span><span class="p">))</span>
    <span class="n">reference</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">char</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="n">reference</span><span class="p">)</span>
    <span class="n">citation</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">char</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="n">citation</span><span class="p">)</span>
    <span class="n">reference_data</span><span class="o">.</span><span class="n">reference</span> <span class="o">=</span> <span class="n">reference</span>
    <span class="n">reference_data</span><span class="o">.</span><span class="n">citation</span> <span class="o">=</span> <span class="n">citation</span>
    <span class="k">return</span> <span class="n">reference_data</span></div>

<div class="viewcode-block" id="list_aeff_sh95_references"><a class="viewcode-back" href="../api/atomneb.main.html#atomneb.list_aeff_sh95_references">[docs]</a><span class="k">def</span> <span class="nf">list_aeff_sh95_references</span><span class="p">(</span><span class="n">atom_rc_file</span><span class="p">,</span> <span class="n">atom</span><span class="p">,</span> <span class="n">ion</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">         This function returns a list for all references of recombination coefficients (Aeff)</span>
<span class="sd">         for given element and ionic level from the FITS data file (&#39;rc_SH95.fits&#39;).</span>

<span class="sd">        For example::</span>

<span class="sd">         &gt;&gt; import atomneb</span>
<span class="sd">         &gt;&gt; import numpy as np</span>
<span class="sd">         &gt;&gt; import os</span>
<span class="sd">         &gt;&gt; base_dir = os.getcwd()</span>
<span class="sd">         &gt;&gt; data_dir = [&#39;atomic-data-rc&#39;]</span>
<span class="sd">         &gt;&gt; atom_rc_file = os.path.join(base_dir,data_dir,&#39;rc_SH95.fits&#39;)</span>
<span class="sd">         &gt;&gt; atom=&#39;h&#39;</span>
<span class="sd">         &gt;&gt; ion=&#39;ii&#39; # H I</span>
<span class="sd">         &gt;&gt; list_hi_aeff_reference = atomneb.list_aeff_sh95_references(atom_rc_file, atom, ion)</span>
<span class="sd">         &gt;&gt; print(list_hi_aeff_reference)</span>
<span class="sd">         </span>
<span class="sd">     :return: This function returns the references.</span>
<span class="sd">     :rtype: an array of strings</span>

<span class="sd">     :param atom_rc_file: the FITS data file name (&#39;rc_SH95.fits&#39;)</span>
<span class="sd">     :type atom_rc_file: str</span>
<span class="sd">  </span>
<span class="sd">     :param atom: atom name e.g. &#39;h&#39;</span>
<span class="sd">     :type atom: str</span>
<span class="sd">     </span>
<span class="sd">     :param ion: ionic level e.g &#39;ii&#39;</span>
<span class="sd">     :type ion: str</span>
<span class="sd">     </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">element_data_list</span> <span class="o">=</span> <span class="n">read_aeff_sh95_list</span><span class="p">(</span><span class="n">atom_rc_file</span><span class="p">)</span>
    <span class="n">atom_ion_name</span> <span class="o">=</span> <span class="n">atom</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">+</span> <span class="s1">&#39;_&#39;</span> <span class="o">+</span> <span class="n">ion</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">+</span> <span class="s1">&#39;_aeff&#39;</span>
    <span class="n">aeff_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">element_data_list</span><span class="o">.</span><span class="n">aeff_data</span><span class="p">)</span>
    <span class="c1">#aeff_res = [x for x in aeff_list if re.search(atom_ion_name, x)]</span>
    <span class="n">aeff_res</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">aeff_list</span> <span class="k">if</span> <span class="n">atom_ion_name</span> <span class="ow">in</span> <span class="n">x</span><span class="p">]</span>
    <span class="n">ii_length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">aeff_res</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">ii_length</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;could not find the given element or ion&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="mi">0</span>
    <span class="n">nlines1</span> <span class="o">=</span> <span class="n">ii_length</span>  <span class="c1"># temp[0]</span>
    <span class="n">references</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nlines1</span><span class="p">)]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">nlines1</span><span class="p">):</span>
        <span class="n">select_aeff_data_str1</span> <span class="o">=</span> <span class="n">aeff_res</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)</span>
        <span class="n">ref_num</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">select_aeff_data_str1</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">ref_num</span> <span class="o">&gt;</span> <span class="mi">4</span><span class="p">:</span>
            <span class="n">references</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">select_aeff_data_str1</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">references</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
    <span class="k">return</span> <span class="n">references</span></div>

<div class="viewcode-block" id="get_aeff_sh95_reference_citation"><a class="viewcode-back" href="../api/atomneb.main.html#atomneb.get_aeff_sh95_reference_citation">[docs]</a><span class="k">def</span> <span class="nf">get_aeff_sh95_reference_citation</span><span class="p">(</span><span class="n">atom_rc_file</span><span class="p">,</span> <span class="n">atom</span><span class="p">,</span> <span class="n">ion</span><span class="p">,</span> <span class="n">reference</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">case1</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">         This function returns the reference citation for a recombination coefficient (Aeff)</span>
<span class="sd">         from the 2nd binary table extension of the FITS data file (&#39;rc_SH95.fits&#39;).</span>

<span class="sd">        For example::</span>

<span class="sd">         &gt;&gt; import atomneb</span>
<span class="sd">         &gt;&gt; import numpy as np</span>
<span class="sd">         &gt;&gt; import os</span>
<span class="sd">         &gt;&gt; base_dir = os.getcwd()</span>
<span class="sd">         &gt;&gt; data_dir = [&#39;atomic-data-rc&#39;]</span>
<span class="sd">         &gt;&gt; atom_rc_file = os.path.join(base_dir,data_dir, &#39;rc_SH95.fits&#39;)</span>
<span class="sd">         &gt;&gt; atom=&#39;h&#39;</span>
<span class="sd">         &gt;&gt; ion=&#39;ii&#39; # H I</span>
<span class="sd">         &gt;&gt; citation = atomneb.get_aeff_sh95_reference_citation(atom_rc_file, atom, ion)</span>
<span class="sd">         &gt;&gt; print(citation)</span>
<span class="sd">            Storey, P. J. and Hummer, D. G., MNRAS, 272, 41S, 1995</span>
<span class="sd">                    </span>
<span class="sd">     :return: This function returns the Citation.</span>
<span class="sd">     :rtype: str</span>

<span class="sd">     :param atom_rc_file: the FITS data file name (&#39;rc_SH95.fits&#39;)</span>
<span class="sd">     :type atom_rc_file: str</span>
<span class="sd">  </span>
<span class="sd">     :param atom: atom name e.g. &#39;h&#39;</span>
<span class="sd">     :type atom: str</span>
<span class="sd">     </span>
<span class="sd">     :param ion: ionic level e.g &#39;ii&#39;</span>
<span class="sd">     :type ion: str</span>
<span class="sd">     </span>
<span class="sd">     :param reference: set for the reference</span>
<span class="sd">     :type reference: str, optional</span>
<span class="sd">     </span>
<span class="sd">     :param case1: set for the case &#39;a&#39; or &#39;b&#39;, defualt &#39;b&#39;</span>
<span class="sd">     :type case1: str, optional</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">element_data_reference</span> <span class="o">=</span> <span class="n">read_aeff_sh95_references</span><span class="p">(</span><span class="n">atom_rc_file</span><span class="p">)</span>
    <span class="n">atom_ion_name</span> <span class="o">=</span> <span class="n">atom</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">+</span> <span class="s1">&#39;_&#39;</span> <span class="o">+</span> <span class="n">ion</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">+</span> <span class="s1">&#39;_aeff&#39;</span>
    <span class="n">reference_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">element_data_reference</span><span class="o">.</span><span class="n">reference</span><span class="p">)</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">case1</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">atom_ion_name</span> <span class="o">=</span> <span class="n">atom_ion_name</span> <span class="o">+</span> <span class="s1">&#39;_&#39;</span> <span class="o">+</span> <span class="n">case1</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">atom_ion_name</span> <span class="o">=</span> <span class="n">atom_ion_name</span> <span class="o">+</span> <span class="s1">&#39;_b&#39;</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">reference</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">atom_ion_name</span> <span class="o">=</span> <span class="n">atom_ion_name</span> <span class="o">+</span> <span class="s1">&#39;_&#39;</span> <span class="o">+</span> <span class="n">reference</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>
    <span class="n">ii</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">reference_list</span> <span class="o">==</span> <span class="n">atom_ion_name</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>  <span class="c1">#</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">ii</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;could not find the given reference&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="mi">0</span>
    <span class="n">citation</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">element_data_reference</span><span class="o">.</span><span class="n">citation</span><span class="p">[</span><span class="n">ii</span><span class="p">])</span>

    <span class="k">return</span> <span class="n">citation</span></div>

<div class="viewcode-block" id="read_aeff_ppb91"><a class="viewcode-back" href="../api/atomneb.main.html#atomneb.read_aeff_ppb91">[docs]</a><span class="k">def</span> <span class="nf">read_aeff_ppb91</span><span class="p">(</span><span class="n">atom_rc_file</span><span class="p">,</span> <span class="n">atom</span><span class="p">,</span> <span class="n">ion</span><span class="p">,</span> <span class="n">reference</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">         This function returns the effective recombination coefficients (Aeff) from the table extensions</span>
<span class="sd">         of the FITS data file (&#39;rc_PPB91.fits&#39;).</span>

<span class="sd">        For example::</span>

<span class="sd">         &gt;&gt; import atomneb</span>
<span class="sd">         &gt;&gt; import numpy as np</span>
<span class="sd">         &gt;&gt; import os</span>
<span class="sd">         &gt;&gt; base_dir = os.getcwd()</span>
<span class="sd">         &gt;&gt; data_dir = os.path.join(&#39;..&#39;,&#39;atomic-data-rc&#39;)</span>
<span class="sd">         &gt;&gt; atom_rc_file = os.path.join(base_dir,data_dir, &#39;rc_PPB91.fits&#39;)</span>
<span class="sd">         &gt;&gt; atom=&#39;c&#39;</span>
<span class="sd">         &gt;&gt; ion=&#39;iii&#39; # C II</span>
<span class="sd">         &gt;&gt; cii_rc_data = atomneb.read_aeff_ppb91(atom_rc_file, atom, ion)</span>
<span class="sd">         &gt;&gt; n_line = len(cii_rc_data.wavelength)</span>
<span class="sd">         &gt;&gt; for i in range(0, n_line):</span>
<span class="sd">         &gt;&gt;           print(cii_rc_data.ion[i], cii_rc_data.case1[i], cii_rc_data.wavelength[i],</span>
<span class="sd">         &gt;&gt;                 cii_rc_data.a[i], cii_rc_data.b[i], cii_rc_data.c[i],</span>
<span class="sd">         &gt;&gt;                 cii_rc_data.d[i], cii_rc_data.br[i], cii_rc_data.q[i], cii_rc_data.y[i])</span>
<span class="sd">            C2+A       9903.4600      0.69700000     -0.78400000      ...</span>
<span class="sd">            C2+A       4267.1500       1.0110000     -0.75400000      ...</span>
<span class="sd">            ...</span>
<span class="sd">         </span>
<span class="sd">     :return: This function returns the effective recombination coefficients: {Ion: &#39; &#39;, Case1:&#39;&#39;, Wavelength:0.0, a: 0.0, b: 0.0, c: 0.0, d: 0.0, br: 0.0, y: 0.0}</span>
<span class="sd">     :rtype: an array of data</span>
<span class="sd">     </span>
<span class="sd">     :param atom_rc_file: the FITS data file name (&#39;rc_PPB91.fits&#39;)</span>
<span class="sd">     :type atom_rc_file: str </span>
<span class="sd">     </span>
<span class="sd">     :param atom: atom name e.g. &#39;c&#39;</span>
<span class="sd">     :type atom: str </span>
<span class="sd">     </span>
<span class="sd">     :param ion: ionic level e.g &#39;iii&#39;</span>
<span class="sd">     :type ion: str </span>

<span class="sd">     :param reference: set for the reference</span>
<span class="sd">     :type reference: str, optional</span>
<span class="sd">     </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">element_data_list</span> <span class="o">=</span> <span class="n">read_aeff_ppb91_list</span><span class="p">(</span><span class="n">atom_rc_file</span><span class="p">)</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">reference</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">atom_ion_name</span> <span class="o">=</span> <span class="n">atom</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">+</span> <span class="s1">&#39;_&#39;</span> <span class="o">+</span> <span class="n">ion</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">+</span> <span class="s1">&#39;_aeff_&#39;</span> <span class="o">+</span> <span class="n">reference</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>
        <span class="n">aeff_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">element_data_list</span><span class="o">.</span><span class="n">aeff_data</span><span class="p">)</span>
        <span class="n">ii</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">aeff_list</span> <span class="o">==</span> <span class="n">atom_ion_name</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">ii</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;could not find the given element or ion&#39;</span><span class="p">)</span>
            <span class="k">return</span> <span class="mi">0</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">atom_ion_name</span> <span class="o">=</span> <span class="n">atom</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">+</span> <span class="s1">&#39;_&#39;</span> <span class="o">+</span> <span class="n">ion</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">+</span> <span class="s1">&#39;_aeff&#39;</span>
        <span class="n">aeff_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">element_data_list</span><span class="o">.</span><span class="n">aeff_data</span><span class="p">)</span>
        <span class="c1">#aeff_res = [x for x in aeff_list if re.search(atom_ion_name, x)]</span>
        <span class="n">aeff_res</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">aeff_list</span> <span class="k">if</span> <span class="n">atom_ion_name</span> <span class="ow">in</span> <span class="n">x</span><span class="p">]</span>
        <span class="n">iii</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">aeff_list</span> <span class="o">==</span> <span class="n">aeff_res</span><span class="p">[</span><span class="mi">0</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span>  <span class="c1">#</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">iii</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;could not find the given element or ion&#39;</span><span class="p">)</span>
            <span class="k">return</span> <span class="mi">0</span>
        <span class="n">ii</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">iii</span><span class="p">)</span>

    <span class="n">extension</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">element_data_list</span><span class="o">.</span><span class="n">extension</span><span class="p">)[</span><span class="n">ii</span><span class="p">]</span>

    <span class="n">rc_template</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;ion&#39;</span><span class="p">:</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;case1&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;wavelength&#39;</span><span class="p">:</span> <span class="nb">float</span><span class="p">(</span><span class="mf">0.0</span><span class="p">),</span>
                 <span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="nb">float</span><span class="p">(</span><span class="mf">0.0</span><span class="p">),</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span><span class="nb">float</span><span class="p">(</span><span class="mf">0.0</span><span class="p">),</span> <span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="nb">float</span><span class="p">(</span><span class="mf">0.0</span><span class="p">),</span>
                 <span class="s1">&#39;d&#39;</span><span class="p">:</span><span class="nb">float</span><span class="p">(</span><span class="mf">0.0</span><span class="p">),</span> <span class="s1">&#39;br&#39;</span><span class="p">:</span><span class="nb">float</span><span class="p">(</span><span class="mf">0.0</span><span class="p">),</span> <span class="s1">&#39;q&#39;</span><span class="p">:</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">:</span><span class="nb">float</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)}</span>
    <span class="n">data</span><span class="p">,</span> <span class="n">header1</span> <span class="o">=</span> <span class="n">getdata</span><span class="p">(</span><span class="n">atom_rc_file</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">extension</span><span class="p">),</span> <span class="n">header</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">ion</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">ION</span>
    <span class="n">case1</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">CASE1</span>
    <span class="n">wavelength</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">WAVELENGTH</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">A</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">B</span>
    <span class="n">c</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">C</span>
    <span class="n">d</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">D</span>
    <span class="n">br</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">BR</span>
    <span class="n">q</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">Q</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">Y</span>
    <span class="n">ion</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">char</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="n">ion</span><span class="p">)</span>
    <span class="n">case1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">char</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="n">case1</span><span class="p">)</span>
    <span class="n">n_line</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">wavelength</span><span class="p">)</span>
    <span class="n">rc_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">rc_template</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">n_line</span><span class="p">))</span>
    <span class="n">rc_data</span><span class="o">.</span><span class="n">ion</span> <span class="o">=</span> <span class="n">ion</span>
    <span class="n">rc_data</span><span class="o">.</span><span class="n">case1</span> <span class="o">=</span> <span class="n">case1</span>
    <span class="n">rc_data</span><span class="o">.</span><span class="n">wavelength</span> <span class="o">=</span> <span class="n">wavelength</span>
    <span class="n">rc_data</span><span class="o">.</span><span class="n">a</span> <span class="o">=</span> <span class="n">a</span>
    <span class="n">rc_data</span><span class="o">.</span><span class="n">b</span> <span class="o">=</span> <span class="n">b</span>
    <span class="n">rc_data</span><span class="o">.</span><span class="n">c</span> <span class="o">=</span> <span class="n">c</span>
    <span class="n">rc_data</span><span class="o">.</span><span class="n">d</span> <span class="o">=</span> <span class="n">d</span>
    <span class="n">rc_data</span><span class="o">.</span><span class="n">br</span> <span class="o">=</span> <span class="n">br</span>
    <span class="n">rc_data</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">y</span>
    <span class="k">return</span> <span class="n">rc_data</span></div>

<div class="viewcode-block" id="read_aeff_ppb91_list"><a class="viewcode-back" href="../api/atomneb.main.html#atomneb.read_aeff_ppb91_list">[docs]</a><span class="k">def</span> <span class="nf">read_aeff_ppb91_list</span><span class="p">(</span><span class="n">atom_rc_file</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">         This function returns the list of effective recombination coefficients (Aeff) from the 1st binary table extension</span>
<span class="sd">         of the FITS data file (&#39;rc_PPB91.fits&#39;)</span>

<span class="sd">     :return: This function returns the aeff_data_list: { Aeff_Data:&#39;&#39;, Extension:0.0}</span>
<span class="sd">     :rtype: an array of data</span>
<span class="sd">     </span>
<span class="sd">     :param atom_rc_file: the FITS data file name (&#39;rc_PPB91.fits&#39;)</span>
<span class="sd">     :type atom_rc_file: str</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">element_template</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;aeff_data&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;extension&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">}</span>
    <span class="n">data</span><span class="p">,</span> <span class="n">hdr</span> <span class="o">=</span> <span class="n">getdata</span><span class="p">(</span><span class="n">atom_rc_file</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">aeff_data</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">AEFF_DATA</span>
    <span class="n">extension</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">EXTENSION</span>
    <span class="n">element_length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">aeff_data</span><span class="p">)</span>

    <span class="n">element_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">element_template</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">element_length</span><span class="p">))</span>
    <span class="n">aeff_data</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">char</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="n">aeff_data</span><span class="p">)</span>
    <span class="n">element_data</span><span class="o">.</span><span class="n">aeff_data</span><span class="o">=</span><span class="n">aeff_data</span>
    <span class="n">element_data</span><span class="o">.</span><span class="n">extension</span> <span class="o">=</span> <span class="n">extension</span>
    <span class="k">return</span> <span class="n">element_data</span></div>

<div class="viewcode-block" id="search_aeff_ppb91"><a class="viewcode-back" href="../api/atomneb.main.html#atomneb.search_aeff_ppb91">[docs]</a><span class="k">def</span> <span class="nf">search_aeff_ppb91</span><span class="p">(</span><span class="n">atom_rc_file</span><span class="p">,</span> <span class="n">atom</span><span class="p">,</span> <span class="n">ion</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">         This function searches effective recombination coefficients (Aeff) for given element</span>
<span class="sd">         and ionic levels in the FITS data file (&#39;rec_PPB91.fits&#39;), and returns the data entry.</span>

<span class="sd">        For example::</span>

<span class="sd">         &gt;&gt; import atomneb</span>
<span class="sd">         &gt;&gt; import numpy as np</span>
<span class="sd">         &gt;&gt; import os</span>
<span class="sd">         &gt;&gt; base_dir = os.getcwd()</span>
<span class="sd">         &gt;&gt; data_dir = os.path.join(&#39;..&#39;,&#39;atomic-data-rc&#39;)</span>
<span class="sd">         &gt;&gt; atom_rc_file = os.path.join(base_dir,data_dir, &#39;rc_PPB91.fits&#39;)</span>
<span class="sd">         &gt;&gt; atom=&#39;c&#39;</span>
<span class="sd">         &gt;&gt; ion=&#39;iii&#39;</span>
<span class="sd">         &gt;&gt; list_cii_aeff_data = atomneb.search_aeff_ppb91(atom_rc_file, atom, ion)</span>
<span class="sd">         &gt;&gt; print(list_cii_aeff_data)</span>
<span class="sd">            c_iii_aeff</span>
<span class="sd">         </span>
<span class="sd">     :return: This function returns the Aeff_Data.</span>
<span class="sd">     :rtype: an array of data</span>

<span class="sd">     :param atom_rc_file: the FITS data file name (&#39;rc_PPB91.fits&#39;)</span>
<span class="sd">     :type atom_rc_file: str</span>
<span class="sd">  </span>
<span class="sd">     :param atom: atom name e.g. &#39;c&#39;</span>
<span class="sd">     :type atom: str</span>
<span class="sd">     </span>
<span class="sd">     :param ion: ionic level e.g &#39;iii&#39;</span>
<span class="sd">     :type ion: str</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">element_data_list</span> <span class="o">=</span> <span class="n">read_aeff_ppb91_list</span><span class="p">(</span><span class="n">atom_rc_file</span><span class="p">)</span>
    <span class="n">atom_ion_name</span> <span class="o">=</span> <span class="n">atom</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">+</span> <span class="s1">&#39;_&#39;</span> <span class="o">+</span> <span class="n">ion</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>  <span class="o">+</span> <span class="s1">&#39;_aeff&#39;</span>
    <span class="n">aeff_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">element_data_list</span><span class="o">.</span><span class="n">aeff_data</span><span class="p">)</span>
    <span class="c1">#aeff_res = [x for x in aeff_list if re.search(atom_ion_name, x)]</span>
    <span class="n">aeff_res</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">aeff_list</span> <span class="k">if</span> <span class="n">atom_ion_name</span> <span class="ow">in</span> <span class="n">x</span><span class="p">]</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">aeff_res</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;could not find the given element or ion&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="mi">0</span>
    <span class="n">select_aeff_data</span> <span class="o">=</span> <span class="n">aeff_res</span>
    <span class="k">return</span> <span class="n">select_aeff_data</span></div>

<div class="viewcode-block" id="read_aeff_ppb91_references"><a class="viewcode-back" href="../api/atomneb.main.html#atomneb.read_aeff_ppb91_references">[docs]</a><span class="k">def</span> <span class="nf">read_aeff_ppb91_references</span><span class="p">(</span><span class="n">atom_rc_file</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">         This function returns the reference list of recombination coefficients (Aeff) from the 2nd binary table extension</span>
<span class="sd">         of the FITS data file (&#39;rc_PPB91.fits&#39;).</span>

<span class="sd">     :return: This function returns the aeff_data_reference: { Reference:&#39;&#39;, Citation:&#39;&#39;}</span>
<span class="sd">     :rtype: an array of data</span>

<span class="sd">     :param atom_rc_file: the FITS data file name (&#39;rc_PPB91.fits&#39;)</span>
<span class="sd">     :type atom_rc_file: str</span>
<span class="sd">     </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">reference_template</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;reference&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;citation&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">}</span>
    <span class="n">data</span><span class="p">,</span> <span class="n">hdr</span> <span class="o">=</span> <span class="n">getdata</span><span class="p">(</span><span class="n">atom_rc_file</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">reference</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">ATOMICDATA</span>
    <span class="n">citation</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">REFERENCE</span>
    <span class="n">reference_length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">reference</span><span class="p">)</span>

    <span class="n">reference_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">reference_template</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">reference_length</span><span class="p">))</span>
    <span class="n">reference</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">char</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="n">reference</span><span class="p">)</span>
    <span class="n">citation</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">char</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="n">citation</span><span class="p">)</span>
    <span class="n">reference_data</span><span class="o">.</span><span class="n">reference</span> <span class="o">=</span> <span class="n">reference</span>
    <span class="n">reference_data</span><span class="o">.</span><span class="n">citation</span> <span class="o">=</span> <span class="n">citation</span>
    <span class="k">return</span> <span class="n">reference_data</span></div>

<div class="viewcode-block" id="list_aeff_ppb91_references"><a class="viewcode-back" href="../api/atomneb.main.html#atomneb.list_aeff_ppb91_references">[docs]</a><span class="k">def</span> <span class="nf">list_aeff_ppb91_references</span><span class="p">(</span><span class="n">atom_rc_file</span><span class="p">,</span> <span class="n">atom</span><span class="p">,</span> <span class="n">ion</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">         This function returns a list for all references of recombination coefficients (Aeff)</span>
<span class="sd">         for given element and ionic level from the FITS data file (&#39;rc_PPB91.fits&#39;).</span>

<span class="sd">        For example::</span>

<span class="sd">         &gt;&gt; import atomneb</span>
<span class="sd">         &gt;&gt; import numpy as np</span>
<span class="sd">         &gt;&gt; import os</span>
<span class="sd">         &gt;&gt; base_dir = os.getcwd()</span>
<span class="sd">         &gt;&gt; data_dir = [&#39;atomic-data-rc&#39;]</span>
<span class="sd">         &gt;&gt; atom_rc_file = os.path.join(base_dir,data_dir, &#39;rc_PPB91.fits&#39;)</span>
<span class="sd">         &gt;&gt; atom=&#39;c&#39;</span>
<span class="sd">         &gt;&gt; ion=&#39;iii&#39;</span>
<span class="sd">         &gt;&gt; list_cii_aeff_reference = atomneb.list_aeff_ppb91_references(atom_rc_file, atom, ion)</span>
<span class="sd">         &gt;&gt; print(list_cii_aeff_reference)</span>
<span class="sd">             </span>
<span class="sd">     :return: This function returns the references.</span>
<span class="sd">     :rtype: an array of strings</span>
<span class="sd">     </span>
<span class="sd">     :param atom_rc_file: the FITS data file name (&#39;rc_PPB91.fits&#39;)</span>
<span class="sd">     :type atom_rc_file: str</span>
<span class="sd">  </span>
<span class="sd">     :param atom: atom name e.g. &#39;c&#39;</span>
<span class="sd">     :type atom: str</span>
<span class="sd">     </span>
<span class="sd">     :param ion: ionic level e.g &#39;iii&#39;</span>
<span class="sd">     :type ion: str</span>
<span class="sd">     </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">element_data_list</span> <span class="o">=</span> <span class="n">read_aeff_ppb91_list</span><span class="p">(</span><span class="n">atom_rc_file</span><span class="p">)</span>
    <span class="n">atom_ion_name</span> <span class="o">=</span> <span class="n">atom</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">+</span> <span class="s1">&#39;_&#39;</span> <span class="o">+</span> <span class="n">ion</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">+</span> <span class="s1">&#39;_aeff&#39;</span>
    <span class="n">aeff_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">element_data_list</span><span class="o">.</span><span class="n">aeff_data</span><span class="p">)</span>
    <span class="c1">#aeff_res = [x for x in aeff_list if re.search(atom_ion_name, x)]</span>
    <span class="n">aeff_res</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">aeff_list</span> <span class="k">if</span> <span class="n">atom_ion_name</span> <span class="ow">in</span> <span class="n">x</span><span class="p">]</span>
    <span class="n">ii_length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">aeff_res</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">ii_length</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;could not find the given element or ion&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="mi">0</span>
    <span class="n">nlines1</span> <span class="o">=</span> <span class="n">ii_length</span>  <span class="c1"># temp[0]</span>
    <span class="n">references</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nlines1</span><span class="p">)]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">nlines1</span><span class="p">):</span>
        <span class="n">select_aeff_data_str1</span> <span class="o">=</span> <span class="n">aeff_res</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)</span>
        <span class="n">ref_num</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">select_aeff_data_str1</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">ref_num</span> <span class="o">&gt;</span> <span class="mi">3</span><span class="p">:</span>
            <span class="n">references</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">select_aeff_data_str1</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">references</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
    <span class="k">return</span> <span class="n">references</span></div>

<div class="viewcode-block" id="get_aeff_ppb91_reference_citation"><a class="viewcode-back" href="../api/atomneb.main.html#atomneb.get_aeff_ppb91_reference_citation">[docs]</a><span class="k">def</span> <span class="nf">get_aeff_ppb91_reference_citation</span><span class="p">(</span><span class="n">atom_rc_file</span><span class="p">,</span> <span class="n">atom</span><span class="p">,</span> <span class="n">ion</span><span class="p">,</span> <span class="n">reference</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This function returns the reference citation for a recombination coefficient (Aeff)</span>
<span class="sd">        from the 2nd binary table extension of the FITS data file (&#39;rc_PPB91.fits&#39;).</span>

<span class="sd">       For example::</span>

<span class="sd">        &gt;&gt; import atomneb</span>
<span class="sd">        &gt;&gt; import numpy as np</span>
<span class="sd">        &gt;&gt; import os</span>
<span class="sd">        &gt;&gt; base_dir = os.getcwd()</span>
<span class="sd">        &gt;&gt; data_dir = [&#39;atomic-data-rc&#39;]</span>
<span class="sd">        &gt;&gt; atom_rc_file = os.path.join(base_dir,data_dir, &#39;rc_PPB91.fits&#39;)</span>
<span class="sd">        &gt;&gt; atom=&#39;c&#39;</span>
<span class="sd">        &gt;&gt; ion=&#39;iii&#39;</span>
<span class="sd">        &gt;&gt; citation = atomneb.get_aeff_ppb91_reference_citation(atom_rc_file, atom, ion)</span>
<span class="sd">        &gt;&gt; print(citation)</span>
<span class="sd">           Pequignot, D., Petitjean, P. and Boisson, C. Astron.Astrophys., 251, 680, 1991</span>

<span class="sd">     :return: This function returns the Citation.</span>
<span class="sd">     :rtype: str</span>

<span class="sd">     :param atom_rc_file: the FITS data file name (&#39;rc_PPB91.fits&#39;)</span>
<span class="sd">     :type atom_rc_file: str</span>
<span class="sd">  </span>
<span class="sd">     :param atom: atom name e.g. &#39;c&#39;</span>
<span class="sd">     :type atom: str</span>
<span class="sd">     </span>
<span class="sd">     :param ion: ionic level e.g &#39;iii&#39;</span>
<span class="sd">     :type ion: str</span>
<span class="sd">     </span>
<span class="sd">     :param reference: set for the reference</span>
<span class="sd">     :type reference: str, optional</span>
<span class="sd">     </span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">element_data_reference</span> <span class="o">=</span> <span class="n">read_aeff_ppb91_references</span><span class="p">(</span><span class="n">atom_rc_file</span><span class="p">)</span>
    <span class="n">reference_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">element_data_reference</span><span class="o">.</span><span class="n">reference</span><span class="p">)</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">reference</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">atom_ion_name</span> <span class="o">=</span> <span class="n">atom</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">+</span> <span class="s1">&#39;_&#39;</span> <span class="o">+</span> <span class="n">ion</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">+</span> <span class="s1">&#39;_aeff_&#39;</span> <span class="o">+</span> <span class="s1">&#39;_&#39;</span> <span class="o">+</span> <span class="n">reference</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">atom_ion_name</span> <span class="o">=</span> <span class="n">atom</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">+</span> <span class="s1">&#39;_&#39;</span> <span class="o">+</span> <span class="n">ion</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">+</span> <span class="s1">&#39;_aeff&#39;</span>
    <span class="n">ii</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">reference_list</span> <span class="o">==</span> <span class="n">atom_ion_name</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>  <span class="c1">#</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">ii</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;could not find the given reference&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="mi">0</span>
    <span class="n">citation</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">element_data_reference</span><span class="o">.</span><span class="n">citation</span><span class="p">[</span><span class="n">ii</span><span class="p">])</span>

    <span class="k">return</span> <span class="n">citation</span></div>

<div class="viewcode-block" id="read_aeff_he_i_pfsd12"><a class="viewcode-back" href="../api/atomneb.main.html#atomneb.read_aeff_he_i_pfsd12">[docs]</a><span class="k">def</span> <span class="nf">read_aeff_he_i_pfsd12</span><span class="p">(</span><span class="n">atom_rc_file</span><span class="p">,</span> <span class="n">atom</span><span class="p">,</span> <span class="n">ion</span><span class="p">,</span> <span class="n">wavelength</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">reference</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">         This function returns the effective recombination coefficients (Aeff) from the table extensions</span>
<span class="sd">         of the FITS data file (&#39;rc_he_ii_PFSD12.fits&#39;).</span>

<span class="sd">        For example::</span>

<span class="sd">         &gt;&gt; import atomneb</span>
<span class="sd">         &gt;&gt; import numpy as np</span>
<span class="sd">         &gt;&gt; import os</span>
<span class="sd">         &gt;&gt; base_dir = os.getcwd()</span>
<span class="sd">         &gt;&gt; data_dir = os.path.join(&#39;..&#39;,&#39;atomic-data-rc&#39;)</span>
<span class="sd">         &gt;&gt; atom_rc_file = os.path.join(base_dir,data_dir, &#39;rc_he_ii_PFSD12.fits&#39;)</span>
<span class="sd">         &gt;&gt; atom=&#39;he&#39;</span>
<span class="sd">         &gt;&gt; ion=&#39;ii&#39; # He I</span>
<span class="sd">         &gt;&gt; hei_rc_data = atomneb.read_aeff_he_i_pfsd12(atom_rc_file, atom, ion)</span>
<span class="sd">         &gt;&gt; hei_rc_data_wave = atomneb.read_aeff_he_i_pfsd12(atom_rc_file, atom, ion, wavelength=True)</span>
<span class="sd">         &gt;&gt; print(hei_rc_data.aeff[0])</span>
<span class="sd">            5000.0000       10.000000      -25.379540      -25.058970      -25.948440      ...</span>
<span class="sd">         &gt;&gt; n_line = len(hei_rc_data_wave.wavelength)</span>
<span class="sd">         &gt;&gt; for i in range(0, n_line):</span>
<span class="sd">         &gt;&gt;     print(hei_rc_data_wave.wavelength[i],</span>
<span class="sd">         &gt;&gt;           hei_rc_data_wave.lowerterm[i], hei_rc_data_wave.upperterm[i])</span>
<span class="sd">            2945.00005p^{3}P2s^{3}S</span>
<span class="sd">            3188.00004p^{3}P2s^{3}S</span>
<span class="sd">            3614.00005p^{1}P2s^{1}S</span>
<span class="sd">            ...</span>
<span class="sd">     </span>
<span class="sd">     :return: This function returns the effective recombination coefficients.</span>
<span class="sd">     :rtype: an array of data</span>
<span class="sd">     </span>
<span class="sd">     :param atom_rc_file: the FITS data file name (&#39;rc_he_ii_PFSD12.fits&#39;)</span>
<span class="sd">     :type atom_rc_file: str</span>
<span class="sd">  </span>
<span class="sd">     :param atom: atom name e.g. &#39;he&#39;</span>
<span class="sd">     :type atom: str</span>
<span class="sd">     </span>
<span class="sd">     :param ion: ionic level e.g &#39;ii&#39;</span>
<span class="sd">     :type ion: str</span>
<span class="sd">    </span>
<span class="sd">     :param wavelength: set for returning the wavelengths</span>
<span class="sd">     :type wavelength: boolean, optional</span>
<span class="sd">     </span>
<span class="sd">     :param reference: set for the reference</span>
<span class="sd">     :type reference: str, optional</span>
<span class="sd">     </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">element_data_list</span> <span class="o">=</span> <span class="n">read_aeff_he_i_pfsd12_list</span><span class="p">(</span><span class="n">atom_rc_file</span><span class="p">)</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">wavelength</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">prefix</span> <span class="o">=</span> <span class="s1">&#39;_wavelength&#39;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">prefix</span> <span class="o">=</span> <span class="s1">&#39;_aeff&#39;</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">reference</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">atom_ion_name</span> <span class="o">=</span> <span class="n">atom</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">+</span> <span class="s1">&#39;_&#39;</span> <span class="o">+</span> <span class="n">ion</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">+</span> <span class="n">prefix</span> <span class="o">+</span> <span class="s1">&#39;_&#39;</span> <span class="o">+</span> <span class="n">reference</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>
        <span class="n">aeff_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">element_data_list</span><span class="o">.</span><span class="n">aeff_data</span><span class="p">)</span>
        <span class="n">ii</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">aeff_list</span> <span class="o">==</span> <span class="n">atom_ion_name</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>  <span class="c1">#</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">ii</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;could not find the given reference&#39;</span><span class="p">)</span>
            <span class="k">return</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">reference</span> <span class="o">=</span> <span class="s1">&#39;PFSD13&#39;</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">wavelength</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">atom_ion_name</span> <span class="o">=</span> <span class="n">atom</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">+</span> <span class="s1">&#39;_&#39;</span> <span class="o">+</span> <span class="n">ion</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">+</span> <span class="n">prefix</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">atom_ion_name</span> <span class="o">=</span> <span class="n">atom</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">+</span> <span class="s1">&#39;_&#39;</span> <span class="o">+</span> <span class="n">ion</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">+</span> <span class="n">prefix</span> <span class="o">+</span> <span class="s1">&#39;_&#39;</span> <span class="o">+</span> <span class="n">reference</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>
        <span class="n">aeff_list</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">element_data_list</span><span class="o">.</span><span class="n">aeff_data</span><span class="p">)</span>
        <span class="c1">#aeff_res = [x for x in aeff_list if re.search(atom_ion_name, x)]</span>
        <span class="n">aeff_res</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">aeff_list</span> <span class="k">if</span> <span class="n">atom_ion_name</span> <span class="ow">in</span> <span class="n">x</span><span class="p">]</span>
        <span class="n">iii</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">aeff_list</span> <span class="o">==</span> <span class="n">aeff_res</span><span class="p">[</span><span class="mi">0</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span>  <span class="c1">#</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">iii</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;could not find the given element or ion&#39;</span><span class="p">)</span>
            <span class="k">return</span> <span class="mi">0</span>
        <span class="n">ii</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">iii</span><span class="p">)</span>
    <span class="n">extension</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">element_data_list</span><span class="o">.</span><span class="n">extension</span><span class="p">)[</span><span class="n">ii</span><span class="p">]</span>

    <span class="n">atom_ion_name</span> <span class="o">=</span> <span class="n">atom</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">+</span> <span class="s1">&#39;_&#39;</span> <span class="o">+</span> <span class="n">ion</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">+</span> <span class="n">prefix</span>
    <span class="k">if</span> <span class="n">atom_ion_name</span> <span class="o">==</span> <span class="s1">&#39;he_ii_aeff&#39;</span><span class="p">:</span>
        <span class="n">rc_aeff</span><span class="p">,</span> <span class="n">header1</span> <span class="o">=</span> <span class="n">getdata</span><span class="p">(</span><span class="n">atom_rc_file</span><span class="p">,</span> <span class="n">extension</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">col1</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">rc_aeff</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">row1</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">rc_aeff</span><span class="p">)</span>
        <span class="n">aeff_template</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;aeff&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">row1</span><span class="p">,</span> <span class="n">col1</span><span class="p">))}</span>
        <span class="n">rc_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">aeff_template</span><span class="o">.</span><span class="n">items</span><span class="p">()],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                            <span class="n">keys</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">aeff_template</span><span class="o">.</span><span class="n">keys</span><span class="p">()))</span>
        <span class="n">rc_data</span><span class="o">.</span><span class="n">aeff</span> <span class="o">=</span> <span class="n">rc_aeff</span>
    <span class="k">elif</span> <span class="n">atom_ion_name</span> <span class="o">==</span> <span class="s1">&#39;he_ii_wavelength&#39;</span><span class="p">:</span>
        <span class="n">rc_template</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;wavelength&#39;</span><span class="p">:</span> <span class="nb">float</span><span class="p">(</span><span class="mf">0.0</span><span class="p">),</span> <span class="s1">&#39;lowerterm&#39;</span><span class="p">:</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;upperterm&#39;</span><span class="p">:</span><span class="s1">&#39;&#39;</span><span class="p">}</span>
        <span class="n">data</span><span class="p">,</span> <span class="n">header1</span> <span class="o">=</span> <span class="n">getdata</span><span class="p">(</span><span class="n">atom_rc_file</span><span class="p">,</span> <span class="n">extension</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">wavelength</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">WAVELENGTH</span>
        <span class="n">lowerterm</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">LOWERTERM</span>
        <span class="n">upperterm</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">UPPERTERM</span>
        <span class="n">lowerterm</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">char</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="n">lowerterm</span><span class="p">)</span>
        <span class="n">upperterm</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">char</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="n">upperterm</span><span class="p">)</span>
        <span class="n">n_line</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">wavelength</span><span class="p">)</span>
        <span class="n">rc_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">rc_template</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">n_line</span><span class="p">))</span>
        <span class="n">rc_data</span><span class="o">.</span><span class="n">wavelength</span> <span class="o">=</span> <span class="n">wavelength</span>
        <span class="n">rc_data</span><span class="o">.</span><span class="n">lowerterm</span> <span class="o">=</span> <span class="n">lowerterm</span>
        <span class="n">rc_data</span><span class="o">.</span><span class="n">upperterm</span> <span class="o">=</span> <span class="n">upperterm</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;no match found for expression&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">rc_data</span></div>

<div class="viewcode-block" id="read_aeff_he_i_pfsd12_list"><a class="viewcode-back" href="../api/atomneb.main.html#atomneb.read_aeff_he_i_pfsd12_list">[docs]</a><span class="k">def</span> <span class="nf">read_aeff_he_i_pfsd12_list</span><span class="p">(</span><span class="n">atom_rc_file</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">         This function returns the list of effective recombination coefficients (Aeff) from the 1st binary table extension</span>
<span class="sd">         of the FITS data file (&#39;rc_he_ii_PFSD12.fits&#39;)</span>

<span class="sd">     :return: This function returns the aeff_data_list: { Aeff_Data:&#39;&#39;, Extension:0.0}</span>
<span class="sd">     :rtype: an array of data</span>
<span class="sd">     </span>
<span class="sd">     :param atom_rc_file: the FITS data file name (&#39;rc_he_ii_PFSD12.fits&#39;)</span>
<span class="sd">     :type atom_rc_file: str</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">element_template</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;aeff_data&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;extension&#39;</span><span class="p">:</span> <span class="mi">0</span> <span class="p">}</span>
    <span class="n">data</span><span class="p">,</span> <span class="n">hdr</span> <span class="o">=</span> <span class="n">getdata</span><span class="p">(</span><span class="n">atom_rc_file</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">aeff_data</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">AEFF_DATA</span>
    <span class="n">extension</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">EXTENSION</span>
    <span class="n">element_length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">aeff_data</span><span class="p">)</span>

    <span class="n">element_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">element_template</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">element_length</span><span class="p">))</span>
    <span class="n">aeff_data</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">char</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="n">aeff_data</span><span class="p">)</span>
    <span class="n">element_data</span><span class="o">.</span><span class="n">aeff_data</span><span class="o">=</span><span class="n">aeff_data</span>
    <span class="n">element_data</span><span class="o">.</span><span class="n">extension</span> <span class="o">=</span> <span class="n">extension</span>

    <span class="k">return</span> <span class="n">element_data</span></div>

<div class="viewcode-block" id="search_aeff_he_i_pfsd12"><a class="viewcode-back" href="../api/atomneb.main.html#atomneb.search_aeff_he_i_pfsd12">[docs]</a><span class="k">def</span> <span class="nf">search_aeff_he_i_pfsd12</span><span class="p">(</span><span class="n">atom_rc_file</span><span class="p">,</span> <span class="n">atom</span><span class="p">,</span> <span class="n">ion</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">         This function searches effective recombination coefficients (Aeff) for given element</span>
<span class="sd">         and ionic levels in the FITS data file (&#39;rec_he_ii_PFSD12.fits&#39;), and returns the data entry.</span>

<span class="sd">        For example::</span>

<span class="sd">         &gt;&gt; import atomneb</span>
<span class="sd">         &gt;&gt; import numpy as np</span>
<span class="sd">         &gt;&gt; import os</span>
<span class="sd">         &gt;&gt; base_dir = os.getcwd()</span>
<span class="sd">         &gt;&gt; data_dir = os.path.join(&#39;..&#39;,&#39;atomic-data-rc&#39;)</span>
<span class="sd">         &gt;&gt; atom_rc_file = os.path.join(base_dir,data_dir, &#39;rc_he_ii_PFSD12.fits&#39;)</span>
<span class="sd">         &gt;&gt; atom=&#39;he&#39;</span>
<span class="sd">         &gt;&gt; ion=&#39;ii&#39; # He I</span>
<span class="sd">         &gt;&gt; list_hei_aeff_data = atomneb.search_aeff_he_i_pfsd12(atom_rc_file, atom, ion)</span>
<span class="sd">         &gt;&gt; print(list_hei_aeff_data)</span>
<span class="sd">            he_ii_aeff_PFSD12 he_ii_aeff_PFSD13</span>
<span class="sd">         </span>
<span class="sd">     :return: This function returns the Aeff_Data.</span>
<span class="sd">     :rtype: an array of data</span>

<span class="sd">     :param atom_rc_file: the FITS data file name (&#39;rc_he_ii_PFSD12.fits&#39;)</span>
<span class="sd">     :type atom_rc_file: str</span>
<span class="sd">  </span>
<span class="sd">     :param atom: atom name e.g. &#39;he&#39;</span>
<span class="sd">     :type atom: str</span>
<span class="sd">     </span>
<span class="sd">     :param ion: ionic level e.g &#39;ii&#39;</span>
<span class="sd">     :type ion: str</span>
<span class="sd">    </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">element_data_list</span> <span class="o">=</span> <span class="n">read_aeff_he_i_pfsd12_list</span><span class="p">(</span><span class="n">atom_rc_file</span><span class="p">)</span>
    <span class="n">atom_ion_name</span> <span class="o">=</span> <span class="n">atom</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">+</span> <span class="s1">&#39;_&#39;</span> <span class="o">+</span> <span class="n">ion</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">+</span> <span class="s1">&#39;_aeff&#39;</span>
    <span class="n">aeff_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">element_data_list</span><span class="o">.</span><span class="n">aeff_data</span><span class="p">)</span>
    <span class="c1">#aeff_res = [x for x in aeff_list if re.search(atom_ion_name, x)]</span>
    <span class="n">aeff_res</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">aeff_list</span> <span class="k">if</span> <span class="n">atom_ion_name</span> <span class="ow">in</span> <span class="n">x</span><span class="p">]</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">aeff_res</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;could not find the given element or ion&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="mi">0</span>
    <span class="n">select_aeff_data</span> <span class="o">=</span> <span class="n">aeff_res</span>
    <span class="k">return</span> <span class="n">select_aeff_data</span></div>

<div class="viewcode-block" id="read_aeff_he_i_pfsd12_references"><a class="viewcode-back" href="../api/atomneb.main.html#atomneb.read_aeff_he_i_pfsd12_references">[docs]</a><span class="k">def</span> <span class="nf">read_aeff_he_i_pfsd12_references</span><span class="p">(</span><span class="n">atom_rc_file</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">         This function returns the reference list of recombination coefficients (Aeff) from the 2nd binary table extension</span>
<span class="sd">         of the FITS data file (&#39;rc_he_ii_PFSD12.fits&#39;).</span>

<span class="sd">     :return: This function returns the aeff_data_reference:{ Reference:&#39;&#39;, Citation:&#39;&#39;}</span>
<span class="sd">     :rtype: an array of data</span>

<span class="sd">     :param atom_rc_file: the FITS data file name (&#39;rc_he_ii_PFSD12.fits&#39;)</span>
<span class="sd">     :type atom_rc_file: str</span>
<span class="sd">     </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">reference_template</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;reference&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;citation&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">}</span>
    <span class="n">data</span><span class="p">,</span> <span class="n">hdr</span> <span class="o">=</span> <span class="n">getdata</span><span class="p">(</span><span class="n">atom_rc_file</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">reference</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">ATOMICDATA</span>
    <span class="n">citation</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">REFERENCE</span>
    <span class="n">reference_length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">reference</span><span class="p">)</span>

    <span class="n">reference_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">reference_template</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">reference_length</span><span class="p">))</span>
    <span class="n">reference</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">char</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="n">reference</span><span class="p">)</span>
    <span class="n">citation</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">char</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="n">citation</span><span class="p">)</span>
    <span class="n">reference_data</span><span class="o">.</span><span class="n">reference</span> <span class="o">=</span> <span class="n">reference</span>
    <span class="n">reference_data</span><span class="o">.</span><span class="n">citation</span> <span class="o">=</span> <span class="n">citation</span>
    <span class="k">return</span> <span class="n">reference_data</span></div>

<div class="viewcode-block" id="list_aeff_he_i_pfsd12_references"><a class="viewcode-back" href="../api/atomneb.main.html#atomneb.list_aeff_he_i_pfsd12_references">[docs]</a><span class="k">def</span> <span class="nf">list_aeff_he_i_pfsd12_references</span><span class="p">(</span><span class="n">atom_rc_file</span><span class="p">,</span> <span class="n">atom</span><span class="p">,</span> <span class="n">ion</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">         This function returns a list for all references of recombination coefficients (Aeff)</span>
<span class="sd">         for given element and ionic level from the FITS data file (&#39;rc_he_ii_PFSD12.fits&#39;).</span>

<span class="sd">        For example::</span>

<span class="sd">         &gt;&gt; import atomneb</span>
<span class="sd">         &gt;&gt; import numpy as np</span>
<span class="sd">         &gt;&gt; import os</span>
<span class="sd">         &gt;&gt; base_dir = os.getcwd()</span>
<span class="sd">         &gt;&gt; data_dir = [&#39;atomic-data-rc&#39;]</span>
<span class="sd">         &gt;&gt; atom_rc_file = os.path.join(base_dir,data_dir, &#39;rc_he_ii_PFSD12.fits&#39;)</span>
<span class="sd">         &gt;&gt; atom=&#39;he&#39;</span>
<span class="sd">         &gt;&gt; ion=&#39;ii&#39; # He I</span>
<span class="sd">         &gt;&gt; list_hei_aeff_reference = atomneb.list_aeff_he_i_pfsd12_references(atom_rc_file, atom, ion)</span>
<span class="sd">         &gt;&gt; print(list_hei_aeff_reference)</span>
<span class="sd">            PFSD12 PFSD13</span>
<span class="sd">     </span>
<span class="sd">     :return: This function returns the references.</span>
<span class="sd">     :rtype: an array of strings</span>
<span class="sd">     </span>
<span class="sd">     :param atom_rc_file: the FITS data file name (&#39;rc_he_ii_PFSD12.fits&#39;)</span>
<span class="sd">     :type atom_rc_file: str</span>
<span class="sd">  </span>
<span class="sd">     :param atom: atom name e.g. &#39;he&#39;</span>
<span class="sd">     :type atom: str</span>
<span class="sd">     </span>
<span class="sd">     :param ion: ionic level e.g &#39;ii&#39;</span>
<span class="sd">     :type ion: str</span>
<span class="sd">    </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">element_data_list</span> <span class="o">=</span> <span class="n">read_aeff_he_i_pfsd12_list</span><span class="p">(</span><span class="n">atom_rc_file</span><span class="p">)</span>
    <span class="n">atom_ion_name</span> <span class="o">=</span> <span class="n">atom</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">+</span> <span class="s1">&#39;_&#39;</span> <span class="o">+</span> <span class="n">ion</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">+</span> <span class="s1">&#39;_aeff&#39;</span>
    <span class="n">aeff_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">element_data_list</span><span class="o">.</span><span class="n">aeff_data</span><span class="p">)</span>
    <span class="c1">#aeff_res = [x for x in aeff_list if re.search(atom_ion_name, x)]</span>
    <span class="n">aeff_res</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">aeff_list</span> <span class="k">if</span> <span class="n">atom_ion_name</span> <span class="ow">in</span> <span class="n">x</span><span class="p">]</span>
    <span class="n">ii_length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">aeff_res</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">ii_length</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;could not find the given element or ion&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="mi">0</span>
    <span class="n">nlines1</span> <span class="o">=</span> <span class="n">ii_length</span>  <span class="c1"># temp[0]</span>
    <span class="n">references</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nlines1</span><span class="p">)]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">nlines1</span><span class="p">):</span>
        <span class="n">select_aeff_data_str1</span> <span class="o">=</span> <span class="n">aeff_res</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)</span>
        <span class="n">ref_num</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">select_aeff_data_str1</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">ref_num</span> <span class="o">&gt;</span> <span class="mi">3</span><span class="p">:</span>
            <span class="n">references</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">select_aeff_data_str1</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">references</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
    <span class="k">return</span> <span class="n">references</span></div>

<div class="viewcode-block" id="get_aeff_he_i_pfsd12_reference_citation"><a class="viewcode-back" href="../api/atomneb.main.html#atomneb.get_aeff_he_i_pfsd12_reference_citation">[docs]</a><span class="k">def</span> <span class="nf">get_aeff_he_i_pfsd12_reference_citation</span><span class="p">(</span><span class="n">atom_rc_file</span><span class="p">,</span> <span class="n">atom</span><span class="p">,</span> <span class="n">ion</span><span class="p">,</span> <span class="n">reference</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">         This function returns the reference citation for a recombination coefficient (Aeff)</span>
<span class="sd">         from the 2nd binary table extension of the FITS data file (&#39;rc_he_ii_PFSD12.fits&#39;).</span>

<span class="sd">        For example::</span>

<span class="sd">         &gt;&gt; import atomneb</span>
<span class="sd">         &gt;&gt; import numpy as np</span>
<span class="sd">         &gt;&gt; import os</span>
<span class="sd">         &gt;&gt; base_dir = os.getcwd()</span>
<span class="sd">         &gt;&gt; data_dir = [&#39;atomic-data-rc&#39;]</span>
<span class="sd">         &gt;&gt; atom_rc_file = os.path.join(base_dir,data_dir, &#39;rc_he_ii_PFSD12.fits&#39;)</span>
<span class="sd">         &gt;&gt; atom=&#39;he&#39;</span>
<span class="sd">         &gt;&gt; ion=&#39;ii&#39; # He I</span>
<span class="sd">         &gt;&gt; reference=&#39;PFSD13&#39;</span>
<span class="sd">         &gt;&gt; citation = atomneb.get_aeff_he_i_pfsd12_reference_citation(atom_rc_file, atom, ion, reference=reference)</span>
<span class="sd">         &gt;&gt; print(citation)</span>
<span class="sd">            Porter, R. L., Ferland, G. J., Storey, P. J. and Detisch, M. J., MNRAS, 433L, 89, 2013</span>
<span class="sd">       </span>
<span class="sd">     :return: This function returns the Citation.</span>
<span class="sd">     :rtype: str</span>

<span class="sd">     :param atom_rc_file: the FITS data file name (&#39;rc_he_ii_PFSD12.fits&#39;)</span>
<span class="sd">     :type atom_rc_file: str</span>
<span class="sd">  </span>
<span class="sd">     :param atom: atom name e.g. &#39;he&#39;</span>
<span class="sd">     :type atom: str</span>
<span class="sd">     </span>
<span class="sd">     :param ion: ionic level e.g &#39;ii&#39;</span>
<span class="sd">     :type ion: str</span>
<span class="sd">    </span>
<span class="sd">     :param reference: set for the reference e.g. &#39;PFSD13&#39;</span>
<span class="sd">     :type reference: str, optional</span>
<span class="sd">     </span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1">#  reference_template={Reference:&#39;&#39;, Citation: &#39;&#39;}</span>
    <span class="n">element_data_reference</span> <span class="o">=</span> <span class="n">read_aeff_he_i_pfsd12_references</span><span class="p">(</span><span class="n">atom_rc_file</span><span class="p">)</span>
    <span class="n">reference_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">element_data_reference</span><span class="o">.</span><span class="n">reference</span><span class="p">)</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">reference</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">atom_ion_name</span> <span class="o">=</span> <span class="n">atom</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">+</span> <span class="s1">&#39;_&#39;</span> <span class="o">+</span> <span class="n">ion</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">+</span> <span class="s1">&#39;_aeff_&#39;</span> <span class="o">+</span> <span class="n">reference</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">atom_ion_name</span> <span class="o">=</span> <span class="n">atom</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">+</span> <span class="s1">&#39;_&#39;</span> <span class="o">+</span> <span class="n">ion</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">+</span> <span class="s1">&#39;_aeff&#39;</span>
    <span class="n">ii</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">reference_list</span> <span class="o">==</span> <span class="n">atom_ion_name</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>  <span class="c1">#</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">ii</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;could not find the given reference&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="mi">0</span>
    <span class="n">citation</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">element_data_reference</span><span class="o">.</span><span class="n">citation</span><span class="p">[</span><span class="n">ii</span><span class="p">])</span>

    <span class="k">return</span> <span class="n">citation</span></div>

<div class="viewcode-block" id="read_aeff_n_ii_fsl13"><a class="viewcode-back" href="../api/atomneb.main.html#atomneb.read_aeff_n_ii_fsl13">[docs]</a><span class="k">def</span> <span class="nf">read_aeff_n_ii_fsl13</span><span class="p">(</span><span class="n">atom_rc_file</span><span class="p">,</span> <span class="n">atom</span><span class="p">,</span> <span class="n">ion</span><span class="p">,</span> <span class="n">wavelength_range</span><span class="p">,</span> <span class="n">wavelength</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">reference</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">         This function returns the effective recombination coefficients (Aeff) from the table extensions</span>
<span class="sd">         of the FITS data file (&#39;rc_n_iii_FSL13.fits&#39;).</span>

<span class="sd">        For example::</span>

<span class="sd">         &gt;&gt; import atomneb</span>
<span class="sd">         &gt;&gt; import numpy as np</span>
<span class="sd">         &gt;&gt; import os</span>
<span class="sd">         &gt;&gt; base_dir = os.getcwd()</span>
<span class="sd">         &gt;&gt; data_dir = os.path.join(&#39;..&#39;,&#39;atomic-data-rc&#39;)</span>
<span class="sd">         &gt;&gt; atom_rc_file = os.path.join(base_dir,data_dir, &#39;rc_n_iii_FSL13.fits&#39;)</span>
<span class="sd">         &gt;&gt; atom=&#39;n&#39;</span>
<span class="sd">         &gt;&gt; ion=&#39;iii&#39; # N II</span>
<span class="sd">         &gt;&gt; wavelength_range=[4400.0, 7100.0]</span>
<span class="sd">         &gt;&gt; nii_rc_data = atomneb.read_aeff_n_ii_fsl13(atom_rc_file, atom, ion, wavelength_range)</span>
<span class="sd">         &gt;&gt; nii_rc_data_wave = atomneb.read_aeff_n_ii_fsl13(atom_rc_file, atom, ion, wavelength_range, wavelength=True)</span>
<span class="sd">         &gt;&gt; print(nii_rc_data.aeff[0])</span>
<span class="sd">            255.000      79.5000      47.3000      12.5000      ...</span>
<span class="sd">         &gt;&gt; n_line = len(nii_rc_data_wave.wavelength)</span>
<span class="sd">         &gt;&gt; for i in range(0, n_line):</span>
<span class="sd">         &gt;&gt;     print(nii_rc_data_wave.wavelength[i], nii_rc_data_wave.tr[i], nii_rc_data_wave.trans[i])</span>
<span class="sd">            6413.236g - 4f2p6g G[9/2]o4 - 2p4f F[7/2]e3</span>
<span class="sd">            6556.326g - 4f2p6g G[9/2]o5 - 2p4f G[7/2]e4</span>
<span class="sd">            6456.976g - 4f2p6g G[9/2]o5 - 2p4f F[7/2]e4</span>
<span class="sd">            ...</span>
<span class="sd">         </span>
<span class="sd">     :return: This function returns the effective recombination coefficients.</span>
<span class="sd">     :rtype: an array of data</span>
<span class="sd">     </span>
<span class="sd">     :param atom_rc_file: the FITS data file name (&#39;rc_n_iii_FSL13.fits&#39;)</span>
<span class="sd">     :type atom_rc_file: str</span>
<span class="sd">  </span>
<span class="sd">     :param atom: atom name e.g. &#39;n&#39;</span>
<span class="sd">     :type atom: str</span>
<span class="sd">     </span>
<span class="sd">     :param ion: ionic level e.g &#39;iii&#39;</span>
<span class="sd">     :type ion: str</span>
<span class="sd">  </span>
<span class="sd">     :param wavelength: set for returning the wavelengths</span>
<span class="sd">     :type wavelength: boolean, optional</span>
<span class="sd">      </span>
<span class="sd">     :param reference: set for the reference</span>
<span class="sd">     :type reference: str, optional</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">element_data_list</span> <span class="o">=</span> <span class="n">read_aeff_n_ii_fsl13_list</span><span class="p">(</span><span class="n">atom_rc_file</span><span class="p">)</span>
    <span class="n">wave_min</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">wavelength_range</span><span class="p">)</span>
    <span class="n">wave_max</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">wavelength_range</span><span class="p">)</span>
    <span class="n">wave_loc1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">((</span><span class="n">element_data_list</span><span class="o">.</span><span class="n">wavelength</span> <span class="o">&gt;=</span> <span class="n">wave_min</span><span class="p">)</span><span class="o">&amp;</span><span class="p">(</span><span class="n">element_data_list</span><span class="o">.</span><span class="n">wavelength</span> <span class="o">&lt;=</span> <span class="n">wave_max</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">wave_size</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">wave_loc1</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">wave_size</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">0</span>
    <span class="n">rc_element_template</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;wavelength&#39;</span><span class="p">:</span> <span class="nb">float</span><span class="p">(</span><span class="mf">0.0</span><span class="p">),</span> <span class="s1">&#39;aeff&#39;</span><span class="p">:[</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">7</span><span class="p">,</span><span class="mi">4</span><span class="p">))]}</span>
    <span class="n">rc_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">rc_element_template</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">wave_size</span><span class="p">))</span>

    <span class="n">extension1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">element_data_list</span><span class="o">.</span><span class="n">extension</span><span class="p">)[</span><span class="n">wave_loc1</span><span class="p">]</span>
    <span class="n">wavelength1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">element_data_list</span><span class="o">.</span><span class="n">wavelength</span><span class="p">)[</span><span class="n">wave_loc1</span><span class="p">]</span>

    <span class="k">if</span> <span class="p">(</span><span class="n">wavelength</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">rc_wave_template</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;wavelength&#39;</span><span class="p">:</span> <span class="nb">float</span><span class="p">(</span><span class="mf">0.0</span><span class="p">),</span> <span class="s1">&#39;tr&#39;</span><span class="p">:</span><span class="s1">&#39;&#39;</span><span class="p">,</span>  <span class="s1">&#39;trans&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;t_x&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">}</span>
        <span class="n">rc_wave</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">rc_wave_template</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">wave_size</span><span class="p">))</span>
        <span class="n">rc_wave</span><span class="o">.</span><span class="n">wavelength</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">element_data_list</span><span class="o">.</span><span class="n">wavelength</span><span class="p">)[</span><span class="n">wave_loc1</span><span class="p">]</span>
        <span class="n">rc_wave</span><span class="o">.</span><span class="n">tr</span> <span class="o">=</span>  <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">element_data_list</span><span class="o">.</span><span class="n">tr</span><span class="p">)[</span><span class="n">wave_loc1</span><span class="p">]</span>
        <span class="n">rc_wave</span><span class="o">.</span><span class="n">trans</span> <span class="o">=</span>  <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">element_data_list</span><span class="o">.</span><span class="n">trans</span><span class="p">)[</span><span class="n">wave_loc1</span><span class="p">]</span>
        <span class="n">rc_wave</span><span class="o">.</span><span class="n">t_x</span> <span class="o">=</span>  <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">element_data_list</span><span class="o">.</span><span class="n">t_x</span><span class="p">)[</span><span class="n">wave_loc1</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">rc_wave</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">wave_size</span> <span class="p">):</span>
        <span class="n">rc_aeff</span><span class="p">,</span> <span class="n">header1</span> <span class="o">=</span> <span class="n">getdata</span><span class="p">(</span><span class="n">atom_rc_file</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">extension1</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span> <span class="n">header</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="c1"># temp=size(rc_aeff,/DIMENSIONS)</span>
        <span class="c1"># col1=temp[0]</span>
        <span class="c1"># row1=temp[1]</span>
        <span class="c1"># aeff_template={Aeff:dblarr(col1,row1)}</span>
        <span class="c1"># rc_data=replicate(aeff_template, 1)</span>
        <span class="c1">#rc_data.wavelength[i] = wavelength1[i]</span>
        <span class="n">rc_data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="s1">&#39;wavelength&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">wavelength1</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="c1">#rc_data.aeff[i] = rc_aeff</span>
        <span class="n">rc_data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="s1">&#39;aeff&#39;</span><span class="p">]</span><span class="o">=</span><span class="p">[</span><span class="n">rc_aeff</span><span class="p">]</span>

    <span class="k">return</span> <span class="n">rc_data</span></div>

<div class="viewcode-block" id="read_aeff_n_ii_fsl13_list"><a class="viewcode-back" href="../api/atomneb.main.html#atomneb.read_aeff_n_ii_fsl13_list">[docs]</a><span class="k">def</span> <span class="nf">read_aeff_n_ii_fsl13_list</span><span class="p">(</span><span class="n">atom_rc_file</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">         This function returns the list of effective recombination coefficients (Aeff) from the 1st binary table extension</span>
<span class="sd">         of the FITS data file (&#39;rc_n_iii_FSL13.fits&#39;)</span>

<span class="sd">     :return: This function returns the aeff_data_list: {Aeff_Data:&#39;&#39;,  Extension:0, IND:long(0), Wavelength: float(0.0),  Tr:&#39;&#39;,  Trans: &#39;&#39;, T_X: &#39;&#39;}</span>
<span class="sd">     :rtype: an array of data</span>
<span class="sd">     </span>
<span class="sd">     :param atom_rc_file: the FITS data file name (&#39;rc_n_iii_FSL13.fits&#39;)</span>
<span class="sd">     :type atom_rc_file: str</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">element_template</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;aeff_data&#39;</span><span class="p">:</span><span class="s1">&#39;&#39;</span><span class="p">,</span>  <span class="s1">&#39;extension&#39;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span>
                      <span class="s1">&#39;ind&#39;</span><span class="p">:</span><span class="nb">int</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="s1">&#39;wavelength&#39;</span><span class="p">:</span> <span class="nb">float</span><span class="p">(</span><span class="mf">0.0</span><span class="p">),</span>
                      <span class="s1">&#39;tr&#39;</span><span class="p">:</span><span class="s1">&#39;&#39;</span><span class="p">,</span>  <span class="s1">&#39;trans&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;t_x&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">}</span>
    <span class="n">data</span><span class="p">,</span> <span class="n">header1</span> <span class="o">=</span> <span class="n">getdata</span><span class="p">(</span><span class="n">atom_rc_file</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">aeff_data</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">AEFF_DATA</span>
    <span class="n">extension</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">EXTENSION</span>
    <span class="n">ind</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">IND</span>
    <span class="n">wavelength</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">WAVELENGTH</span>
    <span class="n">tr</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">TR</span>
    <span class="n">trans</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">TRANS</span>

    <span class="n">element_length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">aeff_data</span><span class="p">)</span>
    <span class="n">element_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">element_template</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">element_length</span><span class="p">))</span>

    <span class="n">aeff_data</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">char</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="n">aeff_data</span><span class="p">)</span>
    <span class="n">tr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">char</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="n">tr</span><span class="p">)</span>
    <span class="n">trans</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">char</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="n">trans</span><span class="p">)</span>

    <span class="n">element_data</span><span class="o">.</span><span class="n">aeff_data</span> <span class="o">=</span> <span class="n">aeff_data</span>
    <span class="n">element_data</span><span class="o">.</span><span class="n">extension</span> <span class="o">=</span> <span class="n">extension</span>
    <span class="n">element_data</span><span class="o">.</span><span class="n">ind</span> <span class="o">=</span> <span class="n">ind</span>
    <span class="n">element_data</span><span class="o">.</span><span class="n">wavelength</span> <span class="o">=</span> <span class="n">wavelength</span>
    <span class="n">element_data</span><span class="o">.</span><span class="n">tr</span> <span class="o">=</span> <span class="n">tr</span>
    <span class="n">element_data</span><span class="o">.</span><span class="n">trans</span> <span class="o">=</span> <span class="n">trans</span>
    <span class="k">return</span> <span class="n">element_data</span></div>

<div class="viewcode-block" id="search_aeff_n_ii_fsl13"><a class="viewcode-back" href="../api/atomneb.main.html#atomneb.search_aeff_n_ii_fsl13">[docs]</a><span class="k">def</span> <span class="nf">search_aeff_n_ii_fsl13</span><span class="p">(</span><span class="n">atom_rc_file</span><span class="p">,</span> <span class="n">atom</span><span class="p">,</span> <span class="n">ion</span><span class="p">,</span> <span class="n">wavelength</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">         This function searches effective recombination coefficients (Aeff) for given element</span>
<span class="sd">         and ionic levels in the FITS data file (&#39;rc_n_iii_FSL13.fits&#39;), and returns the data entry.</span>

<span class="sd">        For example::</span>

<span class="sd">         &gt;&gt; import atomneb</span>
<span class="sd">         &gt;&gt; import numpy as np</span>
<span class="sd">         &gt;&gt; import os</span>
<span class="sd">         &gt;&gt; base_dir = os.getcwd()</span>
<span class="sd">         &gt;&gt; data_dir = os.path.join(&#39;..&#39;,&#39;atomic-data-rc&#39;)</span>
<span class="sd">         &gt;&gt; atom_rc_file = os.path.join(base_dir,data_dir, &#39;rc_n_iii_FSL13.fits&#39;)</span>
<span class="sd">         &gt;&gt; atom=&#39;n&#39;</span>
<span class="sd">         &gt;&gt; ion=&#39;iii&#39; # N II</span>
<span class="sd">         &gt;&gt; wavelength=5679.56</span>
<span class="sd">         &gt;&gt; list_nii_aeff_data = atomneb.search_aeff_n_ii_fsl13(atom_rc_file, atom, ion, wavelength)</span>
<span class="sd">         &gt;&gt; print(np.asarray(list_nii_aeff_data.wavelength))</span>
<span class="sd">            5679.56</span>
<span class="sd">         &gt;&gt; print(np.asarray(list_nii_aeff_data.aeff))</span>
<span class="sd">            7810.00      1780.00      850.000      151.000      74.4000      53.1000      47.4000</span>
<span class="sd">            7370.00      1700.00      886.000      206.000      110.000      80.1000      70.8000</span>
<span class="sd">            7730.00      1680.00      900.000      239.000      138.000      103.000      92.9000</span>
<span class="sd">            8520.00      1710.00      905.000      244.000      142.000      107.000      97.0000</span>

<span class="sd">     :return: This function returns the Aeff_Data.</span>
<span class="sd">     :rtype: an array of data</span>
<span class="sd">     </span>
<span class="sd">     :param atom_rc_file: the FITS data file name (&#39;rc_n_iii_FSL13.fits&#39;)</span>
<span class="sd">     :type atom_rc_file: str</span>
<span class="sd">  </span>
<span class="sd">     :param atom: atom name e.g. &#39;n&#39;</span>
<span class="sd">     :type atom: str</span>
<span class="sd">     </span>
<span class="sd">     :param ion: ionic level e.g &#39;iii&#39;</span>
<span class="sd">     :type ion: str</span>
<span class="sd">  </span>
<span class="sd">     :param wavelength: set the wavelengths</span>
<span class="sd">     :type wavelength: int</span>
<span class="sd">      </span>
<span class="sd">     :param reference: set for the reference</span>
<span class="sd">     :type reference: str, optional</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">element_data_list</span> <span class="o">=</span> <span class="n">read_aeff_n_ii_fsl13_list</span><span class="p">(</span><span class="n">atom_rc_file</span><span class="p">)</span>

    <span class="n">ii</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">((</span><span class="nb">abs</span><span class="p">(</span><span class="n">element_data_list</span><span class="o">.</span><span class="n">wavelength</span> <span class="o">-</span> <span class="n">wavelength</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">0.025</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">ii_length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">ii</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">ii</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;could not find the given wavelength&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="mi">0</span>
    <span class="k">if</span> <span class="n">ii_length</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">value_min</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">element_data_list</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span><span class="o">.</span><span class="n">wavelength</span> <span class="o">-</span> <span class="n">wavelength</span><span class="p">))</span>
        <span class="n">ii</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">((</span><span class="nb">abs</span><span class="p">(</span><span class="n">element_data_list</span><span class="o">.</span><span class="n">wavelength</span> <span class="o">-</span> <span class="n">wavelength</span><span class="p">)</span> <span class="o">==</span> <span class="n">value_min</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">ii_length</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">extension1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">element_data_list</span><span class="o">.</span><span class="n">extension</span><span class="p">)[</span><span class="n">ii</span><span class="p">]</span>
    <span class="n">wavelength1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">element_data_list</span><span class="o">.</span><span class="n">wavelength</span><span class="p">)[</span><span class="n">ii</span><span class="p">]</span>

    <span class="n">rc_element_template</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;wavelength&#39;</span><span class="p">:</span> <span class="nb">float</span><span class="p">(</span><span class="mf">0.0</span><span class="p">),</span> <span class="s1">&#39;aeff&#39;</span><span class="p">:[</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">7</span><span class="p">,</span><span class="mi">4</span><span class="p">))]}</span>
    <span class="n">select_aeff_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">rc_element_template</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">ii_length</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">ii_length</span><span class="p">):</span>
        <span class="n">rc_aeff</span><span class="p">,</span> <span class="n">header1</span> <span class="o">=</span> <span class="n">getdata</span><span class="p">(</span><span class="n">atom_rc_file</span><span class="p">,</span> <span class="n">extension1</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">header</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="c1">#select_aeff_data.wavelength[i] = wavelength1[i]</span>
        <span class="n">select_aeff_data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="s1">&#39;wavelength&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">wavelength1</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="c1"># select_aeff_data.aeff[i] = rc_aeff</span>
        <span class="n">select_aeff_data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="s1">&#39;aeff&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">rc_aeff</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">select_aeff_data</span></div>

<div class="viewcode-block" id="read_aeff_n_ii_fsl13_references"><a class="viewcode-back" href="../api/atomneb.main.html#atomneb.read_aeff_n_ii_fsl13_references">[docs]</a><span class="k">def</span> <span class="nf">read_aeff_n_ii_fsl13_references</span><span class="p">(</span><span class="n">atom_rc_file</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">         This function returns the reference list of recombination coefficients (Aeff) from the 2nd binary table extension</span>
<span class="sd">         of the FITS data file (&#39;rc_n_iii_FSL13.fits&#39;).</span>

<span class="sd">     :return: This function returns the aeff_data_reference: { Reference:&#39;&#39;, Citation:&#39;&#39;}</span>
<span class="sd">     :rtype: an array of data</span>

<span class="sd">     :param atom_rc_file: the FITS data file name (&#39;rc_n_iii_FSL13.fits&#39;)</span>
<span class="sd">     :type atom_rc_file: str</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">reference_template</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;reference&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;citation&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">}</span>
    <span class="n">data</span><span class="p">,</span> <span class="n">hdr</span> <span class="o">=</span> <span class="n">getdata</span><span class="p">(</span><span class="n">atom_rc_file</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">reference</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">ATOMICDATA</span>
    <span class="n">citation</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">REFERENCE</span>
    <span class="n">reference_length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">reference</span><span class="p">)</span>

    <span class="n">reference_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">reference_template</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">reference_length</span><span class="p">))</span>
    <span class="n">reference</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">char</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="n">reference</span><span class="p">)</span>
    <span class="n">citation</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">char</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="n">citation</span><span class="p">)</span>
    <span class="n">reference_data</span><span class="o">.</span><span class="n">reference</span> <span class="o">=</span> <span class="n">reference</span>
    <span class="n">reference_data</span><span class="o">.</span><span class="n">citation</span> <span class="o">=</span> <span class="n">citation</span>
    <span class="k">return</span> <span class="n">reference_data</span></div>

<div class="viewcode-block" id="list_aeff_n_ii_fsl13_references"><a class="viewcode-back" href="../api/atomneb.main.html#atomneb.list_aeff_n_ii_fsl13_references">[docs]</a><span class="k">def</span> <span class="nf">list_aeff_n_ii_fsl13_references</span><span class="p">(</span><span class="n">atom_rc_file</span><span class="p">,</span> <span class="n">atom</span><span class="p">,</span> <span class="n">ion</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">         This function returns a list for all references of recombination coefficients (Aeff)</span>
<span class="sd">         for given element and ionic level from the FITS data file (&#39;rc_n_iii_FSL13.fits&#39;).</span>

<span class="sd">        For example::</span>

<span class="sd">         &gt;&gt; import atomneb</span>
<span class="sd">         &gt;&gt; import numpy as np</span>
<span class="sd">         &gt;&gt; import os</span>
<span class="sd">         &gt;&gt; base_dir = os.getcwd()</span>
<span class="sd">         &gt;&gt; data_dir = [&#39;atomic-data-rc&#39;]</span>
<span class="sd">         &gt;&gt; atom_rc_file = os.path.join(base_dir,data_dir, &#39;rc_n_iii_FSL13.fits&#39;)</span>
<span class="sd">         &gt;&gt; atom=&#39;n&#39;</span>
<span class="sd">         &gt;&gt; ion=&#39;iii&#39; # N II</span>
<span class="sd">         &gt;&gt; list_nii_aeff_reference = atomneb.list_aeff_n_ii_fsl13_references(atom_rc_file, atom, ion)</span>
<span class="sd">         &gt;&gt; print(list_nii_aeff_reference)</span>

<span class="sd">     :return: This function returns the references.</span>
<span class="sd">     :rtype: an array of strings</span>
<span class="sd">     </span>
<span class="sd">     :param atom_rc_file: the FITS data file name (&#39;rc_n_iii_FSL13.fits&#39;)</span>
<span class="sd">     :type atom_rc_file: str</span>
<span class="sd">  </span>
<span class="sd">     :param atom: atom name e.g. &#39;n&#39;</span>
<span class="sd">     :type atom: str</span>
<span class="sd">     </span>
<span class="sd">     :param ion: ionic level e.g &#39;iii&#39;</span>
<span class="sd">     :type ion: str</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">rc_reference_data</span> <span class="o">=</span> <span class="n">read_aeff_n_ii_fsl13_references</span><span class="p">(</span><span class="n">atom_rc_file</span><span class="p">)</span>

    <span class="n">atom_ion_name</span> <span class="o">=</span> <span class="n">atom</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">+</span> <span class="s1">&#39;_&#39;</span> <span class="o">+</span> <span class="n">ion</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">+</span> <span class="s1">&#39;_aeff&#39;</span>
    <span class="n">rc_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">rc_reference_data</span><span class="o">.</span><span class="n">reference</span><span class="p">)</span>
    <span class="c1">#rc_res = [x for x in rc_list if re.search(atom_ion_name, x)]</span>
    <span class="n">rc_res</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">rc_list</span> <span class="k">if</span> <span class="n">atom_ion_name</span> <span class="ow">in</span> <span class="n">x</span><span class="p">]</span>
    <span class="n">ii_length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">rc_res</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">ii_length</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;could not find the given element or ion&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="mi">0</span>
    <span class="n">nlines1</span> <span class="o">=</span> <span class="n">ii_length</span>  <span class="c1"># temp[0]</span>
    <span class="n">references</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nlines1</span><span class="p">)]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">nlines1</span><span class="p">):</span>
        <span class="n">select_rc_data_str1</span> <span class="o">=</span> <span class="n">rc_res</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)</span>
        <span class="n">ref_num</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">select_rc_data_str1</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">ref_num</span> <span class="o">&gt;</span> <span class="mi">3</span><span class="p">:</span>
            <span class="n">references</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">select_rc_data_str1</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">references</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
    <span class="k">return</span> <span class="n">references</span></div>

<div class="viewcode-block" id="get_aeff_n_ii_fsl13_reference_citation"><a class="viewcode-back" href="../api/atomneb.main.html#atomneb.get_aeff_n_ii_fsl13_reference_citation">[docs]</a><span class="k">def</span> <span class="nf">get_aeff_n_ii_fsl13_reference_citation</span><span class="p">(</span><span class="n">atom_rc_file</span><span class="p">,</span> <span class="n">atom</span><span class="p">,</span> <span class="n">ion</span><span class="p">,</span> <span class="n">reference</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">         This function returns the reference citation for a recombination coefficient (Aeff)</span>
<span class="sd">         from the 2nd binary table extension of the FITS data file (&#39;rc_n_iii_FSL13.fits&#39;).</span>

<span class="sd">        For example::</span>

<span class="sd">         &gt;&gt; import atomneb</span>
<span class="sd">         &gt;&gt; import numpy as np</span>
<span class="sd">         &gt;&gt; import os</span>
<span class="sd">         &gt;&gt; base_dir = os.getcwd()</span>
<span class="sd">         &gt;&gt; data_dir = [&#39;atomic-data-rc&#39;]</span>
<span class="sd">         &gt;&gt; atom_rc_file = os.path.join(base_dir,data_dir, &#39;rc_n_iii_FSL13.fits&#39;)</span>
<span class="sd">         &gt;&gt; atom=&#39;n&#39;</span>
<span class="sd">         &gt;&gt; ion=&#39;iii&#39; # N II</span>
<span class="sd">         &gt;&gt; reference=&#39;FSL13&#39;</span>
<span class="sd">         &gt;&gt; citation = atomneb.get_aeff_n_ii_fsl13_reference_citation(atom_rc_file, atom, ion)</span>
<span class="sd">         &gt;&gt; print(citation)</span>
<span class="sd">            Fang X., Storey P.J., and Liu X.-W., R. 2011, Astron.Astrophys. 530, A18; 2013, Astron.Astrophys. 550, C2</span>
<span class="sd">         </span>
<span class="sd">     :return: This function returns the Citation.</span>
<span class="sd">     :rtype: str</span>
<span class="sd">    </span>
<span class="sd">     :param atom_rc_file: the FITS data file name (&#39;rc_n_iii_FSL13.fits&#39;)</span>
<span class="sd">     :type atom_rc_file: str</span>
<span class="sd">  </span>
<span class="sd">     :param atom: atom name e.g. &#39;n&#39;</span>
<span class="sd">     :type atom: str</span>
<span class="sd">     </span>
<span class="sd">     :param ion: ionic level e.g &#39;iii&#39;</span>
<span class="sd">     :type ion: str</span>
<span class="sd">  </span>
<span class="sd">     :param reference: set for the reference e.g. &#39;FSL13</span>
<span class="sd">     :type reference: str, optional</span>
<span class="sd">     </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">element_data_reference</span> <span class="o">=</span> <span class="n">read_aeff_n_ii_fsl13_references</span><span class="p">(</span><span class="n">atom_rc_file</span><span class="p">)</span>
    <span class="n">reference_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">element_data_reference</span><span class="o">.</span><span class="n">reference</span><span class="p">)</span>
    <span class="n">atom_ion_name</span> <span class="o">=</span> <span class="n">atom</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">+</span> <span class="s1">&#39;_&#39;</span> <span class="o">+</span> <span class="n">ion</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">+</span> <span class="s1">&#39;_aeff&#39;</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">reference</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">atom_ion_name</span> <span class="o">=</span> <span class="n">atom_ion_name</span> <span class="o">+</span> <span class="s1">&#39;_&#39;</span> <span class="o">+</span> <span class="n">reference</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>

    <span class="n">ii</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">reference_list</span> <span class="o">==</span> <span class="n">atom_ion_name</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>  <span class="c1">#</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">ii</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;could not find the given reference&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="mi">0</span>
    <span class="n">citation</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">element_data_reference</span><span class="o">.</span><span class="n">citation</span><span class="p">[</span><span class="n">ii</span><span class="p">])</span>

    <span class="k">return</span> <span class="n">citation</span></div>

<div class="viewcode-block" id="read_aeff_o_ii_ssb17"><a class="viewcode-back" href="../api/atomneb.main.html#atomneb.read_aeff_o_ii_ssb17">[docs]</a><span class="k">def</span> <span class="nf">read_aeff_o_ii_ssb17</span><span class="p">(</span><span class="n">atom_rc_file</span><span class="p">,</span> <span class="n">atom</span><span class="p">,</span> <span class="n">ion</span><span class="p">,</span> <span class="n">case1</span><span class="p">,</span> <span class="n">wavelength_range</span><span class="p">,</span> <span class="n">wavelength</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">reference</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">         This function returns the effective recombination coefficients (Aeff) from the table extensions</span>
<span class="sd">         of the FITS data file (&#39;rc_o_iii_SSB17.fits&#39;).</span>

<span class="sd">        For example::</span>

<span class="sd">         &gt;&gt; import atomneb</span>
<span class="sd">         &gt;&gt; import numpy as np</span>
<span class="sd">         &gt;&gt; import os</span>
<span class="sd">         &gt;&gt; base_dir = os.getcwd()</span>
<span class="sd">         &gt;&gt; data_dir = os.path.join(&#39;..&#39;,&#39;atomic-data-rc&#39;)</span>
<span class="sd">         &gt;&gt; atom_rc_file = os.path.join(base_dir,data_dir, &#39;rc_o_iii_SSB17_orl_case_b.fits&#39;)</span>
<span class="sd">         &gt;&gt; atom=&#39;o&#39;</span>
<span class="sd">         &gt;&gt; ion=&#39;iii&#39; # O II</span>
<span class="sd">         &gt;&gt; case1=&#39;B&#39;</span>
<span class="sd">         &gt;&gt; wavelength_range=[5320.0, 5330.0]</span>
<span class="sd">         &gt;&gt; oii_rc_data = atomneb.read_aeff_o_ii_ssb17(atom_rc_file, atom, ion, case1, wavelength_range)</span>
<span class="sd">         &gt;&gt; oii_rc_data_wave = atomneb.read_aeff_o_ii_ssb17(atom_rc_file, atom, ion,</span>
<span class="sd">         &gt;&gt;                                                 case1, wavelength_range, wavelength=True)</span>
<span class="sd">         &gt;&gt; print(oii_rc_data.aeff[0])</span>
<span class="sd">            1.64100e-30  1.60000e-30  1.56400e-30  1.54100e-30 ...</span>
<span class="sd">         &gt;&gt; n_line = len(oii_rc_data_wave.wavelength)</span>
<span class="sd">         &gt;&gt; for i in range(0, n_line):</span>
<span class="sd">         &gt;&gt;      print(oii_rc_data_wave.wavelength[i], oii_rc_data_wave.lower_term[i], oii_rc_data_wave.upper_term[i])</span>
<span class="sd">            5327.172s22p2(1S)3p 2Po</span>
<span class="sd">            5325.422s22p2(1S)3p 2Po</span>
<span class="sd">            5327.182s22p2(1D)3d 2Ge</span>
<span class="sd">            ...</span>
<span class="sd">           </span>
<span class="sd">     :return: This function returns the effective recombination coefficients. </span>
<span class="sd">     :rtype: an array of data</span>

<span class="sd">     :param atom_rc_file: the FITS data file name (&#39;rc_o_iii_SSB17.fits&#39;)</span>
<span class="sd">     :type atom_rc_file: str</span>
<span class="sd">  </span>
<span class="sd">     :param atom: atom name e.g. &#39;o&#39;</span>
<span class="sd">     :type atom: str</span>
<span class="sd">     </span>
<span class="sd">     :param ion: ionic level e.g &#39;iii&#39;</span>
<span class="sd">     :type ion: str</span>
<span class="sd">  </span>
<span class="sd">     :param case1:  set for the case &#39;a&#39; or &#39;b&#39;, defualt &#39;b&#39;</span>
<span class="sd">     :type case1: str</span>

<span class="sd">     :param wavelength_range:  wavelength range e.g. [5320.0, 5330.0]</span>
<span class="sd">     :type wavelength_range: array</span>
<span class="sd">  </span>
<span class="sd">     :param wavelength: set for returning the wavelengths</span>
<span class="sd">     :type wavelength: boolean, optional</span>
<span class="sd">     </span>
<span class="sd">     :param reference: set for the reference</span>
<span class="sd">     :type reference: string, optional</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">element_data_list</span> <span class="o">=</span> <span class="n">read_aeff_o_ii_ssb17_list</span><span class="p">(</span><span class="n">atom_rc_file</span><span class="p">)</span>
    <span class="n">wave_min</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">wavelength_range</span><span class="p">)</span>
    <span class="n">wave_max</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">wavelength_range</span><span class="p">)</span>
    <span class="n">wave_loc1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">((</span><span class="n">element_data_list</span><span class="o">.</span><span class="n">wavelength</span> <span class="o">&gt;=</span> <span class="n">wave_min</span><span class="p">)</span><span class="o">&amp;</span><span class="p">(</span><span class="n">element_data_list</span><span class="o">.</span><span class="n">wavelength</span> <span class="o">&lt;=</span> <span class="n">wave_max</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">wave_size</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">wave_loc1</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">wave_size</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">0</span>
    <span class="n">rc_element_template</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;wavelength&#39;</span><span class="p">:</span> <span class="nb">float</span><span class="p">(</span><span class="mf">0.0</span><span class="p">),</span> <span class="s1">&#39;aeff&#39;</span><span class="p">:[</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">7</span><span class="p">,</span><span class="mi">4</span><span class="p">))]}</span>
    <span class="n">rc_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">rc_element_template</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">wave_size</span><span class="p">))</span>

    <span class="n">extension1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">element_data_list</span><span class="o">.</span><span class="n">extension</span><span class="p">)[</span><span class="n">wave_loc1</span><span class="p">]</span>
    <span class="n">wavelength1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">element_data_list</span><span class="o">.</span><span class="n">wavelength</span><span class="p">)[</span><span class="n">wave_loc1</span><span class="p">]</span>

    <span class="k">if</span> <span class="p">(</span><span class="n">wavelength</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">rc_wave_template</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;wavelength&#39;</span><span class="p">:</span> <span class="nb">float</span><span class="p">(</span><span class="mf">0.0</span><span class="p">),</span> <span class="s1">&#39;lower_term&#39;</span><span class="p">:</span><span class="s1">&#39;&#39;</span><span class="p">,</span>  <span class="s1">&#39;upper_term&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">}</span>
        <span class="n">rc_wave</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">rc_wave_template</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">wave_size</span><span class="p">))</span>
        <span class="n">rc_wave</span><span class="o">.</span><span class="n">wavelength</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">element_data_list</span><span class="o">.</span><span class="n">wavelength</span><span class="p">)[</span><span class="n">wave_loc1</span><span class="p">]</span>
        <span class="n">rc_wave</span><span class="o">.</span><span class="n">lower_term</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">element_data_list</span><span class="o">.</span><span class="n">lower_term</span><span class="p">)[</span><span class="n">wave_loc1</span><span class="p">]</span>
        <span class="n">rc_wave</span><span class="o">.</span><span class="n">upper_term</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">element_data_list</span><span class="o">.</span><span class="n">upper_term</span><span class="p">)[</span><span class="n">wave_loc1</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">rc_wave</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">wave_size</span> <span class="p">):</span>
        <span class="n">rc_aeff</span><span class="p">,</span> <span class="n">header1</span> <span class="o">=</span> <span class="n">getdata</span><span class="p">(</span><span class="n">atom_rc_file</span><span class="p">,</span> <span class="n">extension1</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">header</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">rc_data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="s1">&#39;wavelength&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">wavelength1</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="n">rc_data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="s1">&#39;aeff&#39;</span><span class="p">]</span><span class="o">=</span><span class="p">[</span><span class="n">rc_aeff</span><span class="p">]</span>

    <span class="k">return</span> <span class="n">rc_data</span></div>

<div class="viewcode-block" id="read_aeff_o_ii_ssb17_list"><a class="viewcode-back" href="../api/atomneb.main.html#atomneb.read_aeff_o_ii_ssb17_list">[docs]</a><span class="k">def</span> <span class="nf">read_aeff_o_ii_ssb17_list</span><span class="p">(</span><span class="n">atom_rc_file</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">         This function returns the list of effective recombination coefficients (Aeff) from the 1st binary table extension</span>
<span class="sd">         of the FITS data file (&#39;rc_o_iii_SSB17.fits&#39;)</span>

<span class="sd">     :return: This function returns the aeff_data_list: {Aeff_Data:&#39;&#39;,  </span>
<span class="sd">                                  Extension:0, IND:long(0), Wavelength: float(0.0), </span>
<span class="sd">                                  Case1:&#39;&#39;,  lower_term: &#39;&#39;, upper_term: &#39;&#39;}</span>
<span class="sd">     :rtype: an array of data</span>
<span class="sd">     </span>
<span class="sd">     :param atom_rc_file: the FITS data file name (&#39;rc_o_iii_SSB17.fits&#39;)</span>
<span class="sd">     :type atom_rc_file: str</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">element_template</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;aeff_data&#39;</span><span class="p">:</span><span class="s1">&#39;&#39;</span><span class="p">,</span>  <span class="s1">&#39;extension&#39;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span>
                      <span class="s1">&#39;ind&#39;</span><span class="p">:</span><span class="nb">int</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="s1">&#39;wavelength&#39;</span><span class="p">:</span> <span class="nb">float</span><span class="p">(</span><span class="mf">0.0</span><span class="p">),</span>
                      <span class="s1">&#39;case1&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;lower_term&#39;</span><span class="p">:</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;upper_term&#39;</span><span class="p">:</span><span class="s1">&#39;&#39;</span><span class="p">}</span>
    <span class="n">data</span><span class="p">,</span> <span class="n">header1</span> <span class="o">=</span> <span class="n">getdata</span><span class="p">(</span><span class="n">atom_rc_file</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">aeff_data</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">AEFF_DATA</span>
    <span class="n">extension</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">EXTENSION</span>
    <span class="n">ind</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">IND</span>
    <span class="n">wavelength</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">WAVELENGTH</span>
    <span class="n">case1</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">CASE1</span>
    <span class="n">lower_term</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">LOWER_TERM</span>
    <span class="n">upper_term</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">UPPER_TERM</span>

    <span class="n">element_length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">aeff_data</span><span class="p">)</span>
    <span class="n">element_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">element_template</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">element_length</span><span class="p">))</span>

    <span class="n">aeff_data</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">char</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="n">aeff_data</span><span class="p">)</span>
    <span class="n">case1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">char</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="n">case1</span><span class="p">)</span>
    <span class="n">lower_term</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">char</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="n">lower_term</span><span class="p">)</span>
    <span class="n">upper_term</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">char</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="n">upper_term</span><span class="p">)</span>

    <span class="n">element_data</span><span class="o">.</span><span class="n">aeff_data</span> <span class="o">=</span> <span class="n">aeff_data</span>
    <span class="n">element_data</span><span class="o">.</span><span class="n">extension</span> <span class="o">=</span> <span class="n">extension</span>
    <span class="n">element_data</span><span class="o">.</span><span class="n">ind</span> <span class="o">=</span> <span class="n">ind</span>
    <span class="n">element_data</span><span class="o">.</span><span class="n">wavelength</span> <span class="o">=</span> <span class="n">wavelength</span>
    <span class="n">element_data</span><span class="o">.</span><span class="n">case1</span> <span class="o">=</span> <span class="n">case1</span>
    <span class="n">element_data</span><span class="o">.</span><span class="n">lower_term</span> <span class="o">=</span> <span class="n">lower_term</span>
    <span class="n">element_data</span><span class="o">.</span><span class="n">upper_term</span> <span class="o">=</span> <span class="n">upper_term</span>

    <span class="k">return</span> <span class="n">element_data</span></div>

<div class="viewcode-block" id="search_aeff_o_ii_ssb17"><a class="viewcode-back" href="../api/atomneb.main.html#atomneb.search_aeff_o_ii_ssb17">[docs]</a><span class="k">def</span> <span class="nf">search_aeff_o_ii_ssb17</span><span class="p">(</span><span class="n">atom_rc_file</span><span class="p">,</span> <span class="n">atom</span><span class="p">,</span> <span class="n">ion</span><span class="p">,</span> <span class="n">case1</span><span class="p">,</span> <span class="n">wavelength</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">         This function searches effective recombination coefficients (Aeff) for given element</span>
<span class="sd">         and ionic levels in the FITS data file (&#39;rc_o_iii_SSB17.fits&#39;), and returns the data entry.</span>

<span class="sd">        For example::</span>

<span class="sd">         &gt;&gt; import atomneb</span>
<span class="sd">         &gt;&gt; import numpy as np</span>
<span class="sd">         &gt;&gt; import os</span>
<span class="sd">         &gt;&gt; base_dir = os.getcwd()</span>
<span class="sd">         &gt;&gt; data_dir = os.path.join(&#39;..&#39;,&#39;atomic-data-rc&#39;)</span>
<span class="sd">         &gt;&gt; atom_rc_file = os.path.join(base_dir,data_dir, &#39;rc_o_iii_SSB17_orl_case_b.fits&#39;)</span>
<span class="sd">         &gt;&gt; atom=&#39;o&#39;</span>
<span class="sd">         &gt;&gt; ion=&#39;iii&#39; # O II</span>
<span class="sd">         &gt;&gt; case1=&#39;B&#39;</span>
<span class="sd">         &gt;&gt; wavelength=5325.42</span>
<span class="sd">         &gt;&gt; list_oii_aeff_data = atomneb.search_aeff_o_ii_ssb17(atom_rc_file, atom, ion, case1, wavelength)</span>
<span class="sd">         &gt;&gt; print(np.asarray(list_oii_aeff_data.wavelength))</span>
<span class="sd">            5325.42</span>
<span class="sd">         &gt;&gt; print(np.asarray(list_oii_aeff_data.aeff))</span>
<span class="sd">            3.41800e-32  3.33300e-32  3.25700e-32  3.20900e-32  3.16800e-32 ...</span>

<span class="sd">     :return: This function returns the Aeff_Data.</span>
<span class="sd">     :rtype: an array of data</span>

<span class="sd">     :param atom_rc_file: the FITS data file name (&#39;rc_o_iii_SSB17.fits&#39;)</span>
<span class="sd">     :type atom_rc_file: str</span>
<span class="sd">  </span>
<span class="sd">     :param atom: atom name e.g. &#39;o&#39;</span>
<span class="sd">     :type atom: str</span>
<span class="sd">     </span>
<span class="sd">     :param ion: ionic level e.g &#39;iii&#39;</span>
<span class="sd">     :type ion: str</span>
<span class="sd">  </span>
<span class="sd">     :param case1:  set for the case &#39;a&#39; or &#39;b&#39;, defualt &#39;b&#39;</span>
<span class="sd">     :type case1: str</span>

<span class="sd">     :param wavelength: set the wavelengths</span>
<span class="sd">     :type wavelength: float</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">element_data_list</span> <span class="o">=</span> <span class="n">read_aeff_o_ii_ssb17_list</span><span class="p">(</span><span class="n">atom_rc_file</span><span class="p">)</span>

    <span class="n">ii</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">((</span><span class="nb">abs</span><span class="p">(</span><span class="n">element_data_list</span><span class="o">.</span><span class="n">wavelength</span> <span class="o">-</span> <span class="n">wavelength</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">0.02</span><span class="p">)</span><span class="o">&amp;</span><span class="p">(</span><span class="n">element_data_list</span><span class="o">.</span><span class="n">case1</span> <span class="o">==</span> <span class="n">case1</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>

    <span class="n">ii_length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">ii</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">ii</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;could not find the given wavelength&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="mi">0</span>
    <span class="k">if</span> <span class="n">ii_length</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">ii_min</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">element_data_list</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span><span class="o">.</span><span class="n">wavelength</span> <span class="o">-</span> <span class="n">wavelength</span><span class="p">))</span>
        <span class="n">ii</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">((</span><span class="nb">abs</span><span class="p">(</span><span class="n">element_data_list</span><span class="o">.</span><span class="n">wavelength</span> <span class="o">-</span> <span class="n">wavelength</span><span class="p">)</span> <span class="o">==</span> <span class="n">ii_min</span><span class="p">)</span><span class="o">&amp;</span><span class="p">(</span><span class="n">element_data_list</span><span class="o">.</span><span class="n">case1</span> <span class="o">==</span> <span class="n">case1</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">ii_length</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">extension1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">element_data_list</span><span class="o">.</span><span class="n">extension</span><span class="p">)[</span><span class="n">ii</span><span class="p">]</span>
    <span class="n">wavelength1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">element_data_list</span><span class="o">.</span><span class="n">wavelength</span><span class="p">)[</span><span class="n">ii</span><span class="p">]</span>

    <span class="n">rc_element_template</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;wavelength&#39;</span><span class="p">:</span> <span class="nb">float</span><span class="p">(</span><span class="mf">0.0</span><span class="p">),</span> <span class="s1">&#39;aeff&#39;</span><span class="p">:[</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">7</span><span class="p">,</span><span class="mi">4</span><span class="p">))]}</span>
    <span class="n">select_aeff_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">rc_element_template</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">ii_length</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">ii_length</span><span class="p">):</span>
        <span class="n">rc_aeff</span><span class="p">,</span> <span class="n">header1</span> <span class="o">=</span> <span class="n">getdata</span><span class="p">(</span><span class="n">atom_rc_file</span><span class="p">,</span> <span class="n">extension1</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">header</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="c1">#select_aeff_data.wavelength[i] = wavelength1[i]</span>
        <span class="n">select_aeff_data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="s1">&#39;wavelength&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">wavelength1</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="c1"># select_aeff_data.aeff[i] = rc_aeff</span>
        <span class="n">select_aeff_data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="s1">&#39;aeff&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">rc_aeff</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">select_aeff_data</span></div>

<div class="viewcode-block" id="read_aeff_o_ii_ssb17_references"><a class="viewcode-back" href="../api/atomneb.main.html#atomneb.read_aeff_o_ii_ssb17_references">[docs]</a><span class="k">def</span> <span class="nf">read_aeff_o_ii_ssb17_references</span><span class="p">(</span><span class="n">atom_rc_file</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">         This function returns the reference list of recombination coefficients (Aeff) from the 2nd binary table extension</span>
<span class="sd">         of the FITS data file (&#39;rc_o_iii_SSB17.fits&#39;).</span>

<span class="sd">     :return: This function returns the aeff_data_reference: { Reference:&#39;&#39;, Citation:&#39;&#39;}</span>
<span class="sd">     :rtype: an array of data</span>
<span class="sd">     </span>
<span class="sd">     :param atom_rc_file: the FITS data file name (&#39;rc_o_iii_SSB17.fits&#39;)</span>
<span class="sd">     :type atom_rc_file: str</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">reference_template</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;reference&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;citation&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">}</span>
    <span class="n">data</span><span class="p">,</span> <span class="n">hdr</span> <span class="o">=</span> <span class="n">getdata</span><span class="p">(</span><span class="n">atom_rc_file</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">reference</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">ATOMICDATA</span>
    <span class="n">citation</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">REFERENCE</span>
    <span class="n">reference_length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">reference</span><span class="p">)</span>

    <span class="n">reference_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">reference_template</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">reference_length</span><span class="p">))</span>
    <span class="c1"># aij_data=aij_data.strip</span>
    <span class="n">reference</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">char</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="n">reference</span><span class="p">)</span>
    <span class="n">citation</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">char</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="n">citation</span><span class="p">)</span>
    <span class="n">reference_data</span><span class="o">.</span><span class="n">reference</span> <span class="o">=</span> <span class="n">reference</span>
    <span class="n">reference_data</span><span class="o">.</span><span class="n">citation</span> <span class="o">=</span> <span class="n">citation</span>
    <span class="k">return</span> <span class="n">reference_data</span></div>

<div class="viewcode-block" id="list_aeff_o_ii_ssb17_references"><a class="viewcode-back" href="../api/atomneb.main.html#atomneb.list_aeff_o_ii_ssb17_references">[docs]</a><span class="k">def</span> <span class="nf">list_aeff_o_ii_ssb17_references</span><span class="p">(</span><span class="n">atom_rc_file</span><span class="p">,</span> <span class="n">atom</span><span class="p">,</span> <span class="n">ion</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">         This function returns a list for all references of recombination coefficients (Aeff)</span>
<span class="sd">         for given element and ionic level from the FITS data file (&#39;rc_o_iii_SSB17.fits&#39;).</span>

<span class="sd">        For example::</span>

<span class="sd">         &gt;&gt; import atomneb</span>
<span class="sd">         &gt;&gt; import numpy as np</span>
<span class="sd">         &gt;&gt; import os</span>
<span class="sd">         &gt;&gt; base_dir = os.getcwd()</span>
<span class="sd">         &gt;&gt; data_dir = [&#39;atomic-data-rc&#39;]</span>
<span class="sd">         &gt;&gt; atom_rc_file = os.path.join(base_dir,data_dir, &#39;rc_o_iii_SSB17_orl_case_b.fits&#39;)</span>
<span class="sd">         &gt;&gt; atom=&#39;o&#39;</span>
<span class="sd">         &gt;&gt; ion=&#39;iii&#39; # O II</span>
<span class="sd">         &gt;&gt; list_oii_aeff_reference = atomneb.list_aeff_o_ii_ssb17_references(atom_rc_file, atom, ion)</span>
<span class="sd">         &gt;&gt; print(list_oii_aeff_reference)</span>
<span class="sd">         </span>
<span class="sd">     :return: This function returns the references.</span>
<span class="sd">     :rtype: an array of strings</span>

<span class="sd">     :param atom_rc_file: the FITS data file name (&#39;rc_o_iii_SSB17.fits&#39;)</span>
<span class="sd">     :type atom_rc_file: str</span>
<span class="sd">  </span>
<span class="sd">     :param atom: atom name e.g. &#39;o&#39;</span>
<span class="sd">     :type atom: str</span>
<span class="sd">     </span>
<span class="sd">     :param ion: ionic level e.g &#39;iii&#39;</span>
<span class="sd">     :type ion: str</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">rc_reference_data</span> <span class="o">=</span> <span class="n">read_aeff_n_ii_fsl13_references</span><span class="p">(</span><span class="n">atom_rc_file</span><span class="p">)</span>

    <span class="n">atom_ion_name</span> <span class="o">=</span> <span class="n">atom</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">+</span> <span class="s1">&#39;_&#39;</span> <span class="o">+</span> <span class="n">ion</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">+</span> <span class="s1">&#39;_aeff&#39;</span>
    <span class="n">rc_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">rc_reference_data</span><span class="o">.</span><span class="n">reference</span><span class="p">)</span>
    <span class="c1">#rc_res = [x for x in rc_list if re.search(atom_ion_name, x)]</span>
    <span class="n">rc_res</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">rc_list</span> <span class="k">if</span> <span class="n">atom_ion_name</span> <span class="ow">in</span> <span class="n">x</span><span class="p">]</span>
    <span class="n">ii_length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">rc_res</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">ii_length</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;could not find the given element or ion&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="mi">0</span>
    <span class="n">nlines1</span> <span class="o">=</span> <span class="n">ii_length</span>  <span class="c1"># temp[0]</span>
    <span class="n">references</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nlines1</span><span class="p">)]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">nlines1</span><span class="p">):</span>
        <span class="n">select_rc_data_str1</span> <span class="o">=</span> <span class="n">rc_res</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)</span>
        <span class="n">ref_num</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">select_rc_data_str1</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">ref_num</span> <span class="o">&gt;</span> <span class="mi">3</span><span class="p">:</span>
            <span class="n">references</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">select_rc_data_str1</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">references</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
    <span class="k">return</span> <span class="n">references</span></div>

<div class="viewcode-block" id="get_aeff_o_ii_ssb17_reference_citation"><a class="viewcode-back" href="../api/atomneb.main.html#atomneb.get_aeff_o_ii_ssb17_reference_citation">[docs]</a><span class="k">def</span> <span class="nf">get_aeff_o_ii_ssb17_reference_citation</span><span class="p">(</span><span class="n">atom_rc_file</span><span class="p">,</span> <span class="n">atom</span><span class="p">,</span> <span class="n">ion</span><span class="p">,</span> <span class="n">reference</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">         This function returns the reference citation for a recombination coefficient (Aeff)</span>
<span class="sd">         from the 2nd binary table extension of the FITS data file (&#39;rc_o_iii_SSB17.fits&#39;).</span>

<span class="sd">        For example::</span>

<span class="sd">         &gt;&gt; import atomneb</span>
<span class="sd">         &gt;&gt; import numpy as np</span>
<span class="sd">         &gt;&gt; import os</span>
<span class="sd">         &gt;&gt; base_dir = os.getcwd()</span>
<span class="sd">         &gt;&gt; data_dir = [&#39;atomic-data-rc&#39;]</span>
<span class="sd">         &gt;&gt; atom_rc_file = os.path.join(base_dir,data_dir, &#39;rc_o_iii_SSB17_orl_case_b.fits&#39;)</span>
<span class="sd">         &gt;&gt; atom=&#39;o&#39;</span>
<span class="sd">         &gt;&gt; ion=&#39;iii&#39; # O II</span>
<span class="sd">         &gt;&gt; reference=&#39;SSB17&#39;</span>
<span class="sd">         &gt;&gt; citation = atomneb.get_aeff_o_ii_ssb17_reference_citation(atom_rc_file, atom, ion)</span>
<span class="sd">         &gt;&gt; print(citation)</span>
<span class="sd">            Storey, P.J., Sochi, T. and Bastin, R. 2017, MNRAS, 470, 379; VizieR On-line Data Catalog: VI/150</span>
<span class="sd">         </span>
<span class="sd">     :return: This function returns the Citation.</span>
<span class="sd">     :rtype: str</span>

<span class="sd">     :param atom_rc_file: the FITS data file name (&#39;rc_o_iii_SSB17.fits&#39;)</span>
<span class="sd">     :type atom_rc_file: str</span>
<span class="sd">  </span>
<span class="sd">     :param atom: atom name e.g. &#39;o&#39;</span>
<span class="sd">     :type atom: str</span>
<span class="sd">     </span>
<span class="sd">     :param ion: ionic level e.g &#39;iii&#39;</span>
<span class="sd">     :type ion: str</span>
<span class="sd">  </span>
<span class="sd">     :param reference:  set for the reference e.g. &#39;SSB17</span>
<span class="sd">     :type reference: str, optional</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">element_data_reference</span> <span class="o">=</span> <span class="n">read_aeff_n_ii_fsl13_references</span><span class="p">(</span><span class="n">atom_rc_file</span><span class="p">)</span>
    <span class="n">reference_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">element_data_reference</span><span class="o">.</span><span class="n">reference</span><span class="p">)</span>
    <span class="n">atom_ion_name</span> <span class="o">=</span> <span class="n">atom</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">+</span> <span class="s1">&#39;_&#39;</span> <span class="o">+</span> <span class="n">ion</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">+</span> <span class="s1">&#39;_aeff&#39;</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">reference</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">atom_ion_name</span> <span class="o">=</span> <span class="n">atom_ion_name</span> <span class="o">+</span> <span class="s1">&#39;_&#39;</span> <span class="o">+</span> <span class="n">reference</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>

    <span class="n">ii</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">reference_list</span> <span class="o">==</span> <span class="n">atom_ion_name</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>  <span class="c1">#</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">ii</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;could not find the given reference&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="mi">0</span>
    <span class="n">citation</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">element_data_reference</span><span class="o">.</span><span class="n">citation</span><span class="p">[</span><span class="n">ii</span><span class="p">])</span>

    <span class="k">return</span> <span class="n">citation</span></div>

</pre></div>

           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2020, Ashkbiz Danehkar

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>